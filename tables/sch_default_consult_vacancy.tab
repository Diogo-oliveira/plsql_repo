

  CREATE TABLE SCH_DEFAULT_CONSULT_VACANCY
   (	ID_SCH_CONSULT_VACANCY NUMBER(24,0) NOT NULL ENABLE,
	DT_SCH_CONSULT_VACANCY DATE NOT NULL ENABLE,
	ID_INSTITUTION NUMBER(12,0) NOT NULL ENABLE,
	FLG_TYPE VARCHAR2(1),
	ID_PROF NUMBER(24,0),
	ID_PROF_CLIN_SERV NUMBER(12,0),
	ID_CLIN_SERV NUMBER(12,0),
	DT_BEGIN DATE NOT NULL ENABLE,
	MAX_VACANCIES NUMBER(6,0) NOT NULL ENABLE,
	USED_VACANCIES NUMBER(6,0) NOT NULL ENABLE,
	DT_END DATE,

	ID_DEP_CLIN_SERV NUMBER(24,0) NOT NULL ENABLE,
	ID_ROOM NUMBER(24,0),
	ID_SCH_EVENT NUMBER(24,0) NOT NULL ENABLE
   );

COMMENT ON TABLE SCH_DEFAULT_CONSULT_VACANCY IS 'Contains the default vacancies to be copied to SCH_CONSULT_VACANCY by the RESET process.';
COMMENT ON COLUMN SCH_DEFAULT_CONSULT_VACANCY.ID_PROF IS 'Professional identifier';
COMMENT ON COLUMN SCH_DEFAULT_CONSULT_VACANCY.FLG_TYPE IS 'Deprecated column';
COMMENT ON COLUMN SCH_DEFAULT_CONSULT_VACANCY.ID_INSTITUTION IS 'Institution identifier';
COMMENT ON COLUMN SCH_DEFAULT_CONSULT_VACANCY.DT_SCH_CONSULT_VACANCY IS 'Record creation date';
COMMENT ON COLUMN SCH_DEFAULT_CONSULT_VACANCY.ID_SCH_CONSULT_VACANCY IS 'Vacancy identifier';
COMMENT ON COLUMN SCH_DEFAULT_CONSULT_VACANCY.ID_PROF_CLIN_SERV IS 'Deprecated column';
COMMENT ON COLUMN SCH_DEFAULT_CONSULT_VACANCY.ID_SCH_EVENT IS 'Event identifier';
COMMENT ON COLUMN SCH_DEFAULT_CONSULT_VACANCY.ID_ROOM IS 'Default room for this vacancy';
COMMENT ON COLUMN SCH_DEFAULT_CONSULT_VACANCY.ID_DEP_CLIN_SERV IS 'Department-Clinical service identifier';
COMMENT ON COLUMN SCH_DEFAULT_CONSULT_VACANCY.ID_CLIN_SERV IS 'Deprecated column';
COMMENT ON COLUMN SCH_DEFAULT_CONSULT_VACANCY.DT_BEGIN IS 'Vacancy begin date';
COMMENT ON COLUMN SCH_DEFAULT_CONSULT_VACANCY.MAX_VACANCIES IS 'Total number of vacancies.';
COMMENT ON COLUMN SCH_DEFAULT_CONSULT_VACANCY.USED_VACANCIES IS 'Number of used vacancies.';
COMMENT ON COLUMN SCH_DEFAULT_CONSULT_VACANCY.DT_END IS 'Vacancy end date';

ALTER TABLE sch_default_consult_vacancy DROP COLUMN flg_type;
ALTER TABLE sch_default_consult_vacancy DROP COLUMN id_prof_clin_serv;
ALTER TABLE sch_default_consult_vacancy DROP COLUMN id_clin_serv;

ALTER TABLE sch_default_consult_vacancy ADD id_exam NUMBER(24) DEFAULT NULL;
ALTER TABLE sch_default_consult_vacancy ADD id_analysis NUMBER(24) DEFAULT NULL;

COMMENT ON COLUMN sch_default_consult_vacancy.id_exam IS 'Exam identifier';
COMMENT ON COLUMN sch_default_consult_vacancy.id_analysis IS 'Analysis identifier';

ALTER TABLE sch_default_consult_vacancy ADD CONSTRAINT sdcv_exam_fk FOREIGN KEY (id_exam) REFERENCES exam(id_exam);
ALTER TABLE sch_default_consult_vacancy ADD CONSTRAINT sdcv_analysis_fk FOREIGN KEY (id_analysis) REFERENCES analysis(id_analysis);

ALTER TABLE sch_default_consult_vacancy ADD CONSTRAINT sdcv_analysis_exam_ck CHECK (id_analysis IS NULL OR id_exam IS NULL);

ALTER TABLE SCH_DEFAULT_CONSULT_VACANCY MODIFY ID_ANALYSIS NUMBER(12);
ALTER TABLE SCH_DEFAULT_CONSULT_VACANCY MODIFY ID_EXAM NUMBER(12);

ALTER TABLE SCH_DEFAULT_CONSULT_VACANCY ADD DT_BEGIN_TSTZ TIMESTAMP WITH LOCAL TIME ZONE;	
COMMENT ON COLUMN SCH_DEFAULT_CONSULT_VACANCY.DT_BEGIN_TSTZ IS 'Vacancy begin date';
ALTER TABLE SCH_DEFAULT_CONSULT_VACANCY ADD DT_END_TSTZ TIMESTAMP WITH LOCAL TIME ZONE;	
COMMENT ON COLUMN SCH_DEFAULT_CONSULT_VACANCY.DT_END_TSTZ IS 'Vacancy end date';
ALTER TABLE SCH_DEFAULT_CONSULT_VACANCY ADD DT_SCH_CONSULT_VACANCY_TSTZ TIMESTAMP WITH LOCAL TIME ZONE;	
COMMENT ON COLUMN SCH_DEFAULT_CONSULT_VACANCY.DT_SCH_CONSULT_VACANCY_TSTZ IS 'Record creation date';

-- CHANGED BY: Telmo Castro
-- CHANGE DATE: 23-09-2008
-- CHANGE REASON: igualar datatype a institution.id_institution
alter table SCH_DEFAULT_CONSULT_VACANCY modify ID_INSTITUTION NUMBER(24);
--END


-- José Brito 22/09/2008 Eliminar colunas DATE
alter table sch_default_consult_vacancy drop column dt_begin;
alter table sch_default_consult_vacancy drop column dt_end;
alter table sch_default_consult_vacancy drop column dt_sch_consult_vacancy;

-- CHANGED BY: Telmo Castro
-- CHANGE DATE: 09-03-2009
-- CHANGE REASON: ALERT-19366. Audit trail precisava desta pk
alter table SCH_DEFAULT_CONSULT_VACANCY
  add constraint SDCV_PK primary key (ID_SCH_CONSULT_VACANCY);
--END