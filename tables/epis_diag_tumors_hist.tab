-- CHANGED BY: Alexandre Santos
-- CHANGE DATE: 04/05/2012 16:35
-- CHANGE REASON: [ALERT-229222] VERSIONING TRANSACTIONAL MODEL - SCHEMA ALERT - DDL
DECLARE
    e_name_already_exists EXCEPTION;

    PRAGMA EXCEPTION_INIT(e_name_already_exists, -00955);
BEGIN
    --i_flg_category
    --DSV:Dados Desenvolvimento, PRM:Parametrizações, CNT:conteúdos, TRS:Transacionais
    pk_frmw_objects.insert_into_frmw_objects(i_owner             => 'ALERT',
                                             i_obj_name          => 'EPIS_DIAG_TUMORS_HIST',
                                             i_obj_type          => 'TABLE',
                                             i_flg_category      => 'TRS',
                                             i_flg_alert_default => 'N',
                                             i_delete_script     => NULL,
                                             i_flg_default_child => 'N');

    BEGIN
        EXECUTE IMMEDIATE '
CREATE TABLE EPIS_DIAG_TUMORS_HIST
(
ID_EPIS_DIAGNOSIS_HIST   NUMBER(24) NOT NULL, 
ID_EPIS_DIAGNOSIS        NUMBER(24) NOT NULL, 
TUMOR_NUM                NUMBER(24) NOT NULL, 
ID_TOPOGRAPHY            NUMBER(24), 
ID_TOPOG_INST_OWNER      NUMBER(24), 
ID_LATERALITY            NUMBER(24), 
ID_LAT_INST_OWNER        NUMBER(24), 
ID_MORPHOLOGY             NUMBER(24), 
ID_MORPH_INST_OWNER       NUMBER(24), 
ID_BEHAVIOR              NUMBER(24), 
ID_BEHAV_INST_OWNER      NUMBER(24), 
ID_HISTOLOGICAL_GRADE    NUMBER(24), 
ID_HGRADE_INST_OWNER     NUMBER(24), 
ID_OTHER_GRADING_SYS     NUMBER(24), 
ID_OGRADSYS_INST_OWNER   NUMBER(24), 
FLG_UNKNOWN_DIMENSION    VARCHAR2(1 CHAR), 
NUM_DIMENSION            NUMBER(24), 
DESC_DIMENSION           VARCHAR2(1000 CHAR), 
ADDITIONAL_PATHOL_INFO   VARCHAR2(1000 CHAR), 
DT_EPIS_DIAGNOSIS_TUMORS TIMESTAMP WITH LOCAL TIME ZONE NOT NULL, 
  CREATE_USER VARCHAR2(24 CHAR),
  CREATE_TIME TIMESTAMP WITH LOCAL TIME ZONE,
  CREATE_INSTITUTION NUMBER(24),
  UPDATE_USER VARCHAR2(24 CHAR),
  UPDATE_TIME TIMESTAMP WITH LOCAL TIME ZONE,
  UPDATE_INSTITUTION NUMBER(24)
) TABLESPACE ALERT_DATA';
    EXCEPTION
        WHEN e_name_already_exists THEN
            dbms_output.put_line('AVISO: Operação já executada anteriormente.');
    END;

    EXECUTE IMMEDIATE 'COMMENT ON TABLE EPIS_DIAG_TUMORS_HIST IS ''Cancer diagnosis tumors list''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.ID_EPIS_DIAGNOSIS_HIST IS ''Episode diagnosis hist id''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.ID_EPIS_DIAGNOSIS IS ''Episode diagnosis id''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.TUMOR_NUM IS ''Number of tumors''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.ID_TOPOGRAPHY IS ''Topography id''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.ID_TOPOG_INST_OWNER IS ''Topography content owner. Default 0 - ALERT''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.ID_LATERALITY IS ''Laterality id''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.ID_LAT_INST_OWNER IS ''Laterality content owner. Default 0 - ALERT''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.ID_MORPHOLOGY IS ''Morphology id''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.ID_MORPH_INST_OWNER IS ''Morphology content owner. Default 0 - ALERT''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.ID_BEHAVIOR IS ''Behavior id''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.ID_BEHAV_INST_OWNER IS ''Behavior content owner. Default 0 - ALERT''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.ID_HISTOLOGICAL_GRADE IS ''Histological grade id''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.ID_HGRADE_INST_OWNER IS ''Histological grade content owner. Default 0 - ALERT''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.ID_OTHER_GRADING_SYS IS ''Other grading system id''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.ID_OGRADSYS_INST_OWNER IS ''Other grading system content owner. Default 0 - ALERT''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.FLG_UNKNOWN_DIMENSION IS ''Unknown dimension. Y - yes; N - otherwise''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.NUM_DIMENSION IS ''Numerical dimension''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.DESC_DIMENSION IS ''Descriptive dimension''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.ADDITIONAL_PATHOL_INFO IS ''Additional pathologies info''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.DT_EPIS_DIAGNOSIS_TUMORS IS ''Record creation date''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.CREATE_USER is ''Professional ID which created the record''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.CREATE_TIME is ''Date of record creation''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.CREATE_INSTITUTION is ''Institution ID where record was created''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.UPDATE_USER is ''Professional ID who last updated the record''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.UPDATE_TIME is ''Date when record was last updated''';
    EXECUTE IMMEDIATE 'COMMENT ON COLUMN EPIS_DIAG_TUMORS_HIST.UPDATE_INSTITUTION is ''Institution ID where record was last updated''';
END;
/
-- CHANGE END: Alexandre Santos

-- CHANGED BY: Elisabete Bugalho
-- CHANGE DATE: 25/07/2016 15:02
-- CHANGE REASON: [ALERT-323687] Increase from 1000 to 3000 characters in the field "Additional pathologic information" in Diagnoses staging
--                
alter table epis_diag_tumors_hist modify additional_pathol_info VARCHAR2(4000 CHAR);
-- CHANGE END: Elisabete Bugalho