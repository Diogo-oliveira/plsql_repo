  CREATE TABLE "ALERT"."GRID_TASK_IMG"
   (	"ID_EXAM_REQ" NUMBER(24,0),
	"ID_EXAM_REQ_DET" NUMBER(24,0),
	"ID_PATIENT" NUMBER(24,0),
	"ID_EPISODE" NUMBER(24,0),
	"ID_EPIS_TYPE" NUMBER(12,0),
	"FLG_STATUS_EPIS" VARCHAR2(1),
	"ID_SOFTWARE" NUMBER(24,0),
	"ID_INSTITUTION" NUMBER(24,0),
	"DT_FIRST_OBS_TSTZ" TIMESTAMP (6) WITH LOCAL TIME ZONE,
	"ID_EXAM" NUMBER(12,0),
	"DT_REQ_TSTZ" TIMESTAMP (6) WITH LOCAL TIME ZONE,
	"DT_BEGIN_TSTZ" TIMESTAMP (6) WITH LOCAL TIME ZONE,
	"DT_PEND_REQ_TSTZ" TIMESTAMP (6) WITH LOCAL TIME ZONE,
	"FLG_TIME_REQ" VARCHAR2(1),
	"FLG_STATUS_REQ_DET" VARCHAR2(1),
	"FLG_STATUS_MOV" VARCHAR2(1),
	"DT_REQ_MOV_TSTZ" TIMESTAMP (6) WITH LOCAL TIME ZONE,
	"DT_END_MOV_TSTZ" TIMESTAMP (6) WITH LOCAL TIME ZONE,
	"RANK" NUMBER,
	"ACUITY" VARCHAR2(50),
	"RANK_ACUITY" VARCHAR2(50),
	"REQUEST" VARCHAR2(50),
	"TRANSPORT" VARCHAR2(50),
	"EXECUTE" VARCHAR2(50),
	"COMPLETE" VARCHAR2(50)
   ) ;


-- Para adicionar colunas pode ser usado código comentado
-- De momento só são suportados os tipos de dados mais comuns.
-- ALTER TABLE GRID_TASK_IMG ADD ID_EXAM_REQ NUMBER(24,0) NOT NULL;
-- ALTER TABLE GRID_TASK_IMG ADD ID_EXAM_REQ_DET NUMBER(24,0) NOT NULL;
-- ALTER TABLE GRID_TASK_IMG ADD ID_PATIENT NUMBER(24,0) NOT NULL;
-- ALTER TABLE GRID_TASK_IMG ADD ID_EPISODE NUMBER(24,0) NOT NULL;
-- ALTER TABLE GRID_TASK_IMG ADD ID_EPIS_TYPE NUMBER(12,0) NOT NULL;
-- ALTER TABLE GRID_TASK_IMG ADD FLG_STATUS_EPIS VARCHAR2(1) NOT NULL;
-- ALTER TABLE GRID_TASK_IMG ADD ID_SOFTWARE NUMBER(24,0) NOT NULL;
-- ALTER TABLE GRID_TASK_IMG ADD ID_INSTITUTION NUMBER(24,0) NOT NULL;
-- ALTER TABLE GRID_TASK_IMG ADD DT_FIRST_OBS_TSTZ TIMESTAMP(6) WITH LOCAL TIME ZONE NOT NULL;
-- ALTER TABLE GRID_TASK_IMG ADD ID_EXAM NUMBER(12,0) NOT NULL;
-- ALTER TABLE GRID_TASK_IMG ADD DT_REQ_TSTZ TIMESTAMP(6) WITH LOCAL TIME ZONE NOT NULL;
-- ALTER TABLE GRID_TASK_IMG ADD DT_BEGIN_TSTZ TIMESTAMP(6) WITH LOCAL TIME ZONE ;
-- ALTER TABLE GRID_TASK_IMG ADD DT_PEND_REQ_TSTZ TIMESTAMP(6) WITH LOCAL TIME ZONE ;
-- ALTER TABLE GRID_TASK_IMG ADD FLG_TIME_REQ VARCHAR2(1) NOT NULL;
-- ALTER TABLE GRID_TASK_IMG ADD FLG_STATUS_REQ_DET VARCHAR2(1) NOT NULL;
-- ALTER TABLE GRID_TASK_IMG ADD FLG_STATUS_MOV VARCHAR2(1) ;
-- ALTER TABLE GRID_TASK_IMG ADD DT_REQ_MOV_TSTZ TIMESTAMP(6) WITH LOCAL TIME ZONE ;
-- ALTER TABLE GRID_TASK_IMG ADD DT_END_MOV_TSTZ TIMESTAMP(6) WITH LOCAL TIME ZONE ;
-- ALTER TABLE GRID_TASK_IMG ADD RANK NUMBER ;
-- ALTER TABLE GRID_TASK_IMG ADD ACUITY VARCHAR2(50) ;
-- ALTER TABLE GRID_TASK_IMG ADD RANK_ACUITY VARCHAR2(50) ;
-- ALTER TABLE GRID_TASK_IMG ADD REQUEST VARCHAR2(50) ;
-- ALTER TABLE GRID_TASK_IMG ADD TRANSPORT VARCHAR2(50) ;
-- ALTER TABLE GRID_TASK_IMG ADD EXECUTE VARCHAR2(50) ;
-- ALTER TABLE GRID_TASK_IMG ADD COMPLETE VARCHAR2(50) ;

   COMMENT ON COLUMN "ALERT"."GRID_TASK_IMG"."ID_EXAM_REQ" IS 'Cabeçalho da requisição';



   COMMENT ON COLUMN "ALERT"."GRID_TASK_IMG"."ID_EXAM_REQ_DET" IS 'Detalhe da requisição';



   COMMENT ON COLUMN "ALERT"."GRID_TASK_IMG"."ID_PATIENT" IS 'Paciente';



   COMMENT ON COLUMN "ALERT"."GRID_TASK_IMG"."ID_EPISODE" IS 'Episódio';



   COMMENT ON COLUMN "ALERT"."GRID_TASK_IMG"."ID_EPIS_TYPE" IS 'Tipo de episódio';



   COMMENT ON COLUMN "ALERT"."GRID_TASK_IMG"."FLG_STATUS_EPIS" IS 'Estado do episódio';



   COMMENT ON COLUMN "ALERT"."GRID_TASK_IMG"."ID_INSTITUTION" IS 'Instituição';



   COMMENT ON COLUMN "ALERT"."GRID_TASK_IMG"."DT_FIRST_OBS_TSTZ" IS 'Data da primeira observação';



   COMMENT ON COLUMN "ALERT"."GRID_TASK_IMG"."ID_EXAM" IS 'Exame';



   COMMENT ON COLUMN "ALERT"."GRID_TASK_IMG"."DT_BEGIN_TSTZ" IS 'Data pretendida para início da execução do exame (ie, ñ imediata)';



   COMMENT ON COLUMN "ALERT"."GRID_TASK_IMG"."FLG_STATUS_REQ_DET" IS 'Estado: R - requisitado, E - em execução, F - terminado, T - em transporte, M - transporte terminado, C - cancelado; D - pendente';



   COMMENT ON COLUMN "ALERT"."GRID_TASK_IMG"."RANK" IS 'Ordenação';



   COMMENT ON TABLE "ALERT"."GRID_TASK_IMG"  IS 'Tabela auxiliar para a grelha de exames de imagem';



ALTER TABLE GRID_TASK_IMG ADD (ID_ROOM NUMBER(24);

COMMENT ON COLUMN "ALERT"."GRID_TASK_IMG"."ID_ROOM" IS 'Id da sala para a realização do exame';


ALTER TABLE GRID_TASK_IMG 
 MODIFY (DT_FIRST_OBS_TSTZ TIMESTAMP WITH LOCAL TIME ZONE NULL);
 
 ALTER TABLE GRID_TASK_IMG 
 ADD (PAT_AGE NUMBER(3)
 ,PAT_GENDER VARCHAR2(1)
 ,NUM_CLIN_RECORD VARCHAR2(12)
 ,ID_DEPT NUMBER(24)
 ,ID_CLINICAL_SERVICE NUMBER(12)
 ,DT_SCHEDULE_TSTZ TIMESTAMP WITH LOCAL TIME ZONE
 ,ID_EXAM_CAT NUMBER(24) NOT NULL
 );
 
   COMMENT ON COLUMN GRID_TASK_IMG.PAT_AGE IS 'Idade do paciente';
   COMMENT ON COLUMN GRID_TASK_IMG.PAT_GENDER IS 'Género do paciente';
   COMMENT ON COLUMN GRID_TASK_IMG.NUM_CLIN_RECORD IS 'Número do processo clínico';
   COMMENT ON COLUMN GRID_TASK_IMG.ID_DEPT IS 'Id do departamento';
   COMMENT ON COLUMN GRID_TASK_IMG.ID_CLINICAL_SERVICE IS 'Id do serviço clínico';
   COMMENT ON COLUMN GRID_TASK_IMG.DT_SCHEDULE_TSTZ IS 'Data sugerida para o agendamento do exame';
   COMMENT ON COLUMN GRID_TASK_IMG.ID_EXAM_CAT IS 'Id da categoria do exame';


 ALTER TABLE GRID_TASK_IMG 
 ADD (PAT_AGE NUMBER(3)
 ,PAT_GENDER VARCHAR2(1)
 ,NUM_CLIN_RECORD VARCHAR2(12)
 ,ID_DEPT NUMBER(24)
 ,ID_CLINICAL_SERVICE NUMBER(12)
 ,DT_SCHEDULE_TSTZ TIMESTAMP WITH LOCAL TIME ZONE
 ,ID_EXAM_CAT NUMBER(24)
 );
 
   COMMENT ON COLUMN GRID_TASK_IMG.PAT_AGE IS 'Idade do paciente';
   COMMENT ON COLUMN GRID_TASK_IMG.PAT_GENDER IS 'Género do paciente';
   COMMENT ON COLUMN GRID_TASK_IMG.NUM_CLIN_RECORD IS 'Número do processo clínico';
   COMMENT ON COLUMN GRID_TASK_IMG.ID_DEPT IS 'Id do departamento';
   COMMENT ON COLUMN GRID_TASK_IMG.ID_CLINICAL_SERVICE IS 'Id do serviço clínico';
   COMMENT ON COLUMN GRID_TASK_IMG.DT_SCHEDULE_TSTZ IS 'Data sugerida para o agendamento do exame';
   COMMENT ON COLUMN GRID_TASK_IMG.ID_EXAM_CAT IS 'Id da categoria do exame';


   ALTER TABLE GRID_TASK_IMG 
 ADD (ID_PROFESSIONAL NUMBER(24)
 );

COMMENT ON COLUMN GRID_TASK_IMG.ID_PROFESSIONAL IS 'Professional''s ID'; 


ALTER TABLE GRID_TASK_IMG
 MODIFY (FLG_STATUS_REQ_DET VARCHAR2(2)
 );
 
-- CHANGED BY: Ana Matos
-- CHANGED DATE: 2009-ABR-14
-- CHANGED REASON: ALERT-23736

ALTER TABLE GRID_TASK_IMG 
 MODIFY (NUM_CLIN_RECORD VARCHAR2(100)
 );

-- CHANGE END: Ana Matos




-- CHANGED BY: Gustavo Serrano
-- CHANGE DATE: 07/07/2010 15:50
-- CHANGE REASON: [ALERT-110074] Order sets - TDE
ALTER TABLE GRID_TASK_IMG ADD (
    ID_TASK_DEPENDENCY NUMBER(24),
    FLG_REQ_ORIGIN_MODULE VARCHAR2(1 CHAR));
    
COMMENT ON COLUMN GRID_TASK_IMG.ID_TASK_DEPENDENCY IS 'Task dependency identifier';
COMMENT ON COLUMN GRID_TASK_IMG.FLG_REQ_ORIGIN_MODULE IS 'Request created by : D - Default, O - Order Sets, I - Interfaces';
-- CHANGE END: Gustavo Serrano

-- CHANGED BY: José Castro
-- CHANGED DATE: 2010-08-25
-- CHANGED REASON: ALERT-119685 - Change performed on RUN_FIRST.SQL on revision 613137
ALTER TABLE grid_task_img MODIFY pat_age VARCHAR2(30);
-- CHANGE END: José Castro


-- CHANGED BY: Ana Matos
-- CHANGE DATE: 13/03/2013 10:49
-- CHANGE REASON: [ALERT-253342] 
DECLARE
    e_object_exists EXCEPTION;

    PRAGMA EXCEPTION_INIT(e_object_exists, -01430);
BEGIN
    BEGIN
        EXECUTE IMMEDIATE 'ALTER TABLE GRID_TASK_IMG ADD (TRIAGE_COLOR_TEXT VARCHAR2(240), ID_TRIAGE_COLOR NUMBER(12))';

    EXCEPTION
        WHEN e_object_exists THEN
            dbms_output.put_line('Column already exists');
    END;
END;
/

COMMENT ON COLUMN GRID_TASK_IMG.TRIAGE_COLOR_TEXT IS 'Triage color text';
COMMENT ON COLUMN GRID_TASK_IMG.ID_ANNOUNCED_ARRIVAL IS 'Announced arrival id';
-- CHANGE END: Ana Matos

-- CHANGED BY: Ana Matos
-- CHANGE DATE: 08/01/2016 12:01
-- CHANGE REASON: [ALERT-317702] 
COMMENT ON TABLE GRID_TASK_IMG IS 'Imaging technician easy access';

COMMENT ON COLUMN GRID_TASK_IMG.ID_EXAM_REQ IS 'Order''s ID';
COMMENT ON COLUMN GRID_TASK_IMG.ID_EXAM_REQ_DET IS 'Exam''s order detail ID';
COMMENT ON COLUMN GRID_TASK_IMG.ID_PATIENT IS 'Pacient ID';
COMMENT ON COLUMN GRID_TASK_IMG.ID_EPISODE IS 'Episode ID';
COMMENT ON COLUMN GRID_TASK_IMG.ID_EPIS_TYPE IS 'Episode type ID';
COMMENT ON COLUMN GRID_TASK_IMG.FLG_STATUS_EPIS IS 'Flag that indicates the episode status: A - Active, I - Inactive, C - Canceled, P - Pending)';
COMMENT ON COLUMN GRID_TASK_IMG.ID_SOFTWARE IS 'Software ID';
COMMENT ON COLUMN GRID_TASK_IMG.ID_INSTITUTION IS 'Institution ID';
COMMENT ON COLUMN GRID_TASK_IMG.DT_FIRST_OBS_TSTZ IS 'Patient first observation date';
COMMENT ON COLUMN GRID_TASK_IMG.ID_EXAM IS 'Exam ID';
COMMENT ON COLUMN GRID_TASK_IMG.DT_REQ_TSTZ IS 'Date that indicates when tjhe order was registered';
COMMENT ON COLUMN GRID_TASK_IMG.DT_BEGIN_TSTZ IS 'Date for which the order is to be performed';
COMMENT ON COLUMN GRID_TASK_IMG.DT_PEND_REQ_TSTZ IS 'Date that indicates when the order has been updated from pending to ordered';
COMMENT ON COLUMN GRID_TASK_IMG.FLG_TIME_REQ IS 'To be performed: E - this episode; B - between episodes; N - next episode';
COMMENT ON COLUMN GRID_TASK_IMG.FLG_STATUS_REQ_DET IS 'Flag that indicates the exam''s order detail status';
COMMENT ON COLUMN GRID_TASK_IMG.FLG_STATUS_MOV IS 'Flag that indicates the exam''s transportation status';
COMMENT ON COLUMN GRID_TASK_IMG.DT_REQ_MOV_TSTZ IS 'Date that indicates when the transportation began';
COMMENT ON COLUMN GRID_TASK_IMG.DT_END_MOV_TSTZ IS 'Date that indicates when the transportation ended';
COMMENT ON COLUMN GRID_TASK_IMG.RANK IS 'Rank';
COMMENT ON COLUMN GRID_TASK_IMG.ACUITY IS 'Acuity';
COMMENT ON COLUMN GRID_TASK_IMG.RANK_ACUITY IS 'Rank acuity';
COMMENT ON COLUMN GRID_TASK_IMG.REQUEST IS 'Request column string used in technician grid';
COMMENT ON COLUMN GRID_TASK_IMG.TRANSPORT IS 'Transport column string used in technician grid';
COMMENT ON COLUMN GRID_TASK_IMG.EXECUTE IS 'Execute column string used in technician grid';
COMMENT ON COLUMN GRID_TASK_IMG.COMPLETE IS 'Complete column string used in technician grid';
COMMENT ON COLUMN GRID_TASK_IMG.ID_ROOM IS 'Room ID';
COMMENT ON COLUMN GRID_TASK_IMG.PAT_AGE IS 'Patient age';
COMMENT ON COLUMN GRID_TASK_IMG.PAT_GENDER IS 'Patient gender';
COMMENT ON COLUMN GRID_TASK_IMG.NUM_CLIN_RECORD IS 'Institution''s clinical record number';
COMMENT ON COLUMN GRID_TASK_IMG.ID_DEPT IS 'Dept ID';
COMMENT ON COLUMN GRID_TASK_IMG.ID_CLINICAL_SERVICE IS 'Clinical service ID';
COMMENT ON COLUMN GRID_TASK_IMG.DT_SCHEDULE_TSTZ IS 'Suggested date for scheduling';
COMMENT ON COLUMN GRID_TASK_IMG.ID_EXAM_CAT IS 'Exam category ID';
COMMENT ON COLUMN GRID_TASK_IMG.ID_PROFESSIONAL IS 'Professional ID';
COMMENT ON COLUMN GRID_TASK_IMG.CREATE_USER IS 'Creation User';
COMMENT ON COLUMN GRID_TASK_IMG.CREATE_TIME IS 'Creation Time';
COMMENT ON COLUMN GRID_TASK_IMG.CREATE_INSTITUTION IS 'Creation Institution';
COMMENT ON COLUMN GRID_TASK_IMG.UPDATE_USER IS 'Update User';
COMMENT ON COLUMN GRID_TASK_IMG.UPDATE_TIME IS 'Update Time';
COMMENT ON COLUMN GRID_TASK_IMG.UPDATE_INSTITUTION IS 'Update Institution';
COMMENT ON COLUMN GRID_TASK_IMG.ID_TASK_DEPENDENCY IS 'Task dependency ID';
COMMENT ON COLUMN GRID_TASK_IMG.FLG_REQ_ORIGIN_MODULE IS 'Request created by: D - Default, C - Care Plans, O - Order Sets, I - Interfaces; S - Scheduler;  R - Referral';
COMMENT ON COLUMN GRID_TASK_IMG.ID_ANNOUNCED_ARRIVAL IS 'Announced arrival ID';
COMMENT ON COLUMN GRID_TASK_IMG.TRIAGE_COLOR_TEXT IS 'Triage color text';
COMMENT ON COLUMN GRID_TASK_IMG.ID_TRIAGE_COLOR IS 'Triage color ID';
-- CHANGE END: Ana Matos

-- CHANGED BY: Ana Matos
-- CHANGE DATE: 08/04/2016 11:06
-- CHANGE REASON: [ALERT-320194] 
ALTER TABLE grid_task_img MODIFY request VARCHAR2(200 CHAR);
ALTER TABLE grid_task_img MODIFY transport VARCHAR2(200 CHAR);
ALTER TABLE grid_task_img MODIFY execute VARCHAR2(200 CHAR);
ALTER TABLE grid_task_img MODIFY complete VARCHAR2(200 CHAR);
-- CHANGE END: Ana Matos

-- CHANGED BY: Pedro Henriques
-- CHANGE DATE: 09/07/2018 11:29
-- CHANGE REASON: [EMR-4796] 
alter table alert.grid_task_img move  tablespace alert_data;
-- CHANGE END: Pedro Henriques

-- CHANGED BY: Diogo Oliveira
-- CHANGE DATE: 24/02/2021 14:31
-- CHANGE REASON: [EMR-42343] - Change the descriptions of the "Start date" and "Date to be defined" fields.
comment on column GRID_TASK_IMG.FLG_TIME_REQ is 'To be performed: E - this episode; B - before next episode; N - next episode; D - On a defined or to be defined date';
-- CHANGE END: Diogo Oliveira