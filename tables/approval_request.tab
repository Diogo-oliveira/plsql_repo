-- CHANGED BY: Sérgio Santos
-- CHANGE DATE: 19/08/2009 16:00
-- CHANGE REASON: [ALERT-641] Director software
CREATE TABLE APPROVAL_REQUEST
 (ID_APPROVAL_TYPE NUMBER(24) NOT NULL
 ,ID_EXTERNAL NUMBER(24) NOT NULL
 ,ID_PROF_REQ NUMBER(24) NOT NULL
 ,ID_PATIENT NUMBER(24) NOT NULL
 ,ID_EPISODE NUMBER(24)
 ,DT_REQUEST TIMESTAMP WITH LOCAL TIME ZONE NOT NULL
 ,ID_PROF_RESP NUMBER(24)
 ,FLG_STATUS VARCHAR2(1) NOT NULL
 ,FLG_ACTION VARCHAR2(1) NOT NULL
 ,ID_PROF_ACTION Number(24) NOT NULL
 ,APPROVAL_PROPERTIES VARCHAR2(10) null
 ,DT_ACTION TIMESTAMP WITH LOCAL TIME ZONE NOT NULL
 ,NOTES VARCHAR2(4000) NULL
 );

COMMENT ON TABLE APPROVAL_REQUEST IS 'Director approval resquests';

COMMENT ON COLUMN APPROVAL_REQUEST.ID_APPROVAL_TYPE IS 'Approval type identifier';
COMMENT ON COLUMN APPROVAL_REQUEST.ID_EXTERNAL IS 'External area identifier';
COMMENT ON COLUMN APPROVAL_REQUEST.ID_PROF_REQ IS 'Professional who ordered the approval';
COMMENT ON COLUMN APPROVAL_REQUEST.ID_PATIENT IS 'Patient identifier';
COMMENT ON COLUMN APPROVAL_REQUEST.ID_EPISODE IS 'Episode identifier';
COMMENT ON COLUMN APPROVAL_REQUEST.DT_REQUEST IS 'Approval request date';
COMMENT ON COLUMN APPROVAL_REQUEST.ID_PROF_RESP IS 'Professional identifier responsible for the approva';
COMMENT ON COLUMN APPROVAL_REQUEST.FLG_STATUS IS 'Status of the approval (P - Pending, A - Approved, R - Rejected, C - Cancelled(by the physician))';
COMMENT ON COLUMN APPROVAL_REQUEST.FLG_ACTION IS 'Action performed (N - Created the request, A - Approved the request, R - Rejected the request, G - Cancelled the request, C - Cancelled the decision, P - Changed professional responsible for the approval, S - Send an existing request for approval, U - Update the approval request without changing state)';
COMMENT ON COLUMN APPROVAL_REQUEST.ID_PROF_ACTION IS 'Professional identifier who made the action';
COMMENT ON COLUMN APPROVAL_REQUEST.APPROVAL_PROPERTIES IS 'Approval request properties list (A - Attached file)';
COMMENT ON COLUMN APPROVAL_REQUEST.DT_ACTION IS 'Approval action date';
COMMENT ON COLUMN APPROVAL_REQUEST.NOTES IS 'Action notes';

ALTER TABLE APPROVAL_REQUEST ADD (
   CREATE_USER VARCHAR2(24),
   CREATE_TIME TIMESTAMP (6) WITH LOCAL TIME ZONE,
   CREATE_INSTITUTION NUMBER(24,0),
   UPDATE_USER VARCHAR2(24),
   UPDATE_TIME TIMESTAMP (6) WITH LOCAL TIME ZONE,
   UPDATE_INSTITUTION NUMBER(24,0)
);
 
COMMENT ON COLUMN APPROVAL_REQUEST.CREATE_USER IS 'Creation User';
COMMENT ON COLUMN APPROVAL_REQUEST.CREATE_TIME IS 'Creation Time';
COMMENT ON COLUMN APPROVAL_REQUEST.CREATE_INSTITUTION IS 'Creation Institution';
COMMENT ON COLUMN APPROVAL_REQUEST.UPDATE_USER IS 'Update User';
COMMENT ON COLUMN APPROVAL_REQUEST.UPDATE_TIME IS 'Update Time';
COMMENT ON COLUMN APPROVAL_REQUEST.UPDATE_INSTITUTION IS 'Update Institution';
-- CHANGE END: Sérgio Santos

-- CHANGED BY: mario.mineiro
-- CHANGE DATE: 15/12/2014 12:27
-- CHANGE REASON: [ALERT-154361] 
alter table APPROVAL_REQUEST modify UPDATE_USER varchar2(24 CHAR);
/
-- CHANGE END: mario.mineiro

-- CHANGED BY: mario.mineiro
-- CHANGE DATE: 15/12/2014 12:27
-- CHANGE REASON: [ALERT-154361] 
alter table APPROVAL_REQUEST modify NOTES varchar2(4000 CHAR);
/
-- CHANGE END: mario.mineiro

-- CHANGED BY: mario.mineiro
-- CHANGE DATE: 15/12/2014 12:27
-- CHANGE REASON: [ALERT-154361] 
alter table APPROVAL_REQUEST modify FLG_STATUS varchar2(1 CHAR);
/
-- CHANGE END: mario.mineiro

-- CHANGED BY: mario.mineiro
-- CHANGE DATE: 15/12/2014 12:27
-- CHANGE REASON: [ALERT-154361] 
alter table APPROVAL_REQUEST modify FLG_ACTION varchar2(1 CHAR);
/
-- CHANGE END: mario.mineiro

-- CHANGED BY: mario.mineiro
-- CHANGE DATE: 15/12/2014 12:27
-- CHANGE REASON: [ALERT-154361] 
alter table APPROVAL_REQUEST modify CREATE_USER varchar2(24 CHAR);
/
-- CHANGE END: mario.mineiro

-- CHANGED BY: mario.mineiro
-- CHANGE DATE: 15/12/2014 12:27
-- CHANGE REASON: [ALERT-154361] 
alter table APPROVAL_REQUEST modify APPROVAL_PROPERTIES varchar2(10 CHAR);
/
-- CHANGE END: mario.mineiro