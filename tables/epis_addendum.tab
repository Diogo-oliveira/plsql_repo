-- CHANGED BY: Sérgio Santos
-- CHANGE DATE: 09/11/2010 20:26
-- CHANGE REASON: 
 ALTER TABLE EPIS_ADDENDUM
  MODIFY FLG_STATUS DEFAULT 'A';
-- CHANGE END: Sérgio Santos

-- CHANGED BY: Sérgio Santos
-- CHANGE DATE: 21/12/2010 12:22
-- CHANGE REASON: [ALERT-139534] 
declare
  e_protection EXCEPTION;
  PRAGMA EXCEPTION_INIT(e_protection, -00955);
begin
BEGIN
        EXECUTE IMMEDIATE 'CREATE TABLE EPIS_ADDENDUM (
  ID_EPIS_ADDENDUM          NUMBER(24) NOT NULL,
  ID_EPIS_SIGN_OFF          NUMBER(24) NOT NULL,
  ID_PROFESSIONAL           NUMBER(24) NOT NULL,
  DT_EVENT                  TIMESTAMP WITH LOCAL TIME ZONE NOT NULL,  
  ID_PROFESSIONAL_SIGN_OFF  NUMBER(24),
  DT_SIGN_OFF               TIMESTAMP WITH LOCAL TIME ZONE,
  NOTES                     CLOB,
  FLG_STATUS                VARCHAR2(1 CHAR) NOT NULL,
  ID_PROF_CANCEL            NUMBER(24) ,
  NOTES_CANCEL              VARCHAR2(1000 CHAR),
  DT_CANCEL                  TIMESTAMP(6) WITH LOCAL TIME ZONE,
  ID_CANCEL_REASON          NUMBER(24),
  CREATE_USER               VARCHAR2(24 CHAR),
  CREATE_TIME               TIMESTAMP(6) WITH LOCAL TIME ZONE,
  CREATE_INSTITUTION        NUMBER(24),
  UPDATE_USER               VARCHAR2(24 CHAR),
  UPDATE_TIME               TIMESTAMP(6) WITH LOCAL TIME ZONE,
  UPDATE_INSTITUTION        NUMBER(24)
)';
    EXCEPTION
        WHEN e_protection THEN
            dbms_output.put_line('Operation already performed');
    END;
end;
/
-- CHANGE END: Sérgio Santos

-- CHANGED BY: Sérgio Santos
-- CHANGE DATE: 21/12/2010 12:25
-- CHANGE REASON: [ALERT-139534] 
 ALTER TABLE EPIS_ADDENDUM
  MODIFY FLG_STATUS DEFAULT 'A';



COMMENT ON TABLE EPIS_ADDENDUM IS 'Table for register the episode addendums' ;
COMMENT ON COLUMN EPIS_ADDENDUM.ID_EPIS_ADDENDUM IS 'ID and Primary key';
COMMENT ON COLUMN EPIS_ADDENDUM.ID_EPIS_SIGN_OFF IS 'Episode Sign Off ID';
COMMENT ON COLUMN EPIS_ADDENDUM.ID_PROFESSIONAL IS 'ID of the professional that creates the addendum';
COMMENT ON COLUMN EPIS_ADDENDUM.DT_EVENT IS 'Addendum creation date';
COMMENT ON COLUMN EPIS_ADDENDUM.ID_PROFESSIONAL_SIGN_OFF IS 'ID of the professional that Signs off this addendum';
COMMENT ON COLUMN EPIS_ADDENDUM.DT_SIGN_OFF IS 'Addendum Sign off date';
COMMENT ON COLUMN EPIS_ADDENDUM.NOTES IS 'Addendum information (free text notes)';
COMMENT ON COLUMN EPIS_ADDENDUM.FLG_STATUS IS 'Addendum Status: A - active, C - cancelled, S - signed off';
COMMENT ON COLUMN EPIS_ADDENDUM.ID_PROF_CANCEL IS 'ID of the professional that cancels this addendum';
COMMENT ON COLUMN EPIS_ADDENDUM.NOTES_CANCEL IS 'Addendum cancel notes';
COMMENT ON COLUMN EPIS_ADDENDUM.DT_CANCEL IS 'Addendum cancelation date';
COMMENT ON COLUMN EPIS_ADDENDUM.ID_CANCEL_REASON IS 'Addendum cancel reason ID';
COMMENT ON COLUMN EPIS_ADDENDUM.CREATE_USER IS 'Creation User';
COMMENT ON COLUMN EPIS_ADDENDUM.CREATE_TIME IS 'Creation Time';
COMMENT ON COLUMN EPIS_ADDENDUM.CREATE_INSTITUTION IS 'Creation Institution';
COMMENT ON COLUMN EPIS_ADDENDUM.UPDATE_USER IS 'Update User';
COMMENT ON COLUMN EPIS_ADDENDUM.UPDATE_TIME IS 'Update Time';
COMMENT ON COLUMN EPIS_ADDENDUM.UPDATE_INSTITUTION IS 'Update Institution';
-- CHANGE END: Sérgio Santos

-- CHANGED BY: Pedro Henriques
-- CHANGE DATE: 09/07/2018 11:32
-- CHANGE REASON: [EMR-4796] 
DECLARE l_sql VARCHAR2(1000 CHAR);
BEGIN
    l_sql := 'ALTER TABLE alert.epis_addendum move lob(notes) store AS (tablespace alert_lob)';
    pk_versioning.run(l_sql);
EXCEPTION
    WHEN OTHERS THEN
        NULL;
END;
/
-- CHANGE END: Pedro Henriques