-- CHANGED BY: Joana Barroso
-- CHANGE DATE: 23/03/2012 10:44
-- CHANGE REASON: [ALERT-224618] 
DECLARE
    l_var PLS_INTEGER;
BEGIN
    SELECT COUNT(1)
      INTO l_var
      FROM user_tables ut
     WHERE ut.table_name = 'P1_REASON_CODE_SOFT_INST';
    IF l_var < 1
    THEN
        EXECUTE IMMEDIATE 'CREATE TABLE P1_REASON_CODE_SOFT_INST(
ID_REASON_CODE NUMBER(24,0) NOT NULL,
ID_PROFILE_TEMPLATE NUMBER(12,0) NOT NULL,
ID_SOFTWARE NUMBER(24,0) NOT NULL,
ID_INSTITUTION NUMBER(24,0) NOT NULL,
FLG_AVAILABLE VARCHAR2(1) NOT NULL,
RANK NUMBER(6,0) NOT NULL,
CREATE_USER VARCHAR2(24) ,
CREATE_TIME TIMESTAMP(6) WITH LOCAL TIME ZONE ,
CREATE_INSTITUTION NUMBER(24,0) ,
UPDATE_USER VARCHAR2(24) ,
UPDATE_TIME TIMESTAMP(6) WITH LOCAL TIME ZONE ,
UPDATE_INSTITUTION NUMBER(24,0) )';    
    END IF;
END;
/


-- Para adicionar colunas pode ser usado código comentado
-- De momento só são suportados os tipos de dados mais comuns.
-- ALTER TABLE P1_REASON_CODE_SOFT_INST ADD ID_REASON_CODE NUMBER(24,0) NOT NULL;
-- ALTER TABLE P1_REASON_CODE_SOFT_INST ADD ID_PROFILE_TEMPLATE NUMBER(12,0) NOT NULL;
-- ALTER TABLE P1_REASON_CODE_SOFT_INST ADD ID_SOFTWARE NUMBER(24,0) NOT NULL;
-- ALTER TABLE P1_REASON_CODE_SOFT_INST ADD ID_INSTITUTION NUMBER(24,0) NOT NULL;
-- ALTER TABLE P1_REASON_CODE_SOFT_INST ADD FLG_AVAILABLE VARCHAR2(1) NOT NULL;
-- ALTER TABLE P1_REASON_CODE_SOFT_INST ADD RANK NUMBER(6,0) NOT NULL;
-- ALTER TABLE P1_REASON_CODE_SOFT_INST ADD CREATE_USER VARCHAR2(24) ;
-- ALTER TABLE P1_REASON_CODE_SOFT_INST ADD CREATE_TIME TIMESTAMP(6) WITH LOCAL TIME ZONE ;
-- ALTER TABLE P1_REASON_CODE_SOFT_INST ADD CREATE_INSTITUTION NUMBER(24,0) ;
-- ALTER TABLE P1_REASON_CODE_SOFT_INST ADD UPDATE_USER VARCHAR2(24) ;
-- ALTER TABLE P1_REASON_CODE_SOFT_INST ADD UPDATE_TIME TIMESTAMP(6) WITH LOCAL TIME ZONE ;
-- ALTER TABLE P1_REASON_CODE_SOFT_INST ADD UPDATE_INSTITUTION NUMBER(24,0) ;
COMMENT ON COLUMN P1_REASON_CODE_SOFT_INST.ID_REASON_CODE IS 'P1 reasons primary key';
COMMENT ON COLUMN P1_REASON_CODE_SOFT_INST.ID_PROFILE_TEMPLATE IS 'Profile template Id';
COMMENT ON COLUMN P1_REASON_CODE_SOFT_INST.ID_SOFTWARE IS 'Software Id';
COMMENT ON COLUMN P1_REASON_CODE_SOFT_INST.ID_INSTITUTION IS 'Institution Id';
COMMENT ON COLUMN P1_REASON_CODE_SOFT_INST.FLG_AVAILABLE IS 'Availability of this record';
COMMENT ON COLUMN P1_REASON_CODE_SOFT_INST.CREATE_USER IS 'Creation User';
COMMENT ON COLUMN P1_REASON_CODE_SOFT_INST.CREATE_TIME IS 'Creation Time';
COMMENT ON COLUMN P1_REASON_CODE_SOFT_INST.CREATE_INSTITUTION IS 'Creation Institution';
COMMENT ON COLUMN P1_REASON_CODE_SOFT_INST.UPDATE_USER IS 'Update User';
COMMENT ON COLUMN P1_REASON_CODE_SOFT_INST.UPDATE_TIME IS 'Update Time';
COMMENT ON COLUMN P1_REASON_CODE_SOFT_INST.UPDATE_INSTITUTION IS 'Update Institution';
COMMENT ON TABLE P1_REASON_CODE_SOFT_INST  IS 'P1 reasons configuration table.';
-- CHANGE END: Joana Barroso

-- CHANGED BY: Joao Sa
-- ISSUE: ALERT-317695 Database model documentation and comments corretions
comment on table P1_REASON_CODE_SOFT_INST
  is 'Referral reasons configuration ';
-- Add comments to the columns 
comment on column P1_REASON_CODE_SOFT_INST.id_reason_code
  is 'Reason';
comment on column P1_REASON_CODE_SOFT_INST.id_profile_template
  is 'Profile template';
comment on column P1_REASON_CODE_SOFT_INST.id_software
  is 'Software module';
comment on column P1_REASON_CODE_SOFT_INST.id_institution
  is 'Institution';
comment on column P1_REASON_CODE_SOFT_INST.flg_available
  is 'Is record available? Y/N';
comment on column P1_REASON_CODE_SOFT_INST.rank
  is 'Rank';
