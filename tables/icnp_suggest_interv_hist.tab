-- CHANGED BY: Elisabete Bugalho
-- CHANGE DATE: 25/02/2011 15:04
-- CHANGE REASON: [ALERT-164319] Issue Replication: Atitudes terapêuticas
-- Creating Table 'ICNP_SUGGEST_INTERV_HIST'
BEGIN

EXECUTE IMMEDIATE 'CREATE TABLE ICNP_SUGGEST_INTERV_HIST
 (ID_ICNP_SUG_INTERV_HIST NUMBER(24) NOT NULL
 ,ID_ICNP_SUG_INTERV NUMBER(24) NOT NULL
 ,ID_REQ NUMBER(24) NOT NULL
 ,ID_TASK NUMBER(24) NOT NULL
 ,ID_TASK_TYPE NUMBER(24) NOT NULL
 ,ID_COMPOSITION NUMBER(24) NOT NULL
 ,ID_PATIENT NUMBER(24) NOT NULL
 ,ID_EPISODE NUMBER(24) NOT NULL
 ,FLG_STATUS VARCHAR2(1 CHAR) NOT NULL
 ,ID_PROF_LAST_UPDATE NUMBER(24) NOT NULL
 ,DT_LAST_UPDATE TIMESTAMP WITH LOCAL TIME ZONE NOT NULL
 ,ID_ICNP_EPIS_INTERV NUMBER(24)
 ,CREATE_USER VARCHAR2(24 CHAR)
 ,CREATE_TIME TIMESTAMP(6) WITH LOCAL TIME ZONE
 ,CREATE_INSTITUTION NUMBER(24)
 ,UPDATE_USER VARCHAR2(24 CHAR)
 ,UPDATE_TIME TIMESTAMP(6) WITH LOCAL TIME ZONE
 ,UPDATE_INSTITUTION NUMBER(24)
 )';
EXCEPTION
        WHEN OTHERS THEN
            dbms_output.put_line('WARNING: Object already exists.');
END;
/

COMMENT ON COLUMN ICNP_SUGGEST_INTERV_HIST.ID_ICNP_SUG_INTERV_HIST IS 'the history of suggested interventions';

COMMENT ON COLUMN ICNP_SUGGEST_INTERV_HIST.ID_ICNP_SUG_INTERV_HIST IS 'table identifier';

COMMENT ON COLUMN ICNP_SUGGEST_INTERV_HIST.ID_ICNP_SUG_INTERV IS 'intervention suggestion ID';

COMMENT ON COLUMN ICNP_SUGGEST_INTERV_HIST.ID_REQ IS 'Requisition ID';

COMMENT ON COLUMN ICNP_SUGGEST_INTERV_HIST.ID_TASK_TYPE IS 'id task type';

COMMENT ON COLUMN ICNP_SUGGEST_INTERV_HIST.ID_TASK IS 'id task (exam, procedure ... )';

COMMENT ON COLUMN ICNP_SUGGEST_INTERV_HIST.ID_COMPOSITION IS 'id of nurse intervention';

COMMENT ON COLUMN ICNP_SUGGEST_INTERV_HIST.ID_PATIENT IS 'id patient';

COMMENT ON COLUMN ICNP_SUGGEST_INTERV_HIST.ID_EPISODE IS 'id episode';

COMMENT ON COLUMN ICNP_SUGGEST_INTERV_HIST.FLG_STATUS IS 'status of suggested intervention';

COMMENT ON COLUMN ICNP_SUGGEST_INTERV_HIST.ID_PROF_LAST_UPDATE IS 'id of professional that last updated the intervention';

COMMENT ON COLUMN ICNP_SUGGEST_INTERV_HIST.DT_LAST_UPDATE IS 'date of last update';

COMMENT ON COLUMN ICNP_SUGGEST_INTERV_HIST.ID_ICNP_EPIS_INTERV IS 'Id for nurse intervention';

COMMENT ON COLUMN ICNP_SUGGEST_INTERV_HIST.CREATE_USER IS 'Creation User';

COMMENT ON COLUMN ICNP_SUGGEST_INTERV_HIST.CREATE_TIME IS 'Creation Time';

COMMENT ON COLUMN ICNP_SUGGEST_INTERV_HIST.CREATE_INSTITUTION IS 'Creation Institution';

COMMENT ON COLUMN ICNP_SUGGEST_INTERV_HIST.UPDATE_USER IS 'Update User';

COMMENT ON COLUMN ICNP_SUGGEST_INTERV_HIST.UPDATE_TIME IS 'Update Time';

COMMENT ON COLUMN ICNP_SUGGEST_INTERV_HIST.UPDATE_INSTITUTION IS 'Update Institution';
-- CHANGE END: Elisabete Bugalho

-- CHANGED BY:  Nuno Neves
-- CHANGE DATE: 13/03/2012 17:00
-- CHANGE REASON: [ALERT-223084] 
DECLARE
    e_already_exists EXCEPTION;
    PRAGMA EXCEPTION_INIT(e_already_exists, -01430); -- name is already used by an existing object
BEGIN
    EXECUTE IMMEDIATE 'ALTER TABLE icnp_suggest_interv_hist ADD flg_status_rel varchar2(1) default ''A''  not null';
EXCEPTION
    WHEN e_already_exists THEN
        dbms_output.put_line('column already exists');
END;
/
-- CHANGE END:  Nuno Neves

-- CHANGED BY:  Nuno Neves
-- CHANGE DATE: 13/03/2012 17:00
-- CHANGE REASON: [ALERT-223084] 
comment on column ICNP_SUGGEST_INTERV_HIST.FLG_STATUS_REL
  is 'State of the relationship of the intervention A - active, C - cancel, I - discontinued, H - hold, R - reactivated';
-- CHANGE END:  Nuno Neves

-- CHANGED BY: Ana Matos
-- CHANGE DATE: 19/01/2016 10:41
-- CHANGE REASON: [ALERT-317912] 
comment on table ICNP_SUGGEST_INTERV_HIST is 'ICNP suggested actions history';
-- CHANGE END: Ana Matos