/*-- Last Change Revision: $Rev: 2028412 $*/
/*-- Last Change by: $Author: mario.fernandes $*/
/*-- Date of last change: $Date: 2022-08-02 18:45:37 +0100 (ter, 02 ago 2022) $*/

CREATE OR REPLACE PACKAGE BODY ts_viewer_ehr_ea
/*
| Generated by or retrieved - DO NOT MODIFY!
| Created On: 2020-06-03 14:16:26
| Created By: ALERT
*/
 IS

    e_null_column_value EXCEPTION;
    PRAGMA EXCEPTION_INIT(e_null_column_value, -1400);

    e_existing_fky_reference EXCEPTION;
    PRAGMA EXCEPTION_INIT(e_existing_fky_reference, -2266);

    e_check_constraint_failure EXCEPTION;
    PRAGMA EXCEPTION_INIT(e_check_constraint_failure, -2290);

    e_no_parent_key EXCEPTION;
    PRAGMA EXCEPTION_INIT(e_no_parent_key, -2291);

    e_child_record_found EXCEPTION;
    PRAGMA EXCEPTION_INIT(e_child_record_found, -2292);

    e_forall_error EXCEPTION;
    PRAGMA EXCEPTION_INIT(e_forall_error, -24381);

    -- Defined for backward compatibilty.
    e_integ_constraint_failure EXCEPTION;
    PRAGMA EXCEPTION_INIT(e_integ_constraint_failure, -2291);

    PROCEDURE ins
    (
        id_patient_in         IN viewer_ehr_ea.id_patient%TYPE,
        num_allergy_in        IN viewer_ehr_ea.num_allergy%TYPE DEFAULT NULL,
        desc_allergy_in       IN viewer_ehr_ea.desc_allergy%TYPE DEFAULT NULL,
        dt_allergy_in         IN viewer_ehr_ea.dt_allergy%TYPE DEFAULT NULL,
        dt_allergy_fmt_in     IN viewer_ehr_ea.dt_allergy_fmt%TYPE DEFAULT NULL,
        num_lab_in            IN viewer_ehr_ea.num_lab%TYPE DEFAULT NULL,
        desc_lab_in           IN viewer_ehr_ea.desc_lab%TYPE DEFAULT NULL,
        dt_lab_in             IN viewer_ehr_ea.dt_lab%TYPE DEFAULT NULL,
        num_diag_icnp_in      IN viewer_ehr_ea.num_diag_icnp%TYPE DEFAULT NULL,
        desc_diag_icnp_in     IN viewer_ehr_ea.desc_diag_icnp%TYPE DEFAULT NULL,
        dt_diag_icnp_in       IN viewer_ehr_ea.dt_diag_icnp%TYPE DEFAULT NULL,
        num_episode_in        IN viewer_ehr_ea.num_episode%TYPE DEFAULT NULL,
        desc_episode_in       IN viewer_ehr_ea.desc_episode%TYPE DEFAULT NULL,
        dt_episode_in         IN viewer_ehr_ea.dt_episode%TYPE DEFAULT NULL,
        num_exam_in           IN viewer_ehr_ea.num_exam%TYPE DEFAULT NULL,
        desc_exam_in          IN viewer_ehr_ea.desc_exam%TYPE DEFAULT NULL,
        dt_exam_in            IN viewer_ehr_ea.dt_exam%TYPE DEFAULT NULL,
        num_med_in            IN viewer_ehr_ea.num_med%TYPE DEFAULT NULL,
        desc_med_in           IN viewer_ehr_ea.desc_med%TYPE DEFAULT NULL,
        dt_med_in             IN viewer_ehr_ea.dt_med%TYPE DEFAULT NULL,
        num_problem_in        IN viewer_ehr_ea.num_problem%TYPE DEFAULT NULL,
        desc_problem_in       IN viewer_ehr_ea.desc_problem%TYPE DEFAULT NULL,
        dt_problem_in         IN viewer_ehr_ea.dt_problem%TYPE DEFAULT NULL,
        dt_problem_fmt_in     IN viewer_ehr_ea.dt_problem_fmt%TYPE DEFAULT NULL,
        num_interv_in         IN viewer_ehr_ea.num_interv%TYPE DEFAULT NULL,
        desc_interv_in        IN viewer_ehr_ea.desc_interv%TYPE DEFAULT NULL,
        dt_interv_in          IN viewer_ehr_ea.dt_interv%TYPE DEFAULT NULL,
        dt_dg_last_update_in  IN viewer_ehr_ea.dt_dg_last_update%TYPE DEFAULT current_timestamp,
        code_allergy_in       IN viewer_ehr_ea.code_allergy%TYPE DEFAULT NULL,
        code_episode_in       IN viewer_ehr_ea.code_episode%TYPE DEFAULT NULL,
        code_exam_in          IN viewer_ehr_ea.code_exam%TYPE DEFAULT NULL,
        code_med_in           IN viewer_ehr_ea.code_med%TYPE DEFAULT NULL,
        code_problem_in       IN viewer_ehr_ea.code_problem%TYPE DEFAULT NULL,
        code_lab_in           IN viewer_ehr_ea.code_lab%TYPE DEFAULT NULL,
        code_diag_icnp_in     IN viewer_ehr_ea.code_diag_icnp%TYPE DEFAULT NULL,
        code_interv_in        IN viewer_ehr_ea.code_interv%TYPE DEFAULT NULL,
        create_user_in        IN viewer_ehr_ea.create_user%TYPE DEFAULT NULL,
        create_time_in        IN viewer_ehr_ea.create_time%TYPE DEFAULT NULL,
        create_institution_in IN viewer_ehr_ea.create_institution%TYPE DEFAULT NULL,
        update_user_in        IN viewer_ehr_ea.update_user%TYPE DEFAULT NULL,
        update_time_in        IN viewer_ehr_ea.update_time%TYPE DEFAULT NULL,
        update_institution_in IN viewer_ehr_ea.update_institution%TYPE DEFAULT NULL,
        flg_exclamation_in    IN viewer_ehr_ea.flg_exclamation%TYPE DEFAULT 'N',
        flg_infective_in      IN viewer_ehr_ea.flg_infective%TYPE DEFAULT 'N',
        num_vs_in             IN viewer_ehr_ea.num_vs%TYPE DEFAULT NULL,
        desc_vs_in            IN viewer_ehr_ea.desc_vs%TYPE DEFAULT NULL,
        dt_vs_in              IN viewer_ehr_ea.dt_vs%TYPE DEFAULT NULL,
        code_vs_in            IN viewer_ehr_ea.code_vs%TYPE DEFAULT NULL,
        num_note_in           IN viewer_ehr_ea.num_note%TYPE DEFAULT NULL,
        desc_note_in          IN viewer_ehr_ea.desc_note%TYPE DEFAULT NULL,
        dt_note_in            IN viewer_ehr_ea.dt_note%TYPE DEFAULT NULL,
        code_note_in          IN viewer_ehr_ea.code_note%TYPE DEFAULT NULL,
        num_archive_in        IN viewer_ehr_ea.num_archive%TYPE DEFAULT NULL,
        desc_archive_in       IN viewer_ehr_ea.desc_archive%TYPE DEFAULT NULL,
        dt_archive_in         IN viewer_ehr_ea.dt_archive%TYPE DEFAULT NULL,
        code_archive_in       IN viewer_ehr_ea.code_archive%TYPE DEFAULT NULL,
        num_epis_archive_in   IN viewer_ehr_ea.num_epis_archive%TYPE DEFAULT NULL,
        desc_epis_archive_in  IN viewer_ehr_ea.desc_epis_archive%TYPE DEFAULT NULL,
        dt_epis_archive_in    IN viewer_ehr_ea.dt_epis_archive%TYPE DEFAULT NULL,
        code_epis_archive_in  IN viewer_ehr_ea.code_epis_archive%TYPE DEFAULT NULL,
        num_bp_in             IN viewer_ehr_ea.num_bp%TYPE DEFAULT NULL,
        dt_bp_in              IN viewer_ehr_ea.dt_bp%TYPE DEFAULT NULL,
        code_bp_in            IN viewer_ehr_ea.code_bp%TYPE DEFAULT NULL,
        desc_bp_in            IN viewer_ehr_ea.desc_bp%TYPE DEFAULT NULL,
        id_problem_in         IN viewer_ehr_ea.id_problem%TYPE DEFAULT NULL,
        id_task_type_in       IN viewer_ehr_ea.id_task_type%TYPE DEFAULT NULL,
        handle_error_in       IN BOOLEAN := TRUE,
        rows_out              OUT table_varchar
    ) IS
    BEGIN
        INSERT INTO viewer_ehr_ea
            (id_patient,
             num_allergy,
             desc_allergy,
             dt_allergy,
             dt_allergy_fmt,
             num_lab,
             desc_lab,
             dt_lab,
             num_diag_icnp,
             desc_diag_icnp,
             dt_diag_icnp,
             num_episode,
             desc_episode,
             dt_episode,
             num_exam,
             desc_exam,
             dt_exam,
             num_med,
             desc_med,
             dt_med,
             num_problem,
             desc_problem,
             dt_problem,
             dt_problem_fmt,
             num_interv,
             desc_interv,
             dt_interv,
             dt_dg_last_update,
             code_allergy,
             code_episode,
             code_exam,
             code_med,
             code_problem,
             code_lab,
             code_diag_icnp,
             code_interv,
             create_user,
             create_time,
             create_institution,
             update_user,
             update_time,
             update_institution,
             flg_exclamation,
             flg_infective,
             num_vs,
             desc_vs,
             dt_vs,
             code_vs,
             num_note,
             desc_note,
             dt_note,
             code_note,
             num_archive,
             desc_archive,
             dt_archive,
             code_archive,
             num_epis_archive,
             desc_epis_archive,
             dt_epis_archive,
             code_epis_archive,
             num_bp,
             dt_bp,
             code_bp,
             desc_bp,
             id_problem,
             id_task_type)
        VALUES
            (id_patient_in,
             num_allergy_in,
             desc_allergy_in,
             dt_allergy_in,
             dt_allergy_fmt_in,
             num_lab_in,
             desc_lab_in,
             dt_lab_in,
             num_diag_icnp_in,
             desc_diag_icnp_in,
             dt_diag_icnp_in,
             num_episode_in,
             desc_episode_in,
             dt_episode_in,
             num_exam_in,
             desc_exam_in,
             dt_exam_in,
             num_med_in,
             desc_med_in,
             dt_med_in,
             num_problem_in,
             desc_problem_in,
             dt_problem_in,
             dt_problem_fmt_in,
             num_interv_in,
             desc_interv_in,
             dt_interv_in,
             dt_dg_last_update_in,
             code_allergy_in,
             code_episode_in,
             code_exam_in,
             code_med_in,
             code_problem_in,
             code_lab_in,
             code_diag_icnp_in,
             code_interv_in,
             create_user_in,
             create_time_in,
             create_institution_in,
             update_user_in,
             update_time_in,
             update_institution_in,
             flg_exclamation_in,
             flg_infective_in,
             num_vs_in,
             desc_vs_in,
             dt_vs_in,
             code_vs_in,
             num_note_in,
             desc_note_in,
             dt_note_in,
             code_note_in,
             num_archive_in,
             desc_archive_in,
             dt_archive_in,
             code_archive_in,
             num_epis_archive_in,
             desc_epis_archive_in,
             dt_epis_archive_in,
             code_epis_archive_in,
             num_bp_in,
             dt_bp_in,
             code_bp_in,
             desc_bp_in,
             id_problem_in,
             id_task_type_in)
        RETURNING ROWID BULK COLLECT INTO rows_out;
    
    EXCEPTION
        WHEN e_null_column_value
             OR e_existing_fky_reference
             OR e_check_constraint_failure
             OR e_no_parent_key
             OR e_child_record_found
             OR e_forall_error
             OR e_integ_constraint_failure THEN
            IF NOT handle_error_in
            THEN
                RAISE;
            ELSE
                pk_alertlog.log_error('DML error ignored: ' || SQLCODE || ': ' || SQLERRM);
            END IF;
        
    END ins;

    PROCEDURE ins
    (
        id_patient_in         IN viewer_ehr_ea.id_patient%TYPE,
        num_allergy_in        IN viewer_ehr_ea.num_allergy%TYPE DEFAULT NULL,
        desc_allergy_in       IN viewer_ehr_ea.desc_allergy%TYPE DEFAULT NULL,
        dt_allergy_in         IN viewer_ehr_ea.dt_allergy%TYPE DEFAULT NULL,
        dt_allergy_fmt_in     IN viewer_ehr_ea.dt_allergy_fmt%TYPE DEFAULT NULL,
        num_lab_in            IN viewer_ehr_ea.num_lab%TYPE DEFAULT NULL,
        desc_lab_in           IN viewer_ehr_ea.desc_lab%TYPE DEFAULT NULL,
        dt_lab_in             IN viewer_ehr_ea.dt_lab%TYPE DEFAULT NULL,
        num_diag_icnp_in      IN viewer_ehr_ea.num_diag_icnp%TYPE DEFAULT NULL,
        desc_diag_icnp_in     IN viewer_ehr_ea.desc_diag_icnp%TYPE DEFAULT NULL,
        dt_diag_icnp_in       IN viewer_ehr_ea.dt_diag_icnp%TYPE DEFAULT NULL,
        num_episode_in        IN viewer_ehr_ea.num_episode%TYPE DEFAULT NULL,
        desc_episode_in       IN viewer_ehr_ea.desc_episode%TYPE DEFAULT NULL,
        dt_episode_in         IN viewer_ehr_ea.dt_episode%TYPE DEFAULT NULL,
        num_exam_in           IN viewer_ehr_ea.num_exam%TYPE DEFAULT NULL,
        desc_exam_in          IN viewer_ehr_ea.desc_exam%TYPE DEFAULT NULL,
        dt_exam_in            IN viewer_ehr_ea.dt_exam%TYPE DEFAULT NULL,
        num_med_in            IN viewer_ehr_ea.num_med%TYPE DEFAULT NULL,
        desc_med_in           IN viewer_ehr_ea.desc_med%TYPE DEFAULT NULL,
        dt_med_in             IN viewer_ehr_ea.dt_med%TYPE DEFAULT NULL,
        num_problem_in        IN viewer_ehr_ea.num_problem%TYPE DEFAULT NULL,
        desc_problem_in       IN viewer_ehr_ea.desc_problem%TYPE DEFAULT NULL,
        dt_problem_in         IN viewer_ehr_ea.dt_problem%TYPE DEFAULT NULL,
        dt_problem_fmt_in     IN viewer_ehr_ea.dt_problem_fmt%TYPE DEFAULT NULL,
        num_interv_in         IN viewer_ehr_ea.num_interv%TYPE DEFAULT NULL,
        desc_interv_in        IN viewer_ehr_ea.desc_interv%TYPE DEFAULT NULL,
        dt_interv_in          IN viewer_ehr_ea.dt_interv%TYPE DEFAULT NULL,
        dt_dg_last_update_in  IN viewer_ehr_ea.dt_dg_last_update%TYPE DEFAULT current_timestamp,
        code_allergy_in       IN viewer_ehr_ea.code_allergy%TYPE DEFAULT NULL,
        code_episode_in       IN viewer_ehr_ea.code_episode%TYPE DEFAULT NULL,
        code_exam_in          IN viewer_ehr_ea.code_exam%TYPE DEFAULT NULL,
        code_med_in           IN viewer_ehr_ea.code_med%TYPE DEFAULT NULL,
        code_problem_in       IN viewer_ehr_ea.code_problem%TYPE DEFAULT NULL,
        code_lab_in           IN viewer_ehr_ea.code_lab%TYPE DEFAULT NULL,
        code_diag_icnp_in     IN viewer_ehr_ea.code_diag_icnp%TYPE DEFAULT NULL,
        code_interv_in        IN viewer_ehr_ea.code_interv%TYPE DEFAULT NULL,
        create_user_in        IN viewer_ehr_ea.create_user%TYPE DEFAULT NULL,
        create_time_in        IN viewer_ehr_ea.create_time%TYPE DEFAULT NULL,
        create_institution_in IN viewer_ehr_ea.create_institution%TYPE DEFAULT NULL,
        update_user_in        IN viewer_ehr_ea.update_user%TYPE DEFAULT NULL,
        update_time_in        IN viewer_ehr_ea.update_time%TYPE DEFAULT NULL,
        update_institution_in IN viewer_ehr_ea.update_institution%TYPE DEFAULT NULL,
        flg_exclamation_in    IN viewer_ehr_ea.flg_exclamation%TYPE DEFAULT 'N',
        flg_infective_in      IN viewer_ehr_ea.flg_infective%TYPE DEFAULT 'N',
        num_vs_in             IN viewer_ehr_ea.num_vs%TYPE DEFAULT NULL,
        desc_vs_in            IN viewer_ehr_ea.desc_vs%TYPE DEFAULT NULL,
        dt_vs_in              IN viewer_ehr_ea.dt_vs%TYPE DEFAULT NULL,
        code_vs_in            IN viewer_ehr_ea.code_vs%TYPE DEFAULT NULL,
        num_note_in           IN viewer_ehr_ea.num_note%TYPE DEFAULT NULL,
        desc_note_in          IN viewer_ehr_ea.desc_note%TYPE DEFAULT NULL,
        dt_note_in            IN viewer_ehr_ea.dt_note%TYPE DEFAULT NULL,
        code_note_in          IN viewer_ehr_ea.code_note%TYPE DEFAULT NULL,
        num_archive_in        IN viewer_ehr_ea.num_archive%TYPE DEFAULT NULL,
        desc_archive_in       IN viewer_ehr_ea.desc_archive%TYPE DEFAULT NULL,
        dt_archive_in         IN viewer_ehr_ea.dt_archive%TYPE DEFAULT NULL,
        code_archive_in       IN viewer_ehr_ea.code_archive%TYPE DEFAULT NULL,
        num_epis_archive_in   IN viewer_ehr_ea.num_epis_archive%TYPE DEFAULT NULL,
        desc_epis_archive_in  IN viewer_ehr_ea.desc_epis_archive%TYPE DEFAULT NULL,
        dt_epis_archive_in    IN viewer_ehr_ea.dt_epis_archive%TYPE DEFAULT NULL,
        code_epis_archive_in  IN viewer_ehr_ea.code_epis_archive%TYPE DEFAULT NULL,
        num_bp_in             IN viewer_ehr_ea.num_bp%TYPE DEFAULT NULL,
        dt_bp_in              IN viewer_ehr_ea.dt_bp%TYPE DEFAULT NULL,
        code_bp_in            IN viewer_ehr_ea.code_bp%TYPE DEFAULT NULL,
        desc_bp_in            IN viewer_ehr_ea.desc_bp%TYPE DEFAULT NULL,
        id_problem_in         IN viewer_ehr_ea.id_problem%TYPE DEFAULT NULL,
        id_task_type_in       IN viewer_ehr_ea.id_task_type%TYPE DEFAULT NULL,
        handle_error_in       IN BOOLEAN := TRUE
    ) IS
        rows_out table_varchar;
    BEGIN
        ins(id_patient_in         => id_patient_in,
            num_allergy_in        => num_allergy_in,
            desc_allergy_in       => desc_allergy_in,
            dt_allergy_in         => dt_allergy_in,
            dt_allergy_fmt_in     => dt_allergy_fmt_in,
            num_lab_in            => num_lab_in,
            desc_lab_in           => desc_lab_in,
            dt_lab_in             => dt_lab_in,
            num_diag_icnp_in      => num_diag_icnp_in,
            desc_diag_icnp_in     => desc_diag_icnp_in,
            dt_diag_icnp_in       => dt_diag_icnp_in,
            num_episode_in        => num_episode_in,
            desc_episode_in       => desc_episode_in,
            dt_episode_in         => dt_episode_in,
            num_exam_in           => num_exam_in,
            desc_exam_in          => desc_exam_in,
            dt_exam_in            => dt_exam_in,
            num_med_in            => num_med_in,
            desc_med_in           => desc_med_in,
            dt_med_in             => dt_med_in,
            num_problem_in        => num_problem_in,
            desc_problem_in       => desc_problem_in,
            dt_problem_in         => dt_problem_in,
            dt_problem_fmt_in     => dt_problem_fmt_in,
            num_interv_in         => num_interv_in,
            desc_interv_in        => desc_interv_in,
            dt_interv_in          => dt_interv_in,
            dt_dg_last_update_in  => dt_dg_last_update_in,
            code_allergy_in       => code_allergy_in,
            code_episode_in       => code_episode_in,
            code_exam_in          => code_exam_in,
            code_med_in           => code_med_in,
            code_problem_in       => code_problem_in,
            code_lab_in           => code_lab_in,
            code_diag_icnp_in     => code_diag_icnp_in,
            code_interv_in        => code_interv_in,
            create_user_in        => create_user_in,
            create_time_in        => create_time_in,
            create_institution_in => create_institution_in,
            update_user_in        => update_user_in,
            update_time_in        => update_time_in,
            update_institution_in => update_institution_in,
            flg_exclamation_in    => flg_exclamation_in,
            flg_infective_in      => flg_infective_in,
            num_vs_in             => num_vs_in,
            desc_vs_in            => desc_vs_in,
            dt_vs_in              => dt_vs_in,
            code_vs_in            => code_vs_in,
            num_note_in           => num_note_in,
            desc_note_in          => desc_note_in,
            dt_note_in            => dt_note_in,
            code_note_in          => code_note_in,
            num_archive_in        => num_archive_in,
            desc_archive_in       => desc_archive_in,
            dt_archive_in         => dt_archive_in,
            code_archive_in       => code_archive_in,
            num_epis_archive_in   => num_epis_archive_in,
            desc_epis_archive_in  => desc_epis_archive_in,
            dt_epis_archive_in    => dt_epis_archive_in,
            code_epis_archive_in  => code_epis_archive_in,
            num_bp_in             => num_bp_in,
            dt_bp_in              => dt_bp_in,
            code_bp_in            => code_bp_in,
            desc_bp_in            => desc_bp_in,
            id_problem_in         => id_problem_in,
            id_task_type_in       => id_task_type_in,
            handle_error_in       => handle_error_in,
            rows_out              => rows_out);
    END ins;

    PROCEDURE ins
    (
        rec_in          IN viewer_ehr_ea%ROWTYPE,
        gen_pky_in      IN BOOLEAN DEFAULT FALSE,
        sequence_in     IN VARCHAR2 := NULL,
        handle_error_in IN BOOLEAN := TRUE,
        rows_out        OUT table_varchar
    ) IS
        l_rec viewer_ehr_ea%ROWTYPE := rec_in;
    BEGIN
    
        ins(id_patient_in         => l_rec.id_patient,
            num_allergy_in        => l_rec.num_allergy,
            desc_allergy_in       => l_rec.desc_allergy,
            dt_allergy_in         => l_rec.dt_allergy,
            dt_allergy_fmt_in     => l_rec.dt_allergy_fmt,
            num_lab_in            => l_rec.num_lab,
            desc_lab_in           => l_rec.desc_lab,
            dt_lab_in             => l_rec.dt_lab,
            num_diag_icnp_in      => l_rec.num_diag_icnp,
            desc_diag_icnp_in     => l_rec.desc_diag_icnp,
            dt_diag_icnp_in       => l_rec.dt_diag_icnp,
            num_episode_in        => l_rec.num_episode,
            desc_episode_in       => l_rec.desc_episode,
            dt_episode_in         => l_rec.dt_episode,
            num_exam_in           => l_rec.num_exam,
            desc_exam_in          => l_rec.desc_exam,
            dt_exam_in            => l_rec.dt_exam,
            num_med_in            => l_rec.num_med,
            desc_med_in           => l_rec.desc_med,
            dt_med_in             => l_rec.dt_med,
            num_problem_in        => l_rec.num_problem,
            desc_problem_in       => l_rec.desc_problem,
            dt_problem_in         => l_rec.dt_problem,
            dt_problem_fmt_in     => l_rec.dt_problem_fmt,
            num_interv_in         => l_rec.num_interv,
            desc_interv_in        => l_rec.desc_interv,
            dt_interv_in          => l_rec.dt_interv,
            dt_dg_last_update_in  => l_rec.dt_dg_last_update,
            code_allergy_in       => l_rec.code_allergy,
            code_episode_in       => l_rec.code_episode,
            code_exam_in          => l_rec.code_exam,
            code_med_in           => l_rec.code_med,
            code_problem_in       => l_rec.code_problem,
            code_lab_in           => l_rec.code_lab,
            code_diag_icnp_in     => l_rec.code_diag_icnp,
            code_interv_in        => l_rec.code_interv,
            create_user_in        => l_rec.create_user,
            create_time_in        => l_rec.create_time,
            create_institution_in => l_rec.create_institution,
            update_user_in        => l_rec.update_user,
            update_time_in        => l_rec.update_time,
            update_institution_in => l_rec.update_institution,
            flg_exclamation_in    => l_rec.flg_exclamation,
            flg_infective_in      => l_rec.flg_infective,
            num_vs_in             => l_rec.num_vs,
            desc_vs_in            => l_rec.desc_vs,
            dt_vs_in              => l_rec.dt_vs,
            code_vs_in            => l_rec.code_vs,
            num_note_in           => l_rec.num_note,
            desc_note_in          => l_rec.desc_note,
            dt_note_in            => l_rec.dt_note,
            code_note_in          => l_rec.code_note,
            num_archive_in        => l_rec.num_archive,
            desc_archive_in       => l_rec.desc_archive,
            dt_archive_in         => l_rec.dt_archive,
            code_archive_in       => l_rec.code_archive,
            num_epis_archive_in   => l_rec.num_epis_archive,
            desc_epis_archive_in  => l_rec.desc_epis_archive,
            dt_epis_archive_in    => l_rec.dt_epis_archive,
            code_epis_archive_in  => l_rec.code_epis_archive,
            num_bp_in             => l_rec.num_bp,
            dt_bp_in              => l_rec.dt_bp,
            code_bp_in            => l_rec.code_bp,
            desc_bp_in            => l_rec.desc_bp,
            id_problem_in         => l_rec.id_problem,
            id_task_type_in       => l_rec.id_task_type,
            handle_error_in       => handle_error_in,
            rows_out              => rows_out);
    END ins;

    PROCEDURE ins
    (
        rec_in          IN viewer_ehr_ea%ROWTYPE,
        gen_pky_in      IN BOOLEAN DEFAULT FALSE,
        sequence_in     IN VARCHAR2 := NULL,
        handle_error_in IN BOOLEAN := TRUE
    ) IS
        rows_out table_varchar;
    BEGIN
        ins(rec_in          => rec_in,
            gen_pky_in      => gen_pky_in,
            sequence_in     => sequence_in,
            handle_error_in => handle_error_in,
            rows_out        => rows_out);
    END ins;

    -- Insert a collection of rows using FORALL; all primary key values
    -- must have already been generated, or are handled in triggers
    PROCEDURE ins
    (
        rows_in         IN viewer_ehr_ea_tc,
        handle_error_in IN BOOLEAN := TRUE,
        rows_out        OUT table_varchar
    ) IS
    BEGIN
        IF rows_in.count = 0
        THEN
            NULL;
        ELSE
            FORALL indx IN rows_in.first .. rows_in.last SAVE EXCEPTIONS
                INSERT INTO viewer_ehr_ea
                    (id_patient,
                     num_allergy,
                     desc_allergy,
                     dt_allergy,
                     dt_allergy_fmt,
                     num_lab,
                     desc_lab,
                     dt_lab,
                     num_diag_icnp,
                     desc_diag_icnp,
                     dt_diag_icnp,
                     num_episode,
                     desc_episode,
                     dt_episode,
                     num_exam,
                     desc_exam,
                     dt_exam,
                     num_med,
                     desc_med,
                     dt_med,
                     num_problem,
                     desc_problem,
                     dt_problem,
                     dt_problem_fmt,
                     num_interv,
                     desc_interv,
                     dt_interv,
                     dt_dg_last_update,
                     code_allergy,
                     code_episode,
                     code_exam,
                     code_med,
                     code_problem,
                     code_lab,
                     code_diag_icnp,
                     code_interv,
                     flg_exclamation,
                     flg_infective,
                     num_vs,
                     desc_vs,
                     dt_vs,
                     code_vs,
                     num_note,
                     desc_note,
                     dt_note,
                     code_note,
                     num_archive,
                     desc_archive,
                     dt_archive,
                     code_archive,
                     num_epis_archive,
                     desc_epis_archive,
                     dt_epis_archive,
                     code_epis_archive,
                     num_bp,
                     dt_bp,
                     code_bp,
                     desc_bp,
                     id_problem,
                     id_task_type)
                VALUES
                    (rows_in(indx).id_patient,
                     rows_in(indx).num_allergy,
                     rows_in(indx).desc_allergy,
                     rows_in(indx).dt_allergy,
                     rows_in(indx).dt_allergy_fmt,
                     rows_in(indx).num_lab,
                     rows_in(indx).desc_lab,
                     rows_in(indx).dt_lab,
                     rows_in(indx).num_diag_icnp,
                     rows_in(indx).desc_diag_icnp,
                     rows_in(indx).dt_diag_icnp,
                     rows_in(indx).num_episode,
                     rows_in(indx).desc_episode,
                     rows_in(indx).dt_episode,
                     rows_in(indx).num_exam,
                     rows_in(indx).desc_exam,
                     rows_in(indx).dt_exam,
                     rows_in(indx).num_med,
                     rows_in(indx).desc_med,
                     rows_in(indx).dt_med,
                     rows_in(indx).num_problem,
                     rows_in(indx).desc_problem,
                     rows_in(indx).dt_problem,
                     rows_in(indx).dt_problem_fmt,
                     rows_in(indx).num_interv,
                     rows_in(indx).desc_interv,
                     rows_in(indx).dt_interv,
                     rows_in(indx).dt_dg_last_update,
                     rows_in(indx).code_allergy,
                     rows_in(indx).code_episode,
                     rows_in(indx).code_exam,
                     rows_in(indx).code_med,
                     rows_in(indx).code_problem,
                     rows_in(indx).code_lab,
                     rows_in(indx).code_diag_icnp,
                     rows_in(indx).code_interv,
                     rows_in(indx).flg_exclamation,
                     rows_in(indx).flg_infective,
                     rows_in(indx).num_vs,
                     rows_in(indx).desc_vs,
                     rows_in(indx).dt_vs,
                     rows_in(indx).code_vs,
                     rows_in(indx).num_note,
                     rows_in(indx).desc_note,
                     rows_in(indx).dt_note,
                     rows_in(indx).code_note,
                     rows_in(indx).num_archive,
                     rows_in(indx).desc_archive,
                     rows_in(indx).dt_archive,
                     rows_in(indx).code_archive,
                     rows_in(indx).num_epis_archive,
                     rows_in(indx).desc_epis_archive,
                     rows_in(indx).dt_epis_archive,
                     rows_in(indx).code_epis_archive,
                     rows_in(indx).num_bp,
                     rows_in(indx).dt_bp,
                     rows_in(indx).code_bp,
                     rows_in(indx).desc_bp,
                     rows_in(indx).id_problem,
                     rows_in(indx).id_task_type)
                RETURNING ROWID BULK COLLECT INTO rows_out;
        END IF;
    
    EXCEPTION
        WHEN e_forall_error THEN
            IF NOT handle_error_in
            THEN
                RAISE;
            ELSE
                FOR indx IN 1 .. SQL%bulk_exceptions.count
                LOOP
                    pk_alertlog.log_error('DML error ignored: ' || SQLCODE || ': ' || SQLERRM);
                END LOOP;
            END IF;
        WHEN OTHERS THEN
            IF NOT handle_error_in
            THEN
                RAISE;
            ELSE
                pk_alertlog.log_error('DML error ignored: ' || SQLCODE || ': ' || SQLERRM);
            END IF;
        
    END ins;

    -- Insert a collection of rows using FORALL; all primary key values
    -- must have already been generated, or are handled in triggers
    PROCEDURE ins
    (
        rows_in         IN viewer_ehr_ea_tc,
        handle_error_in IN BOOLEAN := TRUE
    ) IS
        rows_out table_varchar;
    BEGIN
        ins(rows_in => rows_in, handle_error_in => handle_error_in, rows_out => rows_out);
    END ins;

    -- Update any/all columns by primary key. If you pass NULL, then
    -- the current column value is set to itself. If you need a more
    -- selected UPDATE then use one of the onecol procedures below.
    PROCEDURE upd
    (
        id_patient_in          IN viewer_ehr_ea.id_patient%TYPE,
        num_allergy_in         IN viewer_ehr_ea.num_allergy%TYPE DEFAULT NULL,
        num_allergy_nin        IN BOOLEAN := TRUE,
        desc_allergy_in        IN viewer_ehr_ea.desc_allergy%TYPE DEFAULT NULL,
        desc_allergy_nin       IN BOOLEAN := TRUE,
        dt_allergy_in          IN viewer_ehr_ea.dt_allergy%TYPE DEFAULT NULL,
        dt_allergy_nin         IN BOOLEAN := TRUE,
        dt_allergy_fmt_in      IN viewer_ehr_ea.dt_allergy_fmt%TYPE DEFAULT NULL,
        dt_allergy_fmt_nin     IN BOOLEAN := TRUE,
        num_lab_in             IN viewer_ehr_ea.num_lab%TYPE DEFAULT NULL,
        num_lab_nin            IN BOOLEAN := TRUE,
        desc_lab_in            IN viewer_ehr_ea.desc_lab%TYPE DEFAULT NULL,
        desc_lab_nin           IN BOOLEAN := TRUE,
        dt_lab_in              IN viewer_ehr_ea.dt_lab%TYPE DEFAULT NULL,
        dt_lab_nin             IN BOOLEAN := TRUE,
        num_diag_icnp_in       IN viewer_ehr_ea.num_diag_icnp%TYPE DEFAULT NULL,
        num_diag_icnp_nin      IN BOOLEAN := TRUE,
        desc_diag_icnp_in      IN viewer_ehr_ea.desc_diag_icnp%TYPE DEFAULT NULL,
        desc_diag_icnp_nin     IN BOOLEAN := TRUE,
        dt_diag_icnp_in        IN viewer_ehr_ea.dt_diag_icnp%TYPE DEFAULT NULL,
        dt_diag_icnp_nin       IN BOOLEAN := TRUE,
        num_episode_in         IN viewer_ehr_ea.num_episode%TYPE DEFAULT NULL,
        num_episode_nin        IN BOOLEAN := TRUE,
        desc_episode_in        IN viewer_ehr_ea.desc_episode%TYPE DEFAULT NULL,
        desc_episode_nin       IN BOOLEAN := TRUE,
        dt_episode_in          IN viewer_ehr_ea.dt_episode%TYPE DEFAULT NULL,
        dt_episode_nin         IN BOOLEAN := TRUE,
        num_exam_in            IN viewer_ehr_ea.num_exam%TYPE DEFAULT NULL,
        num_exam_nin           IN BOOLEAN := TRUE,
        desc_exam_in           IN viewer_ehr_ea.desc_exam%TYPE DEFAULT NULL,
        desc_exam_nin          IN BOOLEAN := TRUE,
        dt_exam_in             IN viewer_ehr_ea.dt_exam%TYPE DEFAULT NULL,
        dt_exam_nin            IN BOOLEAN := TRUE,
        num_med_in             IN viewer_ehr_ea.num_med%TYPE DEFAULT NULL,
        num_med_nin            IN BOOLEAN := TRUE,
        desc_med_in            IN viewer_ehr_ea.desc_med%TYPE DEFAULT NULL,
        desc_med_nin           IN BOOLEAN := TRUE,
        dt_med_in              IN viewer_ehr_ea.dt_med%TYPE DEFAULT NULL,
        dt_med_nin             IN BOOLEAN := TRUE,
        num_problem_in         IN viewer_ehr_ea.num_problem%TYPE DEFAULT NULL,
        num_problem_nin        IN BOOLEAN := TRUE,
        desc_problem_in        IN viewer_ehr_ea.desc_problem%TYPE DEFAULT NULL,
        desc_problem_nin       IN BOOLEAN := TRUE,
        dt_problem_in          IN viewer_ehr_ea.dt_problem%TYPE DEFAULT NULL,
        dt_problem_nin         IN BOOLEAN := TRUE,
        dt_problem_fmt_in      IN viewer_ehr_ea.dt_problem_fmt%TYPE DEFAULT NULL,
        dt_problem_fmt_nin     IN BOOLEAN := TRUE,
        num_interv_in          IN viewer_ehr_ea.num_interv%TYPE DEFAULT NULL,
        num_interv_nin         IN BOOLEAN := TRUE,
        desc_interv_in         IN viewer_ehr_ea.desc_interv%TYPE DEFAULT NULL,
        desc_interv_nin        IN BOOLEAN := TRUE,
        dt_interv_in           IN viewer_ehr_ea.dt_interv%TYPE DEFAULT NULL,
        dt_interv_nin          IN BOOLEAN := TRUE,
        dt_dg_last_update_in   IN viewer_ehr_ea.dt_dg_last_update%TYPE DEFAULT NULL,
        dt_dg_last_update_nin  IN BOOLEAN := TRUE,
        code_allergy_in        IN viewer_ehr_ea.code_allergy%TYPE DEFAULT NULL,
        code_allergy_nin       IN BOOLEAN := TRUE,
        code_episode_in        IN viewer_ehr_ea.code_episode%TYPE DEFAULT NULL,
        code_episode_nin       IN BOOLEAN := TRUE,
        code_exam_in           IN viewer_ehr_ea.code_exam%TYPE DEFAULT NULL,
        code_exam_nin          IN BOOLEAN := TRUE,
        code_med_in            IN viewer_ehr_ea.code_med%TYPE DEFAULT NULL,
        code_med_nin           IN BOOLEAN := TRUE,
        code_problem_in        IN viewer_ehr_ea.code_problem%TYPE DEFAULT NULL,
        code_problem_nin       IN BOOLEAN := TRUE,
        code_lab_in            IN viewer_ehr_ea.code_lab%TYPE DEFAULT NULL,
        code_lab_nin           IN BOOLEAN := TRUE,
        code_diag_icnp_in      IN viewer_ehr_ea.code_diag_icnp%TYPE DEFAULT NULL,
        code_diag_icnp_nin     IN BOOLEAN := TRUE,
        code_interv_in         IN viewer_ehr_ea.code_interv%TYPE DEFAULT NULL,
        code_interv_nin        IN BOOLEAN := TRUE,
        create_user_in         IN viewer_ehr_ea.create_user%TYPE DEFAULT NULL,
        create_user_nin        IN BOOLEAN := TRUE,
        create_time_in         IN viewer_ehr_ea.create_time%TYPE DEFAULT NULL,
        create_time_nin        IN BOOLEAN := TRUE,
        create_institution_in  IN viewer_ehr_ea.create_institution%TYPE DEFAULT NULL,
        create_institution_nin IN BOOLEAN := TRUE,
        update_user_in         IN viewer_ehr_ea.update_user%TYPE DEFAULT NULL,
        update_user_nin        IN BOOLEAN := TRUE,
        update_time_in         IN viewer_ehr_ea.update_time%TYPE DEFAULT NULL,
        update_time_nin        IN BOOLEAN := TRUE,
        update_institution_in  IN viewer_ehr_ea.update_institution%TYPE DEFAULT NULL,
        update_institution_nin IN BOOLEAN := TRUE,
        flg_exclamation_in     IN viewer_ehr_ea.flg_exclamation%TYPE DEFAULT NULL,
        flg_exclamation_nin    IN BOOLEAN := TRUE,
        flg_infective_in       IN viewer_ehr_ea.flg_infective%TYPE DEFAULT NULL,
        flg_infective_nin      IN BOOLEAN := TRUE,
        num_vs_in              IN viewer_ehr_ea.num_vs%TYPE DEFAULT NULL,
        num_vs_nin             IN BOOLEAN := TRUE,
        desc_vs_in             IN viewer_ehr_ea.desc_vs%TYPE DEFAULT NULL,
        desc_vs_nin            IN BOOLEAN := TRUE,
        dt_vs_in               IN viewer_ehr_ea.dt_vs%TYPE DEFAULT NULL,
        dt_vs_nin              IN BOOLEAN := TRUE,
        code_vs_in             IN viewer_ehr_ea.code_vs%TYPE DEFAULT NULL,
        code_vs_nin            IN BOOLEAN := TRUE,
        num_note_in            IN viewer_ehr_ea.num_note%TYPE DEFAULT NULL,
        num_note_nin           IN BOOLEAN := TRUE,
        desc_note_in           IN viewer_ehr_ea.desc_note%TYPE DEFAULT NULL,
        desc_note_nin          IN BOOLEAN := TRUE,
        dt_note_in             IN viewer_ehr_ea.dt_note%TYPE DEFAULT NULL,
        dt_note_nin            IN BOOLEAN := TRUE,
        code_note_in           IN viewer_ehr_ea.code_note%TYPE DEFAULT NULL,
        code_note_nin          IN BOOLEAN := TRUE,
        num_archive_in         IN viewer_ehr_ea.num_archive%TYPE DEFAULT NULL,
        num_archive_nin        IN BOOLEAN := TRUE,
        desc_archive_in        IN viewer_ehr_ea.desc_archive%TYPE DEFAULT NULL,
        desc_archive_nin       IN BOOLEAN := TRUE,
        dt_archive_in          IN viewer_ehr_ea.dt_archive%TYPE DEFAULT NULL,
        dt_archive_nin         IN BOOLEAN := TRUE,
        code_archive_in        IN viewer_ehr_ea.code_archive%TYPE DEFAULT NULL,
        code_archive_nin       IN BOOLEAN := TRUE,
        num_epis_archive_in    IN viewer_ehr_ea.num_epis_archive%TYPE DEFAULT NULL,
        num_epis_archive_nin   IN BOOLEAN := TRUE,
        desc_epis_archive_in   IN viewer_ehr_ea.desc_epis_archive%TYPE DEFAULT NULL,
        desc_epis_archive_nin  IN BOOLEAN := TRUE,
        dt_epis_archive_in     IN viewer_ehr_ea.dt_epis_archive%TYPE DEFAULT NULL,
        dt_epis_archive_nin    IN BOOLEAN := TRUE,
        code_epis_archive_in   IN viewer_ehr_ea.code_epis_archive%TYPE DEFAULT NULL,
        code_epis_archive_nin  IN BOOLEAN := TRUE,
        num_bp_in              IN viewer_ehr_ea.num_bp%TYPE DEFAULT NULL,
        num_bp_nin             IN BOOLEAN := TRUE,
        dt_bp_in               IN viewer_ehr_ea.dt_bp%TYPE DEFAULT NULL,
        dt_bp_nin              IN BOOLEAN := TRUE,
        code_bp_in             IN viewer_ehr_ea.code_bp%TYPE DEFAULT NULL,
        code_bp_nin            IN BOOLEAN := TRUE,
        desc_bp_in             IN viewer_ehr_ea.desc_bp%TYPE DEFAULT NULL,
        desc_bp_nin            IN BOOLEAN := TRUE,
        id_problem_in          IN viewer_ehr_ea.id_problem%TYPE DEFAULT NULL,
        id_problem_nin         IN BOOLEAN := TRUE,
        id_task_type_in        IN viewer_ehr_ea.id_task_type%TYPE DEFAULT NULL,
        id_task_type_nin       IN BOOLEAN := TRUE,
        handle_error_in        IN BOOLEAN := TRUE,
        rows_out               IN OUT table_varchar
    ) IS
        l_rows_out             table_varchar;
        l_num_allergy_n        NUMBER(1) := sys.diutil.bool_to_int(num_allergy_nin);
        l_desc_allergy_n       NUMBER(1) := sys.diutil.bool_to_int(desc_allergy_nin);
        l_dt_allergy_n         NUMBER(1) := sys.diutil.bool_to_int(dt_allergy_nin);
        l_dt_allergy_fmt_n     NUMBER(1) := sys.diutil.bool_to_int(dt_allergy_fmt_nin);
        l_num_lab_n            NUMBER(1) := sys.diutil.bool_to_int(num_lab_nin);
        l_desc_lab_n           NUMBER(1) := sys.diutil.bool_to_int(desc_lab_nin);
        l_dt_lab_n             NUMBER(1) := sys.diutil.bool_to_int(dt_lab_nin);
        l_num_diag_icnp_n      NUMBER(1) := sys.diutil.bool_to_int(num_diag_icnp_nin);
        l_desc_diag_icnp_n     NUMBER(1) := sys.diutil.bool_to_int(desc_diag_icnp_nin);
        l_dt_diag_icnp_n       NUMBER(1) := sys.diutil.bool_to_int(dt_diag_icnp_nin);
        l_num_episode_n        NUMBER(1) := sys.diutil.bool_to_int(num_episode_nin);
        l_desc_episode_n       NUMBER(1) := sys.diutil.bool_to_int(desc_episode_nin);
        l_dt_episode_n         NUMBER(1) := sys.diutil.bool_to_int(dt_episode_nin);
        l_num_exam_n           NUMBER(1) := sys.diutil.bool_to_int(num_exam_nin);
        l_desc_exam_n          NUMBER(1) := sys.diutil.bool_to_int(desc_exam_nin);
        l_dt_exam_n            NUMBER(1) := sys.diutil.bool_to_int(dt_exam_nin);
        l_num_med_n            NUMBER(1) := sys.diutil.bool_to_int(num_med_nin);
        l_desc_med_n           NUMBER(1) := sys.diutil.bool_to_int(desc_med_nin);
        l_dt_med_n             NUMBER(1) := sys.diutil.bool_to_int(dt_med_nin);
        l_num_problem_n        NUMBER(1) := sys.diutil.bool_to_int(num_problem_nin);
        l_desc_problem_n       NUMBER(1) := sys.diutil.bool_to_int(desc_problem_nin);
        l_dt_problem_n         NUMBER(1) := sys.diutil.bool_to_int(dt_problem_nin);
        l_dt_problem_fmt_n     NUMBER(1) := sys.diutil.bool_to_int(dt_problem_fmt_nin);
        l_num_interv_n         NUMBER(1) := sys.diutil.bool_to_int(num_interv_nin);
        l_desc_interv_n        NUMBER(1) := sys.diutil.bool_to_int(desc_interv_nin);
        l_dt_interv_n          NUMBER(1) := sys.diutil.bool_to_int(dt_interv_nin);
        l_dt_dg_last_update_n  NUMBER(1) := sys.diutil.bool_to_int(dt_dg_last_update_nin);
        l_code_allergy_n       NUMBER(1) := sys.diutil.bool_to_int(code_allergy_nin);
        l_code_episode_n       NUMBER(1) := sys.diutil.bool_to_int(code_episode_nin);
        l_code_exam_n          NUMBER(1) := sys.diutil.bool_to_int(code_exam_nin);
        l_code_med_n           NUMBER(1) := sys.diutil.bool_to_int(code_med_nin);
        l_code_problem_n       NUMBER(1) := sys.diutil.bool_to_int(code_problem_nin);
        l_code_lab_n           NUMBER(1) := sys.diutil.bool_to_int(code_lab_nin);
        l_code_diag_icnp_n     NUMBER(1) := sys.diutil.bool_to_int(code_diag_icnp_nin);
        l_code_interv_n        NUMBER(1) := sys.diutil.bool_to_int(code_interv_nin);
        l_create_user_n        NUMBER(1) := sys.diutil.bool_to_int(create_user_nin);
        l_create_time_n        NUMBER(1) := sys.diutil.bool_to_int(create_time_nin);
        l_create_institution_n NUMBER(1) := sys.diutil.bool_to_int(create_institution_nin);
        l_update_user_n        NUMBER(1) := sys.diutil.bool_to_int(update_user_nin);
        l_update_time_n        NUMBER(1) := sys.diutil.bool_to_int(update_time_nin);
        l_update_institution_n NUMBER(1) := sys.diutil.bool_to_int(update_institution_nin);
        l_flg_exclamation_n    NUMBER(1) := sys.diutil.bool_to_int(flg_exclamation_nin);
        l_flg_infective_n      NUMBER(1) := sys.diutil.bool_to_int(flg_infective_nin);
        l_num_vs_n             NUMBER(1) := sys.diutil.bool_to_int(num_vs_nin);
        l_desc_vs_n            NUMBER(1) := sys.diutil.bool_to_int(desc_vs_nin);
        l_dt_vs_n              NUMBER(1) := sys.diutil.bool_to_int(dt_vs_nin);
        l_code_vs_n            NUMBER(1) := sys.diutil.bool_to_int(code_vs_nin);
        l_num_note_n           NUMBER(1) := sys.diutil.bool_to_int(num_note_nin);
        l_desc_note_n          NUMBER(1) := sys.diutil.bool_to_int(desc_note_nin);
        l_dt_note_n            NUMBER(1) := sys.diutil.bool_to_int(dt_note_nin);
        l_code_note_n          NUMBER(1) := sys.diutil.bool_to_int(code_note_nin);
        l_num_archive_n        NUMBER(1) := sys.diutil.bool_to_int(num_archive_nin);
        l_desc_archive_n       NUMBER(1) := sys.diutil.bool_to_int(desc_archive_nin);
        l_dt_archive_n         NUMBER(1) := sys.diutil.bool_to_int(dt_archive_nin);
        l_code_archive_n       NUMBER(1) := sys.diutil.bool_to_int(code_archive_nin);
        l_num_epis_archive_n   NUMBER(1) := sys.diutil.bool_to_int(num_epis_archive_nin);
        l_desc_epis_archive_n  NUMBER(1) := sys.diutil.bool_to_int(desc_epis_archive_nin);
        l_dt_epis_archive_n    NUMBER(1) := sys.diutil.bool_to_int(dt_epis_archive_nin);
        l_code_epis_archive_n  NUMBER(1) := sys.diutil.bool_to_int(code_epis_archive_nin);
        l_num_bp_n             NUMBER(1) := sys.diutil.bool_to_int(num_bp_nin);
        l_dt_bp_n              NUMBER(1) := sys.diutil.bool_to_int(dt_bp_nin);
        l_code_bp_n            NUMBER(1) := sys.diutil.bool_to_int(code_bp_nin);
        l_desc_bp_n            NUMBER(1) := sys.diutil.bool_to_int(desc_bp_nin);
        l_id_problem_n         NUMBER(1) := sys.diutil.bool_to_int(id_problem_nin);
        l_id_task_type_n       NUMBER(1) := sys.diutil.bool_to_int(id_task_type_nin);
    BEGIN
    
        UPDATE viewer_ehr_ea
           SET num_allergy        = decode(l_num_allergy_n, 0, num_allergy_in, nvl(num_allergy_in, num_allergy)),
               desc_allergy       = decode(l_desc_allergy_n, 0, desc_allergy_in, nvl(desc_allergy_in, desc_allergy)),
               dt_allergy         = decode(l_dt_allergy_n, 0, dt_allergy_in, nvl(dt_allergy_in, dt_allergy)),
               dt_allergy_fmt     = decode(l_dt_allergy_fmt_n,
                                           0,
                                           dt_allergy_fmt_in,
                                           nvl(dt_allergy_fmt_in, dt_allergy_fmt)),
               num_lab            = decode(l_num_lab_n, 0, num_lab_in, nvl(num_lab_in, num_lab)),
               desc_lab           = decode(l_desc_lab_n, 0, desc_lab_in, nvl(desc_lab_in, desc_lab)),
               dt_lab             = decode(l_dt_lab_n, 0, dt_lab_in, nvl(dt_lab_in, dt_lab)),
               num_diag_icnp      = decode(l_num_diag_icnp_n, 0, num_diag_icnp_in, nvl(num_diag_icnp_in, num_diag_icnp)),
               desc_diag_icnp     = decode(l_desc_diag_icnp_n,
                                           0,
                                           desc_diag_icnp_in,
                                           nvl(desc_diag_icnp_in, desc_diag_icnp)),
               dt_diag_icnp       = decode(l_dt_diag_icnp_n, 0, dt_diag_icnp_in, nvl(dt_diag_icnp_in, dt_diag_icnp)),
               num_episode        = decode(l_num_episode_n, 0, num_episode_in, nvl(num_episode_in, num_episode)),
               desc_episode       = decode(l_desc_episode_n, 0, desc_episode_in, nvl(desc_episode_in, desc_episode)),
               dt_episode         = decode(l_dt_episode_n, 0, dt_episode_in, nvl(dt_episode_in, dt_episode)),
               num_exam           = decode(l_num_exam_n, 0, num_exam_in, nvl(num_exam_in, num_exam)),
               desc_exam          = decode(l_desc_exam_n, 0, desc_exam_in, nvl(desc_exam_in, desc_exam)),
               dt_exam            = decode(l_dt_exam_n, 0, dt_exam_in, nvl(dt_exam_in, dt_exam)),
               num_med            = decode(l_num_med_n, 0, num_med_in, nvl(num_med_in, num_med)),
               desc_med           = decode(l_desc_med_n, 0, desc_med_in, nvl(desc_med_in, desc_med)),
               dt_med             = decode(l_dt_med_n, 0, dt_med_in, nvl(dt_med_in, dt_med)),
               num_problem        = decode(l_num_problem_n, 0, num_problem_in, nvl(num_problem_in, num_problem)),
               desc_problem       = decode(l_desc_problem_n, 0, desc_problem_in, nvl(desc_problem_in, desc_problem)),
               dt_problem         = decode(l_dt_problem_n, 0, dt_problem_in, nvl(dt_problem_in, dt_problem)),
               dt_problem_fmt     = decode(l_dt_problem_fmt_n,
                                           0,
                                           dt_problem_fmt_in,
                                           nvl(dt_problem_fmt_in, dt_problem_fmt)),
               num_interv         = decode(l_num_interv_n, 0, num_interv_in, nvl(num_interv_in, num_interv)),
               desc_interv        = decode(l_desc_interv_n, 0, desc_interv_in, nvl(desc_interv_in, desc_interv)),
               dt_interv          = decode(l_dt_interv_n, 0, dt_interv_in, nvl(dt_interv_in, dt_interv)),
               dt_dg_last_update  = decode(l_dt_dg_last_update_n,
                                           0,
                                           dt_dg_last_update_in,
                                           nvl(dt_dg_last_update_in, dt_dg_last_update)),
               code_allergy       = decode(l_code_allergy_n, 0, code_allergy_in, nvl(code_allergy_in, code_allergy)),
               code_episode       = decode(l_code_episode_n, 0, code_episode_in, nvl(code_episode_in, code_episode)),
               code_exam          = decode(l_code_exam_n, 0, code_exam_in, nvl(code_exam_in, code_exam)),
               code_med           = decode(l_code_med_n, 0, code_med_in, nvl(code_med_in, code_med)),
               code_problem       = decode(l_code_problem_n, 0, code_problem_in, nvl(code_problem_in, code_problem)),
               code_lab           = decode(l_code_lab_n, 0, code_lab_in, nvl(code_lab_in, code_lab)),
               code_diag_icnp     = decode(l_code_diag_icnp_n,
                                           0,
                                           code_diag_icnp_in,
                                           nvl(code_diag_icnp_in, code_diag_icnp)),
               code_interv        = decode(l_code_interv_n, 0, code_interv_in, nvl(code_interv_in, code_interv)),
               create_user        = decode(l_create_user_n, 0, create_user_in, nvl(create_user_in, create_user)),
               create_time        = decode(l_create_time_n, 0, create_time_in, nvl(create_time_in, create_time)),
               create_institution = decode(l_create_institution_n,
                                           0,
                                           create_institution_in,
                                           nvl(create_institution_in, create_institution)),
               update_user        = decode(l_update_user_n, 0, update_user_in, nvl(update_user_in, update_user)),
               update_time        = decode(l_update_time_n, 0, update_time_in, nvl(update_time_in, update_time)),
               update_institution = decode(l_update_institution_n,
                                           0,
                                           update_institution_in,
                                           nvl(update_institution_in, update_institution)),
               flg_exclamation    = decode(l_flg_exclamation_n,
                                           0,
                                           flg_exclamation_in,
                                           nvl(flg_exclamation_in, flg_exclamation)),
               flg_infective      = decode(l_flg_infective_n, 0, flg_infective_in, nvl(flg_infective_in, flg_infective)),
               num_vs             = decode(l_num_vs_n, 0, num_vs_in, nvl(num_vs_in, num_vs)),
               desc_vs            = decode(l_desc_vs_n, 0, desc_vs_in, nvl(desc_vs_in, desc_vs)),
               dt_vs              = decode(l_dt_vs_n, 0, dt_vs_in, nvl(dt_vs_in, dt_vs)),
               code_vs            = decode(l_code_vs_n, 0, code_vs_in, nvl(code_vs_in, code_vs)),
               num_note           = decode(l_num_note_n, 0, num_note_in, nvl(num_note_in, num_note)),
               desc_note          = decode(l_desc_note_n, 0, desc_note_in, nvl(desc_note_in, desc_note)),
               dt_note            = decode(l_dt_note_n, 0, dt_note_in, nvl(dt_note_in, dt_note)),
               code_note          = decode(l_code_note_n, 0, code_note_in, nvl(code_note_in, code_note)),
               num_archive        = decode(l_num_archive_n, 0, num_archive_in, nvl(num_archive_in, num_archive)),
               desc_archive       = decode(l_desc_archive_n, 0, desc_archive_in, nvl(desc_archive_in, desc_archive)),
               dt_archive         = decode(l_dt_archive_n, 0, dt_archive_in, nvl(dt_archive_in, dt_archive)),
               code_archive       = decode(l_code_archive_n, 0, code_archive_in, nvl(code_archive_in, code_archive)),
               num_epis_archive   = decode(l_num_epis_archive_n,
                                           0,
                                           num_epis_archive_in,
                                           nvl(num_epis_archive_in, num_epis_archive)),
               desc_epis_archive  = decode(l_desc_epis_archive_n,
                                           0,
                                           desc_epis_archive_in,
                                           nvl(desc_epis_archive_in, desc_epis_archive)),
               dt_epis_archive    = decode(l_dt_epis_archive_n,
                                           0,
                                           dt_epis_archive_in,
                                           nvl(dt_epis_archive_in, dt_epis_archive)),
               code_epis_archive  = decode(l_code_epis_archive_n,
                                           0,
                                           code_epis_archive_in,
                                           nvl(code_epis_archive_in, code_epis_archive)),
               num_bp             = decode(l_num_bp_n, 0, num_bp_in, nvl(num_bp_in, num_bp)),
               dt_bp              = decode(l_dt_bp_n, 0, dt_bp_in, nvl(dt_bp_in, dt_bp)),
               code_bp            = decode(l_code_bp_n, 0, code_bp_in, nvl(code_bp_in, code_bp)),
               desc_bp            = decode(l_desc_bp_n, 0, desc_bp_in, nvl(desc_bp_in, desc_bp)),
               id_problem         = decode(l_id_problem_n, 0, id_problem_in, nvl(id_problem_in, id_problem)),
               id_task_type       = decode(l_id_task_type_n, 0, id_task_type_in, nvl(id_task_type_in, id_task_type))
         WHERE id_patient = id_patient_in
        RETURNING ROWID BULK COLLECT INTO l_rows_out;
        IF (rows_out IS NULL)
        THEN
            rows_out := table_varchar();
        END IF;
        rows_out := rows_out MULTISET UNION DISTINCT l_rows_out;
    
    EXCEPTION
        WHEN e_null_column_value
             OR e_existing_fky_reference
             OR e_check_constraint_failure
             OR e_no_parent_key
             OR e_child_record_found
             OR e_forall_error
             OR e_integ_constraint_failure THEN
            IF NOT handle_error_in
            THEN
                RAISE;
            ELSE
                pk_alertlog.log_error('DML error ignored: ' || SQLCODE || ': ' || SQLERRM);
            END IF;
        
    END upd;

    -- Update any/all columns by primary key. If you pass NULL, then
    -- the current column value is set to itself. If you need a more
    -- selected UPDATE then use one of the onecol procedures below.
    PROCEDURE upd
    (
        id_patient_in          IN viewer_ehr_ea.id_patient%TYPE,
        num_allergy_in         IN viewer_ehr_ea.num_allergy%TYPE DEFAULT NULL,
        num_allergy_nin        IN BOOLEAN := TRUE,
        desc_allergy_in        IN viewer_ehr_ea.desc_allergy%TYPE DEFAULT NULL,
        desc_allergy_nin       IN BOOLEAN := TRUE,
        dt_allergy_in          IN viewer_ehr_ea.dt_allergy%TYPE DEFAULT NULL,
        dt_allergy_nin         IN BOOLEAN := TRUE,
        dt_allergy_fmt_in      IN viewer_ehr_ea.dt_allergy_fmt%TYPE DEFAULT NULL,
        dt_allergy_fmt_nin     IN BOOLEAN := TRUE,
        num_lab_in             IN viewer_ehr_ea.num_lab%TYPE DEFAULT NULL,
        num_lab_nin            IN BOOLEAN := TRUE,
        desc_lab_in            IN viewer_ehr_ea.desc_lab%TYPE DEFAULT NULL,
        desc_lab_nin           IN BOOLEAN := TRUE,
        dt_lab_in              IN viewer_ehr_ea.dt_lab%TYPE DEFAULT NULL,
        dt_lab_nin             IN BOOLEAN := TRUE,
        num_diag_icnp_in       IN viewer_ehr_ea.num_diag_icnp%TYPE DEFAULT NULL,
        num_diag_icnp_nin      IN BOOLEAN := TRUE,
        desc_diag_icnp_in      IN viewer_ehr_ea.desc_diag_icnp%TYPE DEFAULT NULL,
        desc_diag_icnp_nin     IN BOOLEAN := TRUE,
        dt_diag_icnp_in        IN viewer_ehr_ea.dt_diag_icnp%TYPE DEFAULT NULL,
        dt_diag_icnp_nin       IN BOOLEAN := TRUE,
        num_episode_in         IN viewer_ehr_ea.num_episode%TYPE DEFAULT NULL,
        num_episode_nin        IN BOOLEAN := TRUE,
        desc_episode_in        IN viewer_ehr_ea.desc_episode%TYPE DEFAULT NULL,
        desc_episode_nin       IN BOOLEAN := TRUE,
        dt_episode_in          IN viewer_ehr_ea.dt_episode%TYPE DEFAULT NULL,
        dt_episode_nin         IN BOOLEAN := TRUE,
        num_exam_in            IN viewer_ehr_ea.num_exam%TYPE DEFAULT NULL,
        num_exam_nin           IN BOOLEAN := TRUE,
        desc_exam_in           IN viewer_ehr_ea.desc_exam%TYPE DEFAULT NULL,
        desc_exam_nin          IN BOOLEAN := TRUE,
        dt_exam_in             IN viewer_ehr_ea.dt_exam%TYPE DEFAULT NULL,
        dt_exam_nin            IN BOOLEAN := TRUE,
        num_med_in             IN viewer_ehr_ea.num_med%TYPE DEFAULT NULL,
        num_med_nin            IN BOOLEAN := TRUE,
        desc_med_in            IN viewer_ehr_ea.desc_med%TYPE DEFAULT NULL,
        desc_med_nin           IN BOOLEAN := TRUE,
        dt_med_in              IN viewer_ehr_ea.dt_med%TYPE DEFAULT NULL,
        dt_med_nin             IN BOOLEAN := TRUE,
        num_problem_in         IN viewer_ehr_ea.num_problem%TYPE DEFAULT NULL,
        num_problem_nin        IN BOOLEAN := TRUE,
        desc_problem_in        IN viewer_ehr_ea.desc_problem%TYPE DEFAULT NULL,
        desc_problem_nin       IN BOOLEAN := TRUE,
        dt_problem_in          IN viewer_ehr_ea.dt_problem%TYPE DEFAULT NULL,
        dt_problem_nin         IN BOOLEAN := TRUE,
        dt_problem_fmt_in      IN viewer_ehr_ea.dt_problem_fmt%TYPE DEFAULT NULL,
        dt_problem_fmt_nin     IN BOOLEAN := TRUE,
        num_interv_in          IN viewer_ehr_ea.num_interv%TYPE DEFAULT NULL,
        num_interv_nin         IN BOOLEAN := TRUE,
        desc_interv_in         IN viewer_ehr_ea.desc_interv%TYPE DEFAULT NULL,
        desc_interv_nin        IN BOOLEAN := TRUE,
        dt_interv_in           IN viewer_ehr_ea.dt_interv%TYPE DEFAULT NULL,
        dt_interv_nin          IN BOOLEAN := TRUE,
        dt_dg_last_update_in   IN viewer_ehr_ea.dt_dg_last_update%TYPE DEFAULT NULL,
        dt_dg_last_update_nin  IN BOOLEAN := TRUE,
        code_allergy_in        IN viewer_ehr_ea.code_allergy%TYPE DEFAULT NULL,
        code_allergy_nin       IN BOOLEAN := TRUE,
        code_episode_in        IN viewer_ehr_ea.code_episode%TYPE DEFAULT NULL,
        code_episode_nin       IN BOOLEAN := TRUE,
        code_exam_in           IN viewer_ehr_ea.code_exam%TYPE DEFAULT NULL,
        code_exam_nin          IN BOOLEAN := TRUE,
        code_med_in            IN viewer_ehr_ea.code_med%TYPE DEFAULT NULL,
        code_med_nin           IN BOOLEAN := TRUE,
        code_problem_in        IN viewer_ehr_ea.code_problem%TYPE DEFAULT NULL,
        code_problem_nin       IN BOOLEAN := TRUE,
        code_lab_in            IN viewer_ehr_ea.code_lab%TYPE DEFAULT NULL,
        code_lab_nin           IN BOOLEAN := TRUE,
        code_diag_icnp_in      IN viewer_ehr_ea.code_diag_icnp%TYPE DEFAULT NULL,
        code_diag_icnp_nin     IN BOOLEAN := TRUE,
        code_interv_in         IN viewer_ehr_ea.code_interv%TYPE DEFAULT NULL,
        code_interv_nin        IN BOOLEAN := TRUE,
        create_user_in         IN viewer_ehr_ea.create_user%TYPE DEFAULT NULL,
        create_user_nin        IN BOOLEAN := TRUE,
        create_time_in         IN viewer_ehr_ea.create_time%TYPE DEFAULT NULL,
        create_time_nin        IN BOOLEAN := TRUE,
        create_institution_in  IN viewer_ehr_ea.create_institution%TYPE DEFAULT NULL,
        create_institution_nin IN BOOLEAN := TRUE,
        update_user_in         IN viewer_ehr_ea.update_user%TYPE DEFAULT NULL,
        update_user_nin        IN BOOLEAN := TRUE,
        update_time_in         IN viewer_ehr_ea.update_time%TYPE DEFAULT NULL,
        update_time_nin        IN BOOLEAN := TRUE,
        update_institution_in  IN viewer_ehr_ea.update_institution%TYPE DEFAULT NULL,
        update_institution_nin IN BOOLEAN := TRUE,
        flg_exclamation_in     IN viewer_ehr_ea.flg_exclamation%TYPE DEFAULT NULL,
        flg_exclamation_nin    IN BOOLEAN := TRUE,
        flg_infective_in       IN viewer_ehr_ea.flg_infective%TYPE DEFAULT NULL,
        flg_infective_nin      IN BOOLEAN := TRUE,
        num_vs_in              IN viewer_ehr_ea.num_vs%TYPE DEFAULT NULL,
        num_vs_nin             IN BOOLEAN := TRUE,
        desc_vs_in             IN viewer_ehr_ea.desc_vs%TYPE DEFAULT NULL,
        desc_vs_nin            IN BOOLEAN := TRUE,
        dt_vs_in               IN viewer_ehr_ea.dt_vs%TYPE DEFAULT NULL,
        dt_vs_nin              IN BOOLEAN := TRUE,
        code_vs_in             IN viewer_ehr_ea.code_vs%TYPE DEFAULT NULL,
        code_vs_nin            IN BOOLEAN := TRUE,
        num_note_in            IN viewer_ehr_ea.num_note%TYPE DEFAULT NULL,
        num_note_nin           IN BOOLEAN := TRUE,
        desc_note_in           IN viewer_ehr_ea.desc_note%TYPE DEFAULT NULL,
        desc_note_nin          IN BOOLEAN := TRUE,
        dt_note_in             IN viewer_ehr_ea.dt_note%TYPE DEFAULT NULL,
        dt_note_nin            IN BOOLEAN := TRUE,
        code_note_in           IN viewer_ehr_ea.code_note%TYPE DEFAULT NULL,
        code_note_nin          IN BOOLEAN := TRUE,
        num_archive_in         IN viewer_ehr_ea.num_archive%TYPE DEFAULT NULL,
        num_archive_nin        IN BOOLEAN := TRUE,
        desc_archive_in        IN viewer_ehr_ea.desc_archive%TYPE DEFAULT NULL,
        desc_archive_nin       IN BOOLEAN := TRUE,
        dt_archive_in          IN viewer_ehr_ea.dt_archive%TYPE DEFAULT NULL,
        dt_archive_nin         IN BOOLEAN := TRUE,
        code_archive_in        IN viewer_ehr_ea.code_archive%TYPE DEFAULT NULL,
        code_archive_nin       IN BOOLEAN := TRUE,
        num_epis_archive_in    IN viewer_ehr_ea.num_epis_archive%TYPE DEFAULT NULL,
        num_epis_archive_nin   IN BOOLEAN := TRUE,
        desc_epis_archive_in   IN viewer_ehr_ea.desc_epis_archive%TYPE DEFAULT NULL,
        desc_epis_archive_nin  IN BOOLEAN := TRUE,
        dt_epis_archive_in     IN viewer_ehr_ea.dt_epis_archive%TYPE DEFAULT NULL,
        dt_epis_archive_nin    IN BOOLEAN := TRUE,
        code_epis_archive_in   IN viewer_ehr_ea.code_epis_archive%TYPE DEFAULT NULL,
        code_epis_archive_nin  IN BOOLEAN := TRUE,
        num_bp_in              IN viewer_ehr_ea.num_bp%TYPE DEFAULT NULL,
        num_bp_nin             IN BOOLEAN := TRUE,
        dt_bp_in               IN viewer_ehr_ea.dt_bp%TYPE DEFAULT NULL,
        dt_bp_nin              IN BOOLEAN := TRUE,
        code_bp_in             IN viewer_ehr_ea.code_bp%TYPE DEFAULT NULL,
        code_bp_nin            IN BOOLEAN := TRUE,
        desc_bp_in             IN viewer_ehr_ea.desc_bp%TYPE DEFAULT NULL,
        desc_bp_nin            IN BOOLEAN := TRUE,
        id_problem_in          IN viewer_ehr_ea.id_problem%TYPE DEFAULT NULL,
        id_problem_nin         IN BOOLEAN := TRUE,
        id_task_type_in        IN viewer_ehr_ea.id_task_type%TYPE DEFAULT NULL,
        id_task_type_nin       IN BOOLEAN := TRUE,
        handle_error_in        IN BOOLEAN := TRUE
    ) IS
        rows_out table_varchar;
    BEGIN
        upd(id_patient_in          => id_patient_in,
            num_allergy_in         => num_allergy_in,
            num_allergy_nin        => num_allergy_nin,
            desc_allergy_in        => desc_allergy_in,
            desc_allergy_nin       => desc_allergy_nin,
            dt_allergy_in          => dt_allergy_in,
            dt_allergy_nin         => dt_allergy_nin,
            dt_allergy_fmt_in      => dt_allergy_fmt_in,
            dt_allergy_fmt_nin     => dt_allergy_fmt_nin,
            num_lab_in             => num_lab_in,
            num_lab_nin            => num_lab_nin,
            desc_lab_in            => desc_lab_in,
            desc_lab_nin           => desc_lab_nin,
            dt_lab_in              => dt_lab_in,
            dt_lab_nin             => dt_lab_nin,
            num_diag_icnp_in       => num_diag_icnp_in,
            num_diag_icnp_nin      => num_diag_icnp_nin,
            desc_diag_icnp_in      => desc_diag_icnp_in,
            desc_diag_icnp_nin     => desc_diag_icnp_nin,
            dt_diag_icnp_in        => dt_diag_icnp_in,
            dt_diag_icnp_nin       => dt_diag_icnp_nin,
            num_episode_in         => num_episode_in,
            num_episode_nin        => num_episode_nin,
            desc_episode_in        => desc_episode_in,
            desc_episode_nin       => desc_episode_nin,
            dt_episode_in          => dt_episode_in,
            dt_episode_nin         => dt_episode_nin,
            num_exam_in            => num_exam_in,
            num_exam_nin           => num_exam_nin,
            desc_exam_in           => desc_exam_in,
            desc_exam_nin          => desc_exam_nin,
            dt_exam_in             => dt_exam_in,
            dt_exam_nin            => dt_exam_nin,
            num_med_in             => num_med_in,
            num_med_nin            => num_med_nin,
            desc_med_in            => desc_med_in,
            desc_med_nin           => desc_med_nin,
            dt_med_in              => dt_med_in,
            dt_med_nin             => dt_med_nin,
            num_problem_in         => num_problem_in,
            num_problem_nin        => num_problem_nin,
            desc_problem_in        => desc_problem_in,
            desc_problem_nin       => desc_problem_nin,
            dt_problem_in          => dt_problem_in,
            dt_problem_nin         => dt_problem_nin,
            dt_problem_fmt_in      => dt_problem_fmt_in,
            dt_problem_fmt_nin     => dt_problem_fmt_nin,
            num_interv_in          => num_interv_in,
            num_interv_nin         => num_interv_nin,
            desc_interv_in         => desc_interv_in,
            desc_interv_nin        => desc_interv_nin,
            dt_interv_in           => dt_interv_in,
            dt_interv_nin          => dt_interv_nin,
            dt_dg_last_update_in   => dt_dg_last_update_in,
            dt_dg_last_update_nin  => dt_dg_last_update_nin,
            code_allergy_in        => code_allergy_in,
            code_allergy_nin       => code_allergy_nin,
            code_episode_in        => code_episode_in,
            code_episode_nin       => code_episode_nin,
            code_exam_in           => code_exam_in,
            code_exam_nin          => code_exam_nin,
            code_med_in            => code_med_in,
            code_med_nin           => code_med_nin,
            code_problem_in        => code_problem_in,
            code_problem_nin       => code_problem_nin,
            code_lab_in            => code_lab_in,
            code_lab_nin           => code_lab_nin,
            code_diag_icnp_in      => code_diag_icnp_in,
            code_diag_icnp_nin     => code_diag_icnp_nin,
            code_interv_in         => code_interv_in,
            code_interv_nin        => code_interv_nin,
            create_user_in         => create_user_in,
            create_user_nin        => create_user_nin,
            create_time_in         => create_time_in,
            create_time_nin        => create_time_nin,
            create_institution_in  => create_institution_in,
            create_institution_nin => create_institution_nin,
            update_user_in         => update_user_in,
            update_user_nin        => update_user_nin,
            update_time_in         => update_time_in,
            update_time_nin        => update_time_nin,
            update_institution_in  => update_institution_in,
            update_institution_nin => update_institution_nin,
            flg_exclamation_in     => flg_exclamation_in,
            flg_exclamation_nin    => flg_exclamation_nin,
            flg_infective_in       => flg_infective_in,
            flg_infective_nin      => flg_infective_nin,
            num_vs_in              => num_vs_in,
            num_vs_nin             => num_vs_nin,
            desc_vs_in             => desc_vs_in,
            desc_vs_nin            => desc_vs_nin,
            dt_vs_in               => dt_vs_in,
            dt_vs_nin              => dt_vs_nin,
            code_vs_in             => code_vs_in,
            code_vs_nin            => code_vs_nin,
            num_note_in            => num_note_in,
            num_note_nin           => num_note_nin,
            desc_note_in           => desc_note_in,
            desc_note_nin          => desc_note_nin,
            dt_note_in             => dt_note_in,
            dt_note_nin            => dt_note_nin,
            code_note_in           => code_note_in,
            code_note_nin          => code_note_nin,
            num_archive_in         => num_archive_in,
            num_archive_nin        => num_archive_nin,
            desc_archive_in        => desc_archive_in,
            desc_archive_nin       => desc_archive_nin,
            dt_archive_in          => dt_archive_in,
            dt_archive_nin         => dt_archive_nin,
            code_archive_in        => code_archive_in,
            code_archive_nin       => code_archive_nin,
            num_epis_archive_in    => num_epis_archive_in,
            num_epis_archive_nin   => num_epis_archive_nin,
            desc_epis_archive_in   => desc_epis_archive_in,
            desc_epis_archive_nin  => desc_epis_archive_nin,
            dt_epis_archive_in     => dt_epis_archive_in,
            dt_epis_archive_nin    => dt_epis_archive_nin,
            code_epis_archive_in   => code_epis_archive_in,
            code_epis_archive_nin  => code_epis_archive_nin,
            num_bp_in              => num_bp_in,
            num_bp_nin             => num_bp_nin,
            dt_bp_in               => dt_bp_in,
            dt_bp_nin              => dt_bp_nin,
            code_bp_in             => code_bp_in,
            code_bp_nin            => code_bp_nin,
            desc_bp_in             => desc_bp_in,
            desc_bp_nin            => desc_bp_nin,
            id_problem_in          => id_problem_in,
            id_problem_nin         => id_problem_nin,
            id_task_type_in        => id_task_type_in,
            id_task_type_nin       => id_task_type_nin,
            handle_error_in        => handle_error_in,
            rows_out               => rows_out);
    END upd;

    --Update any/all columns by dynamic WHERE
    -- If you pass NULL, then the current column value is set to itself
    PROCEDURE upd
    (
        num_allergy_in         IN viewer_ehr_ea.num_allergy%TYPE DEFAULT NULL,
        num_allergy_nin        IN BOOLEAN := TRUE,
        desc_allergy_in        IN viewer_ehr_ea.desc_allergy%TYPE DEFAULT NULL,
        desc_allergy_nin       IN BOOLEAN := TRUE,
        dt_allergy_in          IN viewer_ehr_ea.dt_allergy%TYPE DEFAULT NULL,
        dt_allergy_nin         IN BOOLEAN := TRUE,
        dt_allergy_fmt_in      IN viewer_ehr_ea.dt_allergy_fmt%TYPE DEFAULT NULL,
        dt_allergy_fmt_nin     IN BOOLEAN := TRUE,
        num_lab_in             IN viewer_ehr_ea.num_lab%TYPE DEFAULT NULL,
        num_lab_nin            IN BOOLEAN := TRUE,
        desc_lab_in            IN viewer_ehr_ea.desc_lab%TYPE DEFAULT NULL,
        desc_lab_nin           IN BOOLEAN := TRUE,
        dt_lab_in              IN viewer_ehr_ea.dt_lab%TYPE DEFAULT NULL,
        dt_lab_nin             IN BOOLEAN := TRUE,
        num_diag_icnp_in       IN viewer_ehr_ea.num_diag_icnp%TYPE DEFAULT NULL,
        num_diag_icnp_nin      IN BOOLEAN := TRUE,
        desc_diag_icnp_in      IN viewer_ehr_ea.desc_diag_icnp%TYPE DEFAULT NULL,
        desc_diag_icnp_nin     IN BOOLEAN := TRUE,
        dt_diag_icnp_in        IN viewer_ehr_ea.dt_diag_icnp%TYPE DEFAULT NULL,
        dt_diag_icnp_nin       IN BOOLEAN := TRUE,
        num_episode_in         IN viewer_ehr_ea.num_episode%TYPE DEFAULT NULL,
        num_episode_nin        IN BOOLEAN := TRUE,
        desc_episode_in        IN viewer_ehr_ea.desc_episode%TYPE DEFAULT NULL,
        desc_episode_nin       IN BOOLEAN := TRUE,
        dt_episode_in          IN viewer_ehr_ea.dt_episode%TYPE DEFAULT NULL,
        dt_episode_nin         IN BOOLEAN := TRUE,
        num_exam_in            IN viewer_ehr_ea.num_exam%TYPE DEFAULT NULL,
        num_exam_nin           IN BOOLEAN := TRUE,
        desc_exam_in           IN viewer_ehr_ea.desc_exam%TYPE DEFAULT NULL,
        desc_exam_nin          IN BOOLEAN := TRUE,
        dt_exam_in             IN viewer_ehr_ea.dt_exam%TYPE DEFAULT NULL,
        dt_exam_nin            IN BOOLEAN := TRUE,
        num_med_in             IN viewer_ehr_ea.num_med%TYPE DEFAULT NULL,
        num_med_nin            IN BOOLEAN := TRUE,
        desc_med_in            IN viewer_ehr_ea.desc_med%TYPE DEFAULT NULL,
        desc_med_nin           IN BOOLEAN := TRUE,
        dt_med_in              IN viewer_ehr_ea.dt_med%TYPE DEFAULT NULL,
        dt_med_nin             IN BOOLEAN := TRUE,
        num_problem_in         IN viewer_ehr_ea.num_problem%TYPE DEFAULT NULL,
        num_problem_nin        IN BOOLEAN := TRUE,
        desc_problem_in        IN viewer_ehr_ea.desc_problem%TYPE DEFAULT NULL,
        desc_problem_nin       IN BOOLEAN := TRUE,
        dt_problem_in          IN viewer_ehr_ea.dt_problem%TYPE DEFAULT NULL,
        dt_problem_nin         IN BOOLEAN := TRUE,
        dt_problem_fmt_in      IN viewer_ehr_ea.dt_problem_fmt%TYPE DEFAULT NULL,
        dt_problem_fmt_nin     IN BOOLEAN := TRUE,
        num_interv_in          IN viewer_ehr_ea.num_interv%TYPE DEFAULT NULL,
        num_interv_nin         IN BOOLEAN := TRUE,
        desc_interv_in         IN viewer_ehr_ea.desc_interv%TYPE DEFAULT NULL,
        desc_interv_nin        IN BOOLEAN := TRUE,
        dt_interv_in           IN viewer_ehr_ea.dt_interv%TYPE DEFAULT NULL,
        dt_interv_nin          IN BOOLEAN := TRUE,
        dt_dg_last_update_in   IN viewer_ehr_ea.dt_dg_last_update%TYPE DEFAULT NULL,
        dt_dg_last_update_nin  IN BOOLEAN := TRUE,
        code_allergy_in        IN viewer_ehr_ea.code_allergy%TYPE DEFAULT NULL,
        code_allergy_nin       IN BOOLEAN := TRUE,
        code_episode_in        IN viewer_ehr_ea.code_episode%TYPE DEFAULT NULL,
        code_episode_nin       IN BOOLEAN := TRUE,
        code_exam_in           IN viewer_ehr_ea.code_exam%TYPE DEFAULT NULL,
        code_exam_nin          IN BOOLEAN := TRUE,
        code_med_in            IN viewer_ehr_ea.code_med%TYPE DEFAULT NULL,
        code_med_nin           IN BOOLEAN := TRUE,
        code_problem_in        IN viewer_ehr_ea.code_problem%TYPE DEFAULT NULL,
        code_problem_nin       IN BOOLEAN := TRUE,
        code_lab_in            IN viewer_ehr_ea.code_lab%TYPE DEFAULT NULL,
        code_lab_nin           IN BOOLEAN := TRUE,
        code_diag_icnp_in      IN viewer_ehr_ea.code_diag_icnp%TYPE DEFAULT NULL,
        code_diag_icnp_nin     IN BOOLEAN := TRUE,
        code_interv_in         IN viewer_ehr_ea.code_interv%TYPE DEFAULT NULL,
        code_interv_nin        IN BOOLEAN := TRUE,
        create_user_in         IN viewer_ehr_ea.create_user%TYPE DEFAULT NULL,
        create_user_nin        IN BOOLEAN := TRUE,
        create_time_in         IN viewer_ehr_ea.create_time%TYPE DEFAULT NULL,
        create_time_nin        IN BOOLEAN := TRUE,
        create_institution_in  IN viewer_ehr_ea.create_institution%TYPE DEFAULT NULL,
        create_institution_nin IN BOOLEAN := TRUE,
        update_user_in         IN viewer_ehr_ea.update_user%TYPE DEFAULT NULL,
        update_user_nin        IN BOOLEAN := TRUE,
        update_time_in         IN viewer_ehr_ea.update_time%TYPE DEFAULT NULL,
        update_time_nin        IN BOOLEAN := TRUE,
        update_institution_in  IN viewer_ehr_ea.update_institution%TYPE DEFAULT NULL,
        update_institution_nin IN BOOLEAN := TRUE,
        flg_exclamation_in     IN viewer_ehr_ea.flg_exclamation%TYPE DEFAULT NULL,
        flg_exclamation_nin    IN BOOLEAN := TRUE,
        flg_infective_in       IN viewer_ehr_ea.flg_infective%TYPE DEFAULT NULL,
        flg_infective_nin      IN BOOLEAN := TRUE,
        num_vs_in              IN viewer_ehr_ea.num_vs%TYPE DEFAULT NULL,
        num_vs_nin             IN BOOLEAN := TRUE,
        desc_vs_in             IN viewer_ehr_ea.desc_vs%TYPE DEFAULT NULL,
        desc_vs_nin            IN BOOLEAN := TRUE,
        dt_vs_in               IN viewer_ehr_ea.dt_vs%TYPE DEFAULT NULL,
        dt_vs_nin              IN BOOLEAN := TRUE,
        code_vs_in             IN viewer_ehr_ea.code_vs%TYPE DEFAULT NULL,
        code_vs_nin            IN BOOLEAN := TRUE,
        num_note_in            IN viewer_ehr_ea.num_note%TYPE DEFAULT NULL,
        num_note_nin           IN BOOLEAN := TRUE,
        desc_note_in           IN viewer_ehr_ea.desc_note%TYPE DEFAULT NULL,
        desc_note_nin          IN BOOLEAN := TRUE,
        dt_note_in             IN viewer_ehr_ea.dt_note%TYPE DEFAULT NULL,
        dt_note_nin            IN BOOLEAN := TRUE,
        code_note_in           IN viewer_ehr_ea.code_note%TYPE DEFAULT NULL,
        code_note_nin          IN BOOLEAN := TRUE,
        num_archive_in         IN viewer_ehr_ea.num_archive%TYPE DEFAULT NULL,
        num_archive_nin        IN BOOLEAN := TRUE,
        desc_archive_in        IN viewer_ehr_ea.desc_archive%TYPE DEFAULT NULL,
        desc_archive_nin       IN BOOLEAN := TRUE,
        dt_archive_in          IN viewer_ehr_ea.dt_archive%TYPE DEFAULT NULL,
        dt_archive_nin         IN BOOLEAN := TRUE,
        code_archive_in        IN viewer_ehr_ea.code_archive%TYPE DEFAULT NULL,
        code_archive_nin       IN BOOLEAN := TRUE,
        num_epis_archive_in    IN viewer_ehr_ea.num_epis_archive%TYPE DEFAULT NULL,
        num_epis_archive_nin   IN BOOLEAN := TRUE,
        desc_epis_archive_in   IN viewer_ehr_ea.desc_epis_archive%TYPE DEFAULT NULL,
        desc_epis_archive_nin  IN BOOLEAN := TRUE,
        dt_epis_archive_in     IN viewer_ehr_ea.dt_epis_archive%TYPE DEFAULT NULL,
        dt_epis_archive_nin    IN BOOLEAN := TRUE,
        code_epis_archive_in   IN viewer_ehr_ea.code_epis_archive%TYPE DEFAULT NULL,
        code_epis_archive_nin  IN BOOLEAN := TRUE,
        num_bp_in              IN viewer_ehr_ea.num_bp%TYPE DEFAULT NULL,
        num_bp_nin             IN BOOLEAN := TRUE,
        dt_bp_in               IN viewer_ehr_ea.dt_bp%TYPE DEFAULT NULL,
        dt_bp_nin              IN BOOLEAN := TRUE,
        code_bp_in             IN viewer_ehr_ea.code_bp%TYPE DEFAULT NULL,
        code_bp_nin            IN BOOLEAN := TRUE,
        desc_bp_in             IN viewer_ehr_ea.desc_bp%TYPE DEFAULT NULL,
        desc_bp_nin            IN BOOLEAN := TRUE,
        id_problem_in          IN viewer_ehr_ea.id_problem%TYPE DEFAULT NULL,
        id_problem_nin         IN BOOLEAN := TRUE,
        id_task_type_in        IN viewer_ehr_ea.id_task_type%TYPE DEFAULT NULL,
        id_task_type_nin       IN BOOLEAN := TRUE,
        where_in               IN VARCHAR2,
        handle_error_in        IN BOOLEAN := TRUE,
        rows_out               IN OUT table_varchar
    ) IS
        l_sql                  VARCHAR2(32767);
        l_rows_out             table_varchar;
        l_num_allergy_n        NUMBER(1) := sys.diutil.bool_to_int(num_allergy_nin);
        l_desc_allergy_n       NUMBER(1) := sys.diutil.bool_to_int(desc_allergy_nin);
        l_dt_allergy_n         NUMBER(1) := sys.diutil.bool_to_int(dt_allergy_nin);
        l_dt_allergy_fmt_n     NUMBER(1) := sys.diutil.bool_to_int(dt_allergy_fmt_nin);
        l_num_lab_n            NUMBER(1) := sys.diutil.bool_to_int(num_lab_nin);
        l_desc_lab_n           NUMBER(1) := sys.diutil.bool_to_int(desc_lab_nin);
        l_dt_lab_n             NUMBER(1) := sys.diutil.bool_to_int(dt_lab_nin);
        l_num_diag_icnp_n      NUMBER(1) := sys.diutil.bool_to_int(num_diag_icnp_nin);
        l_desc_diag_icnp_n     NUMBER(1) := sys.diutil.bool_to_int(desc_diag_icnp_nin);
        l_dt_diag_icnp_n       NUMBER(1) := sys.diutil.bool_to_int(dt_diag_icnp_nin);
        l_num_episode_n        NUMBER(1) := sys.diutil.bool_to_int(num_episode_nin);
        l_desc_episode_n       NUMBER(1) := sys.diutil.bool_to_int(desc_episode_nin);
        l_dt_episode_n         NUMBER(1) := sys.diutil.bool_to_int(dt_episode_nin);
        l_num_exam_n           NUMBER(1) := sys.diutil.bool_to_int(num_exam_nin);
        l_desc_exam_n          NUMBER(1) := sys.diutil.bool_to_int(desc_exam_nin);
        l_dt_exam_n            NUMBER(1) := sys.diutil.bool_to_int(dt_exam_nin);
        l_num_med_n            NUMBER(1) := sys.diutil.bool_to_int(num_med_nin);
        l_desc_med_n           NUMBER(1) := sys.diutil.bool_to_int(desc_med_nin);
        l_dt_med_n             NUMBER(1) := sys.diutil.bool_to_int(dt_med_nin);
        l_num_problem_n        NUMBER(1) := sys.diutil.bool_to_int(num_problem_nin);
        l_desc_problem_n       NUMBER(1) := sys.diutil.bool_to_int(desc_problem_nin);
        l_dt_problem_n         NUMBER(1) := sys.diutil.bool_to_int(dt_problem_nin);
        l_dt_problem_fmt_n     NUMBER(1) := sys.diutil.bool_to_int(dt_problem_fmt_nin);
        l_num_interv_n         NUMBER(1) := sys.diutil.bool_to_int(num_interv_nin);
        l_desc_interv_n        NUMBER(1) := sys.diutil.bool_to_int(desc_interv_nin);
        l_dt_interv_n          NUMBER(1) := sys.diutil.bool_to_int(dt_interv_nin);
        l_dt_dg_last_update_n  NUMBER(1) := sys.diutil.bool_to_int(dt_dg_last_update_nin);
        l_code_allergy_n       NUMBER(1) := sys.diutil.bool_to_int(code_allergy_nin);
        l_code_episode_n       NUMBER(1) := sys.diutil.bool_to_int(code_episode_nin);
        l_code_exam_n          NUMBER(1) := sys.diutil.bool_to_int(code_exam_nin);
        l_code_med_n           NUMBER(1) := sys.diutil.bool_to_int(code_med_nin);
        l_code_problem_n       NUMBER(1) := sys.diutil.bool_to_int(code_problem_nin);
        l_code_lab_n           NUMBER(1) := sys.diutil.bool_to_int(code_lab_nin);
        l_code_diag_icnp_n     NUMBER(1) := sys.diutil.bool_to_int(code_diag_icnp_nin);
        l_code_interv_n        NUMBER(1) := sys.diutil.bool_to_int(code_interv_nin);
        l_create_user_n        NUMBER(1) := sys.diutil.bool_to_int(create_user_nin);
        l_create_time_n        NUMBER(1) := sys.diutil.bool_to_int(create_time_nin);
        l_create_institution_n NUMBER(1) := sys.diutil.bool_to_int(create_institution_nin);
        l_update_user_n        NUMBER(1) := sys.diutil.bool_to_int(update_user_nin);
        l_update_time_n        NUMBER(1) := sys.diutil.bool_to_int(update_time_nin);
        l_update_institution_n NUMBER(1) := sys.diutil.bool_to_int(update_institution_nin);
        l_flg_exclamation_n    NUMBER(1) := sys.diutil.bool_to_int(flg_exclamation_nin);
        l_flg_infective_n      NUMBER(1) := sys.diutil.bool_to_int(flg_infective_nin);
        l_num_vs_n             NUMBER(1) := sys.diutil.bool_to_int(num_vs_nin);
        l_desc_vs_n            NUMBER(1) := sys.diutil.bool_to_int(desc_vs_nin);
        l_dt_vs_n              NUMBER(1) := sys.diutil.bool_to_int(dt_vs_nin);
        l_code_vs_n            NUMBER(1) := sys.diutil.bool_to_int(code_vs_nin);
        l_num_note_n           NUMBER(1) := sys.diutil.bool_to_int(num_note_nin);
        l_desc_note_n          NUMBER(1) := sys.diutil.bool_to_int(desc_note_nin);
        l_dt_note_n            NUMBER(1) := sys.diutil.bool_to_int(dt_note_nin);
        l_code_note_n          NUMBER(1) := sys.diutil.bool_to_int(code_note_nin);
        l_num_archive_n        NUMBER(1) := sys.diutil.bool_to_int(num_archive_nin);
        l_desc_archive_n       NUMBER(1) := sys.diutil.bool_to_int(desc_archive_nin);
        l_dt_archive_n         NUMBER(1) := sys.diutil.bool_to_int(dt_archive_nin);
        l_code_archive_n       NUMBER(1) := sys.diutil.bool_to_int(code_archive_nin);
        l_num_epis_archive_n   NUMBER(1) := sys.diutil.bool_to_int(num_epis_archive_nin);
        l_desc_epis_archive_n  NUMBER(1) := sys.diutil.bool_to_int(desc_epis_archive_nin);
        l_dt_epis_archive_n    NUMBER(1) := sys.diutil.bool_to_int(dt_epis_archive_nin);
        l_code_epis_archive_n  NUMBER(1) := sys.diutil.bool_to_int(code_epis_archive_nin);
        l_num_bp_n             NUMBER(1) := sys.diutil.bool_to_int(num_bp_nin);
        l_dt_bp_n              NUMBER(1) := sys.diutil.bool_to_int(dt_bp_nin);
        l_code_bp_n            NUMBER(1) := sys.diutil.bool_to_int(code_bp_nin);
        l_desc_bp_n            NUMBER(1) := sys.diutil.bool_to_int(desc_bp_nin);
        l_id_problem_n         NUMBER(1) := sys.diutil.bool_to_int(id_problem_nin);
        l_id_task_type_n       NUMBER(1) := sys.diutil.bool_to_int(id_task_type_nin);
    BEGIN
        l_num_allergy_n        := sys.diutil.bool_to_int(num_allergy_nin);
        l_desc_allergy_n       := sys.diutil.bool_to_int(desc_allergy_nin);
        l_dt_allergy_n         := sys.diutil.bool_to_int(dt_allergy_nin);
        l_dt_allergy_fmt_n     := sys.diutil.bool_to_int(dt_allergy_fmt_nin);
        l_num_lab_n            := sys.diutil.bool_to_int(num_lab_nin);
        l_desc_lab_n           := sys.diutil.bool_to_int(desc_lab_nin);
        l_dt_lab_n             := sys.diutil.bool_to_int(dt_lab_nin);
        l_num_diag_icnp_n      := sys.diutil.bool_to_int(num_diag_icnp_nin);
        l_desc_diag_icnp_n     := sys.diutil.bool_to_int(desc_diag_icnp_nin);
        l_dt_diag_icnp_n       := sys.diutil.bool_to_int(dt_diag_icnp_nin);
        l_num_episode_n        := sys.diutil.bool_to_int(num_episode_nin);
        l_desc_episode_n       := sys.diutil.bool_to_int(desc_episode_nin);
        l_dt_episode_n         := sys.diutil.bool_to_int(dt_episode_nin);
        l_num_exam_n           := sys.diutil.bool_to_int(num_exam_nin);
        l_desc_exam_n          := sys.diutil.bool_to_int(desc_exam_nin);
        l_dt_exam_n            := sys.diutil.bool_to_int(dt_exam_nin);
        l_num_med_n            := sys.diutil.bool_to_int(num_med_nin);
        l_desc_med_n           := sys.diutil.bool_to_int(desc_med_nin);
        l_dt_med_n             := sys.diutil.bool_to_int(dt_med_nin);
        l_num_problem_n        := sys.diutil.bool_to_int(num_problem_nin);
        l_desc_problem_n       := sys.diutil.bool_to_int(desc_problem_nin);
        l_dt_problem_n         := sys.diutil.bool_to_int(dt_problem_nin);
        l_dt_problem_fmt_n     := sys.diutil.bool_to_int(dt_problem_fmt_nin);
        l_num_interv_n         := sys.diutil.bool_to_int(num_interv_nin);
        l_desc_interv_n        := sys.diutil.bool_to_int(desc_interv_nin);
        l_dt_interv_n          := sys.diutil.bool_to_int(dt_interv_nin);
        l_dt_dg_last_update_n  := sys.diutil.bool_to_int(dt_dg_last_update_nin);
        l_code_allergy_n       := sys.diutil.bool_to_int(code_allergy_nin);
        l_code_episode_n       := sys.diutil.bool_to_int(code_episode_nin);
        l_code_exam_n          := sys.diutil.bool_to_int(code_exam_nin);
        l_code_med_n           := sys.diutil.bool_to_int(code_med_nin);
        l_code_problem_n       := sys.diutil.bool_to_int(code_problem_nin);
        l_code_lab_n           := sys.diutil.bool_to_int(code_lab_nin);
        l_code_diag_icnp_n     := sys.diutil.bool_to_int(code_diag_icnp_nin);
        l_code_interv_n        := sys.diutil.bool_to_int(code_interv_nin);
        l_create_user_n        := sys.diutil.bool_to_int(create_user_nin);
        l_create_time_n        := sys.diutil.bool_to_int(create_time_nin);
        l_create_institution_n := sys.diutil.bool_to_int(create_institution_nin);
        l_update_user_n        := sys.diutil.bool_to_int(update_user_nin);
        l_update_time_n        := sys.diutil.bool_to_int(update_time_nin);
        l_update_institution_n := sys.diutil.bool_to_int(update_institution_nin);
        l_flg_exclamation_n    := sys.diutil.bool_to_int(flg_exclamation_nin);
        l_flg_infective_n      := sys.diutil.bool_to_int(flg_infective_nin);
        l_num_vs_n             := sys.diutil.bool_to_int(num_vs_nin);
        l_desc_vs_n            := sys.diutil.bool_to_int(desc_vs_nin);
        l_dt_vs_n              := sys.diutil.bool_to_int(dt_vs_nin);
        l_code_vs_n            := sys.diutil.bool_to_int(code_vs_nin);
        l_num_note_n           := sys.diutil.bool_to_int(num_note_nin);
        l_desc_note_n          := sys.diutil.bool_to_int(desc_note_nin);
        l_dt_note_n            := sys.diutil.bool_to_int(dt_note_nin);
        l_code_note_n          := sys.diutil.bool_to_int(code_note_nin);
        l_num_archive_n        := sys.diutil.bool_to_int(num_archive_nin);
        l_desc_archive_n       := sys.diutil.bool_to_int(desc_archive_nin);
        l_dt_archive_n         := sys.diutil.bool_to_int(dt_archive_nin);
        l_code_archive_n       := sys.diutil.bool_to_int(code_archive_nin);
        l_num_epis_archive_n   := sys.diutil.bool_to_int(num_epis_archive_nin);
        l_desc_epis_archive_n  := sys.diutil.bool_to_int(desc_epis_archive_nin);
        l_dt_epis_archive_n    := sys.diutil.bool_to_int(dt_epis_archive_nin);
        l_code_epis_archive_n  := sys.diutil.bool_to_int(code_epis_archive_nin);
        l_num_bp_n             := sys.diutil.bool_to_int(num_bp_nin);
        l_dt_bp_n              := sys.diutil.bool_to_int(dt_bp_nin);
        l_code_bp_n            := sys.diutil.bool_to_int(code_bp_nin);
        l_desc_bp_n            := sys.diutil.bool_to_int(desc_bp_nin);
        l_id_problem_n         := sys.diutil.bool_to_int(id_problem_nin);
        l_id_task_type_n       := sys.diutil.bool_to_int(id_task_type_nin);
        l_sql                  := 'UPDATE viewer_ehr_ea SET' || ' NUM_ALLERGY = decode (' || l_num_allergy_n ||
                                  ',0,:NUM_ALLERGY_in, NVL (:NUM_ALLERGY_in, NUM_ALLERGY)) ' || ',' ||
                                  ' DESC_ALLERGY = decode (' || l_desc_allergy_n ||
                                  ',0,:DESC_ALLERGY_in, NVL (:DESC_ALLERGY_in, DESC_ALLERGY)) ' || ',' ||
                                  ' DT_ALLERGY = decode (' || l_dt_allergy_n ||
                                  ',0,:DT_ALLERGY_in, NVL (:DT_ALLERGY_in, DT_ALLERGY)) ' || ',' ||
                                  ' DT_ALLERGY_FMT = decode (' || l_dt_allergy_fmt_n ||
                                  ',0,:DT_ALLERGY_FMT_in, NVL (:DT_ALLERGY_FMT_in, DT_ALLERGY_FMT)) ' || ',' ||
                                  ' NUM_LAB = decode (' || l_num_lab_n ||
                                  ',0,:NUM_LAB_in, NVL (:NUM_LAB_in, NUM_LAB)) ' || ',' || ' DESC_LAB = decode (' ||
                                  l_desc_lab_n || ',0,:DESC_LAB_in, NVL (:DESC_LAB_in, DESC_LAB)) ' || ',' ||
                                  ' DT_LAB = decode (' || l_dt_lab_n || ',0,:DT_LAB_in, NVL (:DT_LAB_in, DT_LAB)) ' || ',' ||
                                  ' NUM_DIAG_ICNP = decode (' || l_num_diag_icnp_n ||
                                  ',0,:NUM_DIAG_ICNP_in, NVL (:NUM_DIAG_ICNP_in, NUM_DIAG_ICNP)) ' || ',' ||
                                  ' DESC_DIAG_ICNP = decode (' || l_desc_diag_icnp_n ||
                                  ',0,:DESC_DIAG_ICNP_in, NVL (:DESC_DIAG_ICNP_in, DESC_DIAG_ICNP)) ' || ',' ||
                                  ' DT_DIAG_ICNP = decode (' || l_dt_diag_icnp_n ||
                                  ',0,:DT_DIAG_ICNP_in, NVL (:DT_DIAG_ICNP_in, DT_DIAG_ICNP)) ' || ',' ||
                                  ' NUM_EPISODE = decode (' || l_num_episode_n ||
                                  ',0,:NUM_EPISODE_in, NVL (:NUM_EPISODE_in, NUM_EPISODE)) ' || ',' ||
                                  ' DESC_EPISODE = decode (' || l_desc_episode_n ||
                                  ',0,:DESC_EPISODE_in, NVL (:DESC_EPISODE_in, DESC_EPISODE)) ' || ',' ||
                                  ' DT_EPISODE = decode (' || l_dt_episode_n ||
                                  ',0,:DT_EPISODE_in, NVL (:DT_EPISODE_in, DT_EPISODE)) ' || ',' ||
                                  ' NUM_EXAM = decode (' || l_num_exam_n ||
                                  ',0,:NUM_EXAM_in, NVL (:NUM_EXAM_in, NUM_EXAM)) ' || ',' || ' DESC_EXAM = decode (' ||
                                  l_desc_exam_n || ',0,:DESC_EXAM_in, NVL (:DESC_EXAM_in, DESC_EXAM)) ' || ',' ||
                                  ' DT_EXAM = decode (' || l_dt_exam_n ||
                                  ',0,:DT_EXAM_in, NVL (:DT_EXAM_in, DT_EXAM)) ' || ',' || ' NUM_MED = decode (' ||
                                  l_num_med_n || ',0,:NUM_MED_in, NVL (:NUM_MED_in, NUM_MED)) ' || ',' ||
                                  ' DESC_MED = decode (' || l_desc_med_n ||
                                  ',0,:DESC_MED_in, NVL (:DESC_MED_in, DESC_MED)) ' || ',' || ' DT_MED = decode (' ||
                                  l_dt_med_n || ',0,:DT_MED_in, NVL (:DT_MED_in, DT_MED)) ' || ',' ||
                                  ' NUM_PROBLEM = decode (' || l_num_problem_n ||
                                  ',0,:NUM_PROBLEM_in, NVL (:NUM_PROBLEM_in, NUM_PROBLEM)) ' || ',' ||
                                  ' DESC_PROBLEM = decode (' || l_desc_problem_n ||
                                  ',0,:DESC_PROBLEM_in, NVL (:DESC_PROBLEM_in, DESC_PROBLEM)) ' || ',' ||
                                  ' DT_PROBLEM = decode (' || l_dt_problem_n ||
                                  ',0,:DT_PROBLEM_in, NVL (:DT_PROBLEM_in, DT_PROBLEM)) ' || ',' ||
                                  ' DT_PROBLEM_FMT = decode (' || l_dt_problem_fmt_n ||
                                  ',0,:DT_PROBLEM_FMT_in, NVL (:DT_PROBLEM_FMT_in, DT_PROBLEM_FMT)) ' || ',' ||
                                  ' NUM_INTERV = decode (' || l_num_interv_n ||
                                  ',0,:NUM_INTERV_in, NVL (:NUM_INTERV_in, NUM_INTERV)) ' || ',' ||
                                  ' DESC_INTERV = decode (' || l_desc_interv_n ||
                                  ',0,:DESC_INTERV_in, NVL (:DESC_INTERV_in, DESC_INTERV)) ' || ',' ||
                                  ' DT_INTERV = decode (' || l_dt_interv_n ||
                                  ',0,:DT_INTERV_in, NVL (:DT_INTERV_in, DT_INTERV)) ' || ',' ||
                                  ' DT_DG_LAST_UPDATE = decode (' || l_dt_dg_last_update_n ||
                                  ',0,:DT_DG_LAST_UPDATE_in, NVL (:DT_DG_LAST_UPDATE_in, DT_DG_LAST_UPDATE)) ' || ',' ||
                                  ' CODE_ALLERGY = decode (' || l_code_allergy_n ||
                                  ',0,:CODE_ALLERGY_in, NVL (:CODE_ALLERGY_in, CODE_ALLERGY)) ' || ',' ||
                                  ' CODE_EPISODE = decode (' || l_code_episode_n ||
                                  ',0,:CODE_EPISODE_in, NVL (:CODE_EPISODE_in, CODE_EPISODE)) ' || ',' ||
                                  ' CODE_EXAM = decode (' || l_code_exam_n ||
                                  ',0,:CODE_EXAM_in, NVL (:CODE_EXAM_in, CODE_EXAM)) ' || ',' || ' CODE_MED = decode (' ||
                                  l_code_med_n || ',0,:CODE_MED_in, NVL (:CODE_MED_in, CODE_MED)) ' || ',' ||
                                  ' CODE_PROBLEM = decode (' || l_code_problem_n ||
                                  ',0,:CODE_PROBLEM_in, NVL (:CODE_PROBLEM_in, CODE_PROBLEM)) ' || ',' ||
                                  ' CODE_LAB = decode (' || l_code_lab_n ||
                                  ',0,:CODE_LAB_in, NVL (:CODE_LAB_in, CODE_LAB)) ' || ',' ||
                                  ' CODE_DIAG_ICNP = decode (' || l_code_diag_icnp_n ||
                                  ',0,:CODE_DIAG_ICNP_in, NVL (:CODE_DIAG_ICNP_in, CODE_DIAG_ICNP)) ' || ',' ||
                                  ' CODE_INTERV = decode (' || l_code_interv_n ||
                                  ',0,:CODE_INTERV_in, NVL (:CODE_INTERV_in, CODE_INTERV)) ' || ',' ||
                                  ' CREATE_USER = decode (' || l_create_user_n ||
                                  ',0,:CREATE_USER_in, NVL (:CREATE_USER_in, CREATE_USER)) ' || ',' ||
                                  ' CREATE_TIME = decode (' || l_create_time_n ||
                                  ',0,:CREATE_TIME_in, NVL (:CREATE_TIME_in, CREATE_TIME)) ' || ',' ||
                                  ' CREATE_INSTITUTION = decode (' || l_create_institution_n ||
                                  ',0,:CREATE_INSTITUTION_in, NVL (:CREATE_INSTITUTION_in, CREATE_INSTITUTION)) ' || ',' ||
                                  ' UPDATE_USER = decode (' || l_update_user_n ||
                                  ',0,:UPDATE_USER_in, NVL (:UPDATE_USER_in, UPDATE_USER)) ' || ',' ||
                                  ' UPDATE_TIME = decode (' || l_update_time_n ||
                                  ',0,:UPDATE_TIME_in, NVL (:UPDATE_TIME_in, UPDATE_TIME)) ' || ',' ||
                                  ' UPDATE_INSTITUTION = decode (' || l_update_institution_n ||
                                  ',0,:UPDATE_INSTITUTION_in, NVL (:UPDATE_INSTITUTION_in, UPDATE_INSTITUTION)) ' || ',' ||
                                  ' FLG_EXCLAMATION = decode (' || l_flg_exclamation_n ||
                                  ',0,:FLG_EXCLAMATION_in, NVL (:FLG_EXCLAMATION_in, FLG_EXCLAMATION)) ' || ',' ||
                                  ' FLG_INFECTIVE = decode (' || l_flg_infective_n ||
                                  ',0,:FLG_INFECTIVE_in, NVL (:FLG_INFECTIVE_in, FLG_INFECTIVE)) ' || ',' ||
                                  ' NUM_VS = decode (' || l_num_vs_n || ',0,:NUM_VS_in, NVL (:NUM_VS_in, NUM_VS)) ' || ',' ||
                                  ' DESC_VS = decode (' || l_desc_vs_n ||
                                  ',0,:DESC_VS_in, NVL (:DESC_VS_in, DESC_VS)) ' || ',' || ' DT_VS = decode (' ||
                                  l_dt_vs_n || ',0,:DT_VS_in, NVL (:DT_VS_in, DT_VS)) ' || ',' || ' CODE_VS = decode (' ||
                                  l_code_vs_n || ',0,:CODE_VS_in, NVL (:CODE_VS_in, CODE_VS)) ' || ',' ||
                                  ' NUM_NOTE = decode (' || l_num_note_n ||
                                  ',0,:NUM_NOTE_in, NVL (:NUM_NOTE_in, NUM_NOTE)) ' || ',' || ' DESC_NOTE = decode (' ||
                                  l_desc_note_n || ',0,:DESC_NOTE_in, NVL (:DESC_NOTE_in, DESC_NOTE)) ' || ',' ||
                                  ' DT_NOTE = decode (' || l_dt_note_n ||
                                  ',0,:DT_NOTE_in, NVL (:DT_NOTE_in, DT_NOTE)) ' || ',' || ' CODE_NOTE = decode (' ||
                                  l_code_note_n || ',0,:CODE_NOTE_in, NVL (:CODE_NOTE_in, CODE_NOTE)) ' || ',' ||
                                  ' NUM_ARCHIVE = decode (' || l_num_archive_n ||
                                  ',0,:NUM_ARCHIVE_in, NVL (:NUM_ARCHIVE_in, NUM_ARCHIVE)) ' || ',' ||
                                  ' DESC_ARCHIVE = decode (' || l_desc_archive_n ||
                                  ',0,:DESC_ARCHIVE_in, NVL (:DESC_ARCHIVE_in, DESC_ARCHIVE)) ' || ',' ||
                                  ' DT_ARCHIVE = decode (' || l_dt_archive_n ||
                                  ',0,:DT_ARCHIVE_in, NVL (:DT_ARCHIVE_in, DT_ARCHIVE)) ' || ',' ||
                                  ' CODE_ARCHIVE = decode (' || l_code_archive_n ||
                                  ',0,:CODE_ARCHIVE_in, NVL (:CODE_ARCHIVE_in, CODE_ARCHIVE)) ' || ',' ||
                                  ' NUM_EPIS_ARCHIVE = decode (' || l_num_epis_archive_n ||
                                  ',0,:NUM_EPIS_ARCHIVE_in, NVL (:NUM_EPIS_ARCHIVE_in, NUM_EPIS_ARCHIVE)) ' || ',' ||
                                  ' DESC_EPIS_ARCHIVE = decode (' || l_desc_epis_archive_n ||
                                  ',0,:DESC_EPIS_ARCHIVE_in, NVL (:DESC_EPIS_ARCHIVE_in, DESC_EPIS_ARCHIVE)) ' || ',' ||
                                  ' DT_EPIS_ARCHIVE = decode (' || l_dt_epis_archive_n ||
                                  ',0,:DT_EPIS_ARCHIVE_in, NVL (:DT_EPIS_ARCHIVE_in, DT_EPIS_ARCHIVE)) ' || ',' ||
                                  ' CODE_EPIS_ARCHIVE = decode (' || l_code_epis_archive_n ||
                                  ',0,:CODE_EPIS_ARCHIVE_in, NVL (:CODE_EPIS_ARCHIVE_in, CODE_EPIS_ARCHIVE)) ' || ',' ||
                                  ' NUM_BP = decode (' || l_num_bp_n || ',0,:NUM_BP_in, NVL (:NUM_BP_in, NUM_BP)) ' || ',' ||
                                  ' DT_BP = decode (' || l_dt_bp_n || ',0,:DT_BP_in, NVL (:DT_BP_in, DT_BP)) ' || ',' ||
                                  ' CODE_BP = decode (' || l_code_bp_n ||
                                  ',0,:CODE_BP_in, NVL (:CODE_BP_in, CODE_BP)) ' || ',' || ' DESC_BP = decode (' ||
                                  l_desc_bp_n || ',0,:DESC_BP_in, NVL (:DESC_BP_in, DESC_BP)) ' || ',' ||
                                  ' ID_PROBLEM = decode (' || l_id_problem_n ||
                                  ',0,:ID_PROBLEM_in, NVL (:ID_PROBLEM_in, ID_PROBLEM)) ' || ',' ||
                                  ' ID_TASK_TYPE = decode (' || l_id_task_type_n ||
                                  ',0,:ID_TASK_TYPE_in, NVL (:ID_TASK_TYPE_in, ID_TASK_TYPE)) ' || ' where ' ||
                                  nvl(where_in, '(1=1)') || ' RETURNING ROWID BULK COLLECT INTO :l_rows_out';
        EXECUTE IMMEDIATE 'BEGIN ' || l_sql || '; END;'
            USING IN num_allergy_in, desc_allergy_in, dt_allergy_in, dt_allergy_fmt_in, num_lab_in, desc_lab_in, dt_lab_in, num_diag_icnp_in, desc_diag_icnp_in, dt_diag_icnp_in, num_episode_in, desc_episode_in, dt_episode_in, num_exam_in, desc_exam_in, dt_exam_in, num_med_in, desc_med_in, dt_med_in, num_problem_in, desc_problem_in, dt_problem_in, dt_problem_fmt_in, num_interv_in, desc_interv_in, dt_interv_in, dt_dg_last_update_in, code_allergy_in, code_episode_in, code_exam_in, code_med_in, code_problem_in, code_lab_in, code_diag_icnp_in, code_interv_in, create_user_in, create_time_in, create_institution_in, update_user_in, update_time_in, update_institution_in, flg_exclamation_in, flg_infective_in, num_vs_in, desc_vs_in, dt_vs_in, code_vs_in, num_note_in, desc_note_in, dt_note_in, code_note_in, num_archive_in, desc_archive_in, dt_archive_in, code_archive_in, num_epis_archive_in, desc_epis_archive_in, dt_epis_archive_in, code_epis_archive_in, num_bp_in, dt_bp_in, code_bp_in, desc_bp_in, id_problem_in, id_task_type_in, OUT l_rows_out;
        IF (rows_out IS NULL)
        THEN
            rows_out := table_varchar();
        END IF;
        rows_out := rows_out MULTISET UNION DISTINCT l_rows_out;
    
    EXCEPTION
        WHEN e_null_column_value
             OR e_existing_fky_reference
             OR e_check_constraint_failure
             OR e_no_parent_key
             OR e_child_record_found
             OR e_forall_error
             OR e_integ_constraint_failure THEN
            IF NOT handle_error_in
            THEN
                RAISE;
            ELSE
                pk_alertlog.log_error('DML error ignored: ' || SQLCODE || ': ' || SQLERRM);
            END IF;
        
    END upd;

    --Update any/all columns by dynamic WHERE
    -- If you pass NULL, then the current column value is set to itself
    PROCEDURE upd
    (
        num_allergy_in         IN viewer_ehr_ea.num_allergy%TYPE DEFAULT NULL,
        num_allergy_nin        IN BOOLEAN := TRUE,
        desc_allergy_in        IN viewer_ehr_ea.desc_allergy%TYPE DEFAULT NULL,
        desc_allergy_nin       IN BOOLEAN := TRUE,
        dt_allergy_in          IN viewer_ehr_ea.dt_allergy%TYPE DEFAULT NULL,
        dt_allergy_nin         IN BOOLEAN := TRUE,
        dt_allergy_fmt_in      IN viewer_ehr_ea.dt_allergy_fmt%TYPE DEFAULT NULL,
        dt_allergy_fmt_nin     IN BOOLEAN := TRUE,
        num_lab_in             IN viewer_ehr_ea.num_lab%TYPE DEFAULT NULL,
        num_lab_nin            IN BOOLEAN := TRUE,
        desc_lab_in            IN viewer_ehr_ea.desc_lab%TYPE DEFAULT NULL,
        desc_lab_nin           IN BOOLEAN := TRUE,
        dt_lab_in              IN viewer_ehr_ea.dt_lab%TYPE DEFAULT NULL,
        dt_lab_nin             IN BOOLEAN := TRUE,
        num_diag_icnp_in       IN viewer_ehr_ea.num_diag_icnp%TYPE DEFAULT NULL,
        num_diag_icnp_nin      IN BOOLEAN := TRUE,
        desc_diag_icnp_in      IN viewer_ehr_ea.desc_diag_icnp%TYPE DEFAULT NULL,
        desc_diag_icnp_nin     IN BOOLEAN := TRUE,
        dt_diag_icnp_in        IN viewer_ehr_ea.dt_diag_icnp%TYPE DEFAULT NULL,
        dt_diag_icnp_nin       IN BOOLEAN := TRUE,
        num_episode_in         IN viewer_ehr_ea.num_episode%TYPE DEFAULT NULL,
        num_episode_nin        IN BOOLEAN := TRUE,
        desc_episode_in        IN viewer_ehr_ea.desc_episode%TYPE DEFAULT NULL,
        desc_episode_nin       IN BOOLEAN := TRUE,
        dt_episode_in          IN viewer_ehr_ea.dt_episode%TYPE DEFAULT NULL,
        dt_episode_nin         IN BOOLEAN := TRUE,
        num_exam_in            IN viewer_ehr_ea.num_exam%TYPE DEFAULT NULL,
        num_exam_nin           IN BOOLEAN := TRUE,
        desc_exam_in           IN viewer_ehr_ea.desc_exam%TYPE DEFAULT NULL,
        desc_exam_nin          IN BOOLEAN := TRUE,
        dt_exam_in             IN viewer_ehr_ea.dt_exam%TYPE DEFAULT NULL,
        dt_exam_nin            IN BOOLEAN := TRUE,
        num_med_in             IN viewer_ehr_ea.num_med%TYPE DEFAULT NULL,
        num_med_nin            IN BOOLEAN := TRUE,
        desc_med_in            IN viewer_ehr_ea.desc_med%TYPE DEFAULT NULL,
        desc_med_nin           IN BOOLEAN := TRUE,
        dt_med_in              IN viewer_ehr_ea.dt_med%TYPE DEFAULT NULL,
        dt_med_nin             IN BOOLEAN := TRUE,
        num_problem_in         IN viewer_ehr_ea.num_problem%TYPE DEFAULT NULL,
        num_problem_nin        IN BOOLEAN := TRUE,
        desc_problem_in        IN viewer_ehr_ea.desc_problem%TYPE DEFAULT NULL,
        desc_problem_nin       IN BOOLEAN := TRUE,
        dt_problem_in          IN viewer_ehr_ea.dt_problem%TYPE DEFAULT NULL,
        dt_problem_nin         IN BOOLEAN := TRUE,
        dt_problem_fmt_in      IN viewer_ehr_ea.dt_problem_fmt%TYPE DEFAULT NULL,
        dt_problem_fmt_nin     IN BOOLEAN := TRUE,
        num_interv_in          IN viewer_ehr_ea.num_interv%TYPE DEFAULT NULL,
        num_interv_nin         IN BOOLEAN := TRUE,
        desc_interv_in         IN viewer_ehr_ea.desc_interv%TYPE DEFAULT NULL,
        desc_interv_nin        IN BOOLEAN := TRUE,
        dt_interv_in           IN viewer_ehr_ea.dt_interv%TYPE DEFAULT NULL,
        dt_interv_nin          IN BOOLEAN := TRUE,
        dt_dg_last_update_in   IN viewer_ehr_ea.dt_dg_last_update%TYPE DEFAULT NULL,
        dt_dg_last_update_nin  IN BOOLEAN := TRUE,
        code_allergy_in        IN viewer_ehr_ea.code_allergy%TYPE DEFAULT NULL,
        code_allergy_nin       IN BOOLEAN := TRUE,
        code_episode_in        IN viewer_ehr_ea.code_episode%TYPE DEFAULT NULL,
        code_episode_nin       IN BOOLEAN := TRUE,
        code_exam_in           IN viewer_ehr_ea.code_exam%TYPE DEFAULT NULL,
        code_exam_nin          IN BOOLEAN := TRUE,
        code_med_in            IN viewer_ehr_ea.code_med%TYPE DEFAULT NULL,
        code_med_nin           IN BOOLEAN := TRUE,
        code_problem_in        IN viewer_ehr_ea.code_problem%TYPE DEFAULT NULL,
        code_problem_nin       IN BOOLEAN := TRUE,
        code_lab_in            IN viewer_ehr_ea.code_lab%TYPE DEFAULT NULL,
        code_lab_nin           IN BOOLEAN := TRUE,
        code_diag_icnp_in      IN viewer_ehr_ea.code_diag_icnp%TYPE DEFAULT NULL,
        code_diag_icnp_nin     IN BOOLEAN := TRUE,
        code_interv_in         IN viewer_ehr_ea.code_interv%TYPE DEFAULT NULL,
        code_interv_nin        IN BOOLEAN := TRUE,
        create_user_in         IN viewer_ehr_ea.create_user%TYPE DEFAULT NULL,
        create_user_nin        IN BOOLEAN := TRUE,
        create_time_in         IN viewer_ehr_ea.create_time%TYPE DEFAULT NULL,
        create_time_nin        IN BOOLEAN := TRUE,
        create_institution_in  IN viewer_ehr_ea.create_institution%TYPE DEFAULT NULL,
        create_institution_nin IN BOOLEAN := TRUE,
        update_user_in         IN viewer_ehr_ea.update_user%TYPE DEFAULT NULL,
        update_user_nin        IN BOOLEAN := TRUE,
        update_time_in         IN viewer_ehr_ea.update_time%TYPE DEFAULT NULL,
        update_time_nin        IN BOOLEAN := TRUE,
        update_institution_in  IN viewer_ehr_ea.update_institution%TYPE DEFAULT NULL,
        update_institution_nin IN BOOLEAN := TRUE,
        flg_exclamation_in     IN viewer_ehr_ea.flg_exclamation%TYPE DEFAULT NULL,
        flg_exclamation_nin    IN BOOLEAN := TRUE,
        flg_infective_in       IN viewer_ehr_ea.flg_infective%TYPE DEFAULT NULL,
        flg_infective_nin      IN BOOLEAN := TRUE,
        num_vs_in              IN viewer_ehr_ea.num_vs%TYPE DEFAULT NULL,
        num_vs_nin             IN BOOLEAN := TRUE,
        desc_vs_in             IN viewer_ehr_ea.desc_vs%TYPE DEFAULT NULL,
        desc_vs_nin            IN BOOLEAN := TRUE,
        dt_vs_in               IN viewer_ehr_ea.dt_vs%TYPE DEFAULT NULL,
        dt_vs_nin              IN BOOLEAN := TRUE,
        code_vs_in             IN viewer_ehr_ea.code_vs%TYPE DEFAULT NULL,
        code_vs_nin            IN BOOLEAN := TRUE,
        num_note_in            IN viewer_ehr_ea.num_note%TYPE DEFAULT NULL,
        num_note_nin           IN BOOLEAN := TRUE,
        desc_note_in           IN viewer_ehr_ea.desc_note%TYPE DEFAULT NULL,
        desc_note_nin          IN BOOLEAN := TRUE,
        dt_note_in             IN viewer_ehr_ea.dt_note%TYPE DEFAULT NULL,
        dt_note_nin            IN BOOLEAN := TRUE,
        code_note_in           IN viewer_ehr_ea.code_note%TYPE DEFAULT NULL,
        code_note_nin          IN BOOLEAN := TRUE,
        num_archive_in         IN viewer_ehr_ea.num_archive%TYPE DEFAULT NULL,
        num_archive_nin        IN BOOLEAN := TRUE,
        desc_archive_in        IN viewer_ehr_ea.desc_archive%TYPE DEFAULT NULL,
        desc_archive_nin       IN BOOLEAN := TRUE,
        dt_archive_in          IN viewer_ehr_ea.dt_archive%TYPE DEFAULT NULL,
        dt_archive_nin         IN BOOLEAN := TRUE,
        code_archive_in        IN viewer_ehr_ea.code_archive%TYPE DEFAULT NULL,
        code_archive_nin       IN BOOLEAN := TRUE,
        num_epis_archive_in    IN viewer_ehr_ea.num_epis_archive%TYPE DEFAULT NULL,
        num_epis_archive_nin   IN BOOLEAN := TRUE,
        desc_epis_archive_in   IN viewer_ehr_ea.desc_epis_archive%TYPE DEFAULT NULL,
        desc_epis_archive_nin  IN BOOLEAN := TRUE,
        dt_epis_archive_in     IN viewer_ehr_ea.dt_epis_archive%TYPE DEFAULT NULL,
        dt_epis_archive_nin    IN BOOLEAN := TRUE,
        code_epis_archive_in   IN viewer_ehr_ea.code_epis_archive%TYPE DEFAULT NULL,
        code_epis_archive_nin  IN BOOLEAN := TRUE,
        num_bp_in              IN viewer_ehr_ea.num_bp%TYPE DEFAULT NULL,
        num_bp_nin             IN BOOLEAN := TRUE,
        dt_bp_in               IN viewer_ehr_ea.dt_bp%TYPE DEFAULT NULL,
        dt_bp_nin              IN BOOLEAN := TRUE,
        code_bp_in             IN viewer_ehr_ea.code_bp%TYPE DEFAULT NULL,
        code_bp_nin            IN BOOLEAN := TRUE,
        desc_bp_in             IN viewer_ehr_ea.desc_bp%TYPE DEFAULT NULL,
        desc_bp_nin            IN BOOLEAN := TRUE,
        id_problem_in          IN viewer_ehr_ea.id_problem%TYPE DEFAULT NULL,
        id_problem_nin         IN BOOLEAN := TRUE,
        id_task_type_in        IN viewer_ehr_ea.id_task_type%TYPE DEFAULT NULL,
        id_task_type_nin       IN BOOLEAN := TRUE,
        where_in               IN VARCHAR2,
        handle_error_in        IN BOOLEAN := TRUE
    ) IS
        rows_out table_varchar;
    BEGIN
        upd(num_allergy_in         => num_allergy_in,
            num_allergy_nin        => num_allergy_nin,
            desc_allergy_in        => desc_allergy_in,
            desc_allergy_nin       => desc_allergy_nin,
            dt_allergy_in          => dt_allergy_in,
            dt_allergy_nin         => dt_allergy_nin,
            dt_allergy_fmt_in      => dt_allergy_fmt_in,
            dt_allergy_fmt_nin     => dt_allergy_fmt_nin,
            num_lab_in             => num_lab_in,
            num_lab_nin            => num_lab_nin,
            desc_lab_in            => desc_lab_in,
            desc_lab_nin           => desc_lab_nin,
            dt_lab_in              => dt_lab_in,
            dt_lab_nin             => dt_lab_nin,
            num_diag_icnp_in       => num_diag_icnp_in,
            num_diag_icnp_nin      => num_diag_icnp_nin,
            desc_diag_icnp_in      => desc_diag_icnp_in,
            desc_diag_icnp_nin     => desc_diag_icnp_nin,
            dt_diag_icnp_in        => dt_diag_icnp_in,
            dt_diag_icnp_nin       => dt_diag_icnp_nin,
            num_episode_in         => num_episode_in,
            num_episode_nin        => num_episode_nin,
            desc_episode_in        => desc_episode_in,
            desc_episode_nin       => desc_episode_nin,
            dt_episode_in          => dt_episode_in,
            dt_episode_nin         => dt_episode_nin,
            num_exam_in            => num_exam_in,
            num_exam_nin           => num_exam_nin,
            desc_exam_in           => desc_exam_in,
            desc_exam_nin          => desc_exam_nin,
            dt_exam_in             => dt_exam_in,
            dt_exam_nin            => dt_exam_nin,
            num_med_in             => num_med_in,
            num_med_nin            => num_med_nin,
            desc_med_in            => desc_med_in,
            desc_med_nin           => desc_med_nin,
            dt_med_in              => dt_med_in,
            dt_med_nin             => dt_med_nin,
            num_problem_in         => num_problem_in,
            num_problem_nin        => num_problem_nin,
            desc_problem_in        => desc_problem_in,
            desc_problem_nin       => desc_problem_nin,
            dt_problem_in          => dt_problem_in,
            dt_problem_nin         => dt_problem_nin,
            dt_problem_fmt_in      => dt_problem_fmt_in,
            dt_problem_fmt_nin     => dt_problem_fmt_nin,
            num_interv_in          => num_interv_in,
            num_interv_nin         => num_interv_nin,
            desc_interv_in         => desc_interv_in,
            desc_interv_nin        => desc_interv_nin,
            dt_interv_in           => dt_interv_in,
            dt_interv_nin          => dt_interv_nin,
            dt_dg_last_update_in   => dt_dg_last_update_in,
            dt_dg_last_update_nin  => dt_dg_last_update_nin,
            code_allergy_in        => code_allergy_in,
            code_allergy_nin       => code_allergy_nin,
            code_episode_in        => code_episode_in,
            code_episode_nin       => code_episode_nin,
            code_exam_in           => code_exam_in,
            code_exam_nin          => code_exam_nin,
            code_med_in            => code_med_in,
            code_med_nin           => code_med_nin,
            code_problem_in        => code_problem_in,
            code_problem_nin       => code_problem_nin,
            code_lab_in            => code_lab_in,
            code_lab_nin           => code_lab_nin,
            code_diag_icnp_in      => code_diag_icnp_in,
            code_diag_icnp_nin     => code_diag_icnp_nin,
            code_interv_in         => code_interv_in,
            code_interv_nin        => code_interv_nin,
            create_user_in         => create_user_in,
            create_user_nin        => create_user_nin,
            create_time_in         => create_time_in,
            create_time_nin        => create_time_nin,
            create_institution_in  => create_institution_in,
            create_institution_nin => create_institution_nin,
            update_user_in         => update_user_in,
            update_user_nin        => update_user_nin,
            update_time_in         => update_time_in,
            update_time_nin        => update_time_nin,
            update_institution_in  => update_institution_in,
            update_institution_nin => update_institution_nin,
            flg_exclamation_in     => flg_exclamation_in,
            flg_exclamation_nin    => flg_exclamation_nin,
            flg_infective_in       => flg_infective_in,
            flg_infective_nin      => flg_infective_nin,
            num_vs_in              => num_vs_in,
            num_vs_nin             => num_vs_nin,
            desc_vs_in             => desc_vs_in,
            desc_vs_nin            => desc_vs_nin,
            dt_vs_in               => dt_vs_in,
            dt_vs_nin              => dt_vs_nin,
            code_vs_in             => code_vs_in,
            code_vs_nin            => code_vs_nin,
            num_note_in            => num_note_in,
            num_note_nin           => num_note_nin,
            desc_note_in           => desc_note_in,
            desc_note_nin          => desc_note_nin,
            dt_note_in             => dt_note_in,
            dt_note_nin            => dt_note_nin,
            code_note_in           => code_note_in,
            code_note_nin          => code_note_nin,
            num_archive_in         => num_archive_in,
            num_archive_nin        => num_archive_nin,
            desc_archive_in        => desc_archive_in,
            desc_archive_nin       => desc_archive_nin,
            dt_archive_in          => dt_archive_in,
            dt_archive_nin         => dt_archive_nin,
            code_archive_in        => code_archive_in,
            code_archive_nin       => code_archive_nin,
            num_epis_archive_in    => num_epis_archive_in,
            num_epis_archive_nin   => num_epis_archive_nin,
            desc_epis_archive_in   => desc_epis_archive_in,
            desc_epis_archive_nin  => desc_epis_archive_nin,
            dt_epis_archive_in     => dt_epis_archive_in,
            dt_epis_archive_nin    => dt_epis_archive_nin,
            code_epis_archive_in   => code_epis_archive_in,
            code_epis_archive_nin  => code_epis_archive_nin,
            num_bp_in              => num_bp_in,
            num_bp_nin             => num_bp_nin,
            dt_bp_in               => dt_bp_in,
            dt_bp_nin              => dt_bp_nin,
            code_bp_in             => code_bp_in,
            code_bp_nin            => code_bp_nin,
            desc_bp_in             => desc_bp_in,
            desc_bp_nin            => desc_bp_nin,
            id_problem_in          => id_problem_in,
            id_problem_nin         => id_problem_nin,
            id_task_type_in        => id_task_type_in,
            id_task_type_nin       => id_task_type_nin,
            where_in               => where_in,
            handle_error_in        => handle_error_in,
            rows_out               => rows_out);
    END upd;

    --Update/insert columns (with rows_out)
    PROCEDURE upd_ins
    (
        id_patient_in         IN viewer_ehr_ea.id_patient%TYPE,
        num_allergy_in        IN viewer_ehr_ea.num_allergy%TYPE DEFAULT NULL,
        desc_allergy_in       IN viewer_ehr_ea.desc_allergy%TYPE DEFAULT NULL,
        dt_allergy_in         IN viewer_ehr_ea.dt_allergy%TYPE DEFAULT NULL,
        dt_allergy_fmt_in     IN viewer_ehr_ea.dt_allergy_fmt%TYPE DEFAULT NULL,
        num_lab_in            IN viewer_ehr_ea.num_lab%TYPE DEFAULT NULL,
        desc_lab_in           IN viewer_ehr_ea.desc_lab%TYPE DEFAULT NULL,
        dt_lab_in             IN viewer_ehr_ea.dt_lab%TYPE DEFAULT NULL,
        num_diag_icnp_in      IN viewer_ehr_ea.num_diag_icnp%TYPE DEFAULT NULL,
        desc_diag_icnp_in     IN viewer_ehr_ea.desc_diag_icnp%TYPE DEFAULT NULL,
        dt_diag_icnp_in       IN viewer_ehr_ea.dt_diag_icnp%TYPE DEFAULT NULL,
        num_episode_in        IN viewer_ehr_ea.num_episode%TYPE DEFAULT NULL,
        desc_episode_in       IN viewer_ehr_ea.desc_episode%TYPE DEFAULT NULL,
        dt_episode_in         IN viewer_ehr_ea.dt_episode%TYPE DEFAULT NULL,
        num_exam_in           IN viewer_ehr_ea.num_exam%TYPE DEFAULT NULL,
        desc_exam_in          IN viewer_ehr_ea.desc_exam%TYPE DEFAULT NULL,
        dt_exam_in            IN viewer_ehr_ea.dt_exam%TYPE DEFAULT NULL,
        num_med_in            IN viewer_ehr_ea.num_med%TYPE DEFAULT NULL,
        desc_med_in           IN viewer_ehr_ea.desc_med%TYPE DEFAULT NULL,
        dt_med_in             IN viewer_ehr_ea.dt_med%TYPE DEFAULT NULL,
        num_problem_in        IN viewer_ehr_ea.num_problem%TYPE DEFAULT NULL,
        desc_problem_in       IN viewer_ehr_ea.desc_problem%TYPE DEFAULT NULL,
        dt_problem_in         IN viewer_ehr_ea.dt_problem%TYPE DEFAULT NULL,
        dt_problem_fmt_in     IN viewer_ehr_ea.dt_problem_fmt%TYPE DEFAULT NULL,
        num_interv_in         IN viewer_ehr_ea.num_interv%TYPE DEFAULT NULL,
        desc_interv_in        IN viewer_ehr_ea.desc_interv%TYPE DEFAULT NULL,
        dt_interv_in          IN viewer_ehr_ea.dt_interv%TYPE DEFAULT NULL,
        dt_dg_last_update_in  IN viewer_ehr_ea.dt_dg_last_update%TYPE DEFAULT NULL,
        code_allergy_in       IN viewer_ehr_ea.code_allergy%TYPE DEFAULT NULL,
        code_episode_in       IN viewer_ehr_ea.code_episode%TYPE DEFAULT NULL,
        code_exam_in          IN viewer_ehr_ea.code_exam%TYPE DEFAULT NULL,
        code_med_in           IN viewer_ehr_ea.code_med%TYPE DEFAULT NULL,
        code_problem_in       IN viewer_ehr_ea.code_problem%TYPE DEFAULT NULL,
        code_lab_in           IN viewer_ehr_ea.code_lab%TYPE DEFAULT NULL,
        code_diag_icnp_in     IN viewer_ehr_ea.code_diag_icnp%TYPE DEFAULT NULL,
        code_interv_in        IN viewer_ehr_ea.code_interv%TYPE DEFAULT NULL,
        create_user_in        IN viewer_ehr_ea.create_user%TYPE DEFAULT NULL,
        create_time_in        IN viewer_ehr_ea.create_time%TYPE DEFAULT NULL,
        create_institution_in IN viewer_ehr_ea.create_institution%TYPE DEFAULT NULL,
        update_user_in        IN viewer_ehr_ea.update_user%TYPE DEFAULT NULL,
        update_time_in        IN viewer_ehr_ea.update_time%TYPE DEFAULT NULL,
        update_institution_in IN viewer_ehr_ea.update_institution%TYPE DEFAULT NULL,
        flg_exclamation_in    IN viewer_ehr_ea.flg_exclamation%TYPE DEFAULT NULL,
        flg_infective_in      IN viewer_ehr_ea.flg_infective%TYPE DEFAULT NULL,
        num_vs_in             IN viewer_ehr_ea.num_vs%TYPE DEFAULT NULL,
        desc_vs_in            IN viewer_ehr_ea.desc_vs%TYPE DEFAULT NULL,
        dt_vs_in              IN viewer_ehr_ea.dt_vs%TYPE DEFAULT NULL,
        code_vs_in            IN viewer_ehr_ea.code_vs%TYPE DEFAULT NULL,
        num_note_in           IN viewer_ehr_ea.num_note%TYPE DEFAULT NULL,
        desc_note_in          IN viewer_ehr_ea.desc_note%TYPE DEFAULT NULL,
        dt_note_in            IN viewer_ehr_ea.dt_note%TYPE DEFAULT NULL,
        code_note_in          IN viewer_ehr_ea.code_note%TYPE DEFAULT NULL,
        num_archive_in        IN viewer_ehr_ea.num_archive%TYPE DEFAULT NULL,
        desc_archive_in       IN viewer_ehr_ea.desc_archive%TYPE DEFAULT NULL,
        dt_archive_in         IN viewer_ehr_ea.dt_archive%TYPE DEFAULT NULL,
        code_archive_in       IN viewer_ehr_ea.code_archive%TYPE DEFAULT NULL,
        num_epis_archive_in   IN viewer_ehr_ea.num_epis_archive%TYPE DEFAULT NULL,
        desc_epis_archive_in  IN viewer_ehr_ea.desc_epis_archive%TYPE DEFAULT NULL,
        dt_epis_archive_in    IN viewer_ehr_ea.dt_epis_archive%TYPE DEFAULT NULL,
        code_epis_archive_in  IN viewer_ehr_ea.code_epis_archive%TYPE DEFAULT NULL,
        num_bp_in             IN viewer_ehr_ea.num_bp%TYPE DEFAULT NULL,
        dt_bp_in              IN viewer_ehr_ea.dt_bp%TYPE DEFAULT NULL,
        code_bp_in            IN viewer_ehr_ea.code_bp%TYPE DEFAULT NULL,
        desc_bp_in            IN viewer_ehr_ea.desc_bp%TYPE DEFAULT NULL,
        id_problem_in         IN viewer_ehr_ea.id_problem%TYPE DEFAULT NULL,
        id_task_type_in       IN viewer_ehr_ea.id_task_type%TYPE DEFAULT NULL,
        handle_error_in       IN BOOLEAN := TRUE,
        rows_out              IN OUT table_varchar
    ) IS
    BEGIN
        upd(id_patient_in         => id_patient_in,
            num_allergy_in        => num_allergy_in,
            desc_allergy_in       => desc_allergy_in,
            dt_allergy_in         => dt_allergy_in,
            dt_allergy_fmt_in     => dt_allergy_fmt_in,
            num_lab_in            => num_lab_in,
            desc_lab_in           => desc_lab_in,
            dt_lab_in             => dt_lab_in,
            num_diag_icnp_in      => num_diag_icnp_in,
            desc_diag_icnp_in     => desc_diag_icnp_in,
            dt_diag_icnp_in       => dt_diag_icnp_in,
            num_episode_in        => num_episode_in,
            desc_episode_in       => desc_episode_in,
            dt_episode_in         => dt_episode_in,
            num_exam_in           => num_exam_in,
            desc_exam_in          => desc_exam_in,
            dt_exam_in            => dt_exam_in,
            num_med_in            => num_med_in,
            desc_med_in           => desc_med_in,
            dt_med_in             => dt_med_in,
            num_problem_in        => num_problem_in,
            desc_problem_in       => desc_problem_in,
            dt_problem_in         => dt_problem_in,
            dt_problem_fmt_in     => dt_problem_fmt_in,
            num_interv_in         => num_interv_in,
            desc_interv_in        => desc_interv_in,
            dt_interv_in          => dt_interv_in,
            dt_dg_last_update_in  => dt_dg_last_update_in,
            code_allergy_in       => code_allergy_in,
            code_episode_in       => code_episode_in,
            code_exam_in          => code_exam_in,
            code_med_in           => code_med_in,
            code_problem_in       => code_problem_in,
            code_lab_in           => code_lab_in,
            code_diag_icnp_in     => code_diag_icnp_in,
            code_interv_in        => code_interv_in,
            create_user_in        => create_user_in,
            create_time_in        => create_time_in,
            create_institution_in => create_institution_in,
            update_user_in        => update_user_in,
            update_time_in        => update_time_in,
            update_institution_in => update_institution_in,
            flg_exclamation_in    => flg_exclamation_in,
            flg_infective_in      => flg_infective_in,
            num_vs_in             => num_vs_in,
            desc_vs_in            => desc_vs_in,
            dt_vs_in              => dt_vs_in,
            code_vs_in            => code_vs_in,
            num_note_in           => num_note_in,
            desc_note_in          => desc_note_in,
            dt_note_in            => dt_note_in,
            code_note_in          => code_note_in,
            num_archive_in        => num_archive_in,
            desc_archive_in       => desc_archive_in,
            dt_archive_in         => dt_archive_in,
            code_archive_in       => code_archive_in,
            num_epis_archive_in   => num_epis_archive_in,
            desc_epis_archive_in  => desc_epis_archive_in,
            dt_epis_archive_in    => dt_epis_archive_in,
            code_epis_archive_in  => code_epis_archive_in,
            num_bp_in             => num_bp_in,
            dt_bp_in              => dt_bp_in,
            code_bp_in            => code_bp_in,
            desc_bp_in            => desc_bp_in,
            id_problem_in         => id_problem_in,
            id_task_type_in       => id_task_type_in,
            handle_error_in       => handle_error_in,
            rows_out              => rows_out);
        IF SQL%ROWCOUNT = 0
        THEN
            ins(id_patient_in         => id_patient_in,
                num_allergy_in        => num_allergy_in,
                desc_allergy_in       => desc_allergy_in,
                dt_allergy_in         => dt_allergy_in,
                dt_allergy_fmt_in     => dt_allergy_fmt_in,
                num_lab_in            => num_lab_in,
                desc_lab_in           => desc_lab_in,
                dt_lab_in             => dt_lab_in,
                num_diag_icnp_in      => num_diag_icnp_in,
                desc_diag_icnp_in     => desc_diag_icnp_in,
                dt_diag_icnp_in       => dt_diag_icnp_in,
                num_episode_in        => num_episode_in,
                desc_episode_in       => desc_episode_in,
                dt_episode_in         => dt_episode_in,
                num_exam_in           => num_exam_in,
                desc_exam_in          => desc_exam_in,
                dt_exam_in            => dt_exam_in,
                num_med_in            => num_med_in,
                desc_med_in           => desc_med_in,
                dt_med_in             => dt_med_in,
                num_problem_in        => num_problem_in,
                desc_problem_in       => desc_problem_in,
                dt_problem_in         => dt_problem_in,
                dt_problem_fmt_in     => dt_problem_fmt_in,
                num_interv_in         => num_interv_in,
                desc_interv_in        => desc_interv_in,
                dt_interv_in          => dt_interv_in,
                dt_dg_last_update_in  => dt_dg_last_update_in,
                code_allergy_in       => code_allergy_in,
                code_episode_in       => code_episode_in,
                code_exam_in          => code_exam_in,
                code_med_in           => code_med_in,
                code_problem_in       => code_problem_in,
                code_lab_in           => code_lab_in,
                code_diag_icnp_in     => code_diag_icnp_in,
                code_interv_in        => code_interv_in,
                create_user_in        => create_user_in,
                create_time_in        => create_time_in,
                create_institution_in => create_institution_in,
                update_user_in        => update_user_in,
                update_time_in        => update_time_in,
                update_institution_in => update_institution_in,
                flg_exclamation_in    => flg_exclamation_in,
                flg_infective_in      => flg_infective_in,
                num_vs_in             => num_vs_in,
                desc_vs_in            => desc_vs_in,
                dt_vs_in              => dt_vs_in,
                code_vs_in            => code_vs_in,
                num_note_in           => num_note_in,
                desc_note_in          => desc_note_in,
                dt_note_in            => dt_note_in,
                code_note_in          => code_note_in,
                num_archive_in        => num_archive_in,
                desc_archive_in       => desc_archive_in,
                dt_archive_in         => dt_archive_in,
                code_archive_in       => code_archive_in,
                num_epis_archive_in   => num_epis_archive_in,
                desc_epis_archive_in  => desc_epis_archive_in,
                dt_epis_archive_in    => dt_epis_archive_in,
                code_epis_archive_in  => code_epis_archive_in,
                num_bp_in             => num_bp_in,
                dt_bp_in              => dt_bp_in,
                code_bp_in            => code_bp_in,
                desc_bp_in            => desc_bp_in,
                id_problem_in         => id_problem_in,
                id_task_type_in       => id_task_type_in,
                handle_error_in       => handle_error_in,
                rows_out              => rows_out);
        END IF;
    END upd_ins;

    --Update/insert columns (without rows_out)
    PROCEDURE upd_ins
    (
        id_patient_in         IN viewer_ehr_ea.id_patient%TYPE,
        num_allergy_in        IN viewer_ehr_ea.num_allergy%TYPE DEFAULT NULL,
        desc_allergy_in       IN viewer_ehr_ea.desc_allergy%TYPE DEFAULT NULL,
        dt_allergy_in         IN viewer_ehr_ea.dt_allergy%TYPE DEFAULT NULL,
        dt_allergy_fmt_in     IN viewer_ehr_ea.dt_allergy_fmt%TYPE DEFAULT NULL,
        num_lab_in            IN viewer_ehr_ea.num_lab%TYPE DEFAULT NULL,
        desc_lab_in           IN viewer_ehr_ea.desc_lab%TYPE DEFAULT NULL,
        dt_lab_in             IN viewer_ehr_ea.dt_lab%TYPE DEFAULT NULL,
        num_diag_icnp_in      IN viewer_ehr_ea.num_diag_icnp%TYPE DEFAULT NULL,
        desc_diag_icnp_in     IN viewer_ehr_ea.desc_diag_icnp%TYPE DEFAULT NULL,
        dt_diag_icnp_in       IN viewer_ehr_ea.dt_diag_icnp%TYPE DEFAULT NULL,
        num_episode_in        IN viewer_ehr_ea.num_episode%TYPE DEFAULT NULL,
        desc_episode_in       IN viewer_ehr_ea.desc_episode%TYPE DEFAULT NULL,
        dt_episode_in         IN viewer_ehr_ea.dt_episode%TYPE DEFAULT NULL,
        num_exam_in           IN viewer_ehr_ea.num_exam%TYPE DEFAULT NULL,
        desc_exam_in          IN viewer_ehr_ea.desc_exam%TYPE DEFAULT NULL,
        dt_exam_in            IN viewer_ehr_ea.dt_exam%TYPE DEFAULT NULL,
        num_med_in            IN viewer_ehr_ea.num_med%TYPE DEFAULT NULL,
        desc_med_in           IN viewer_ehr_ea.desc_med%TYPE DEFAULT NULL,
        dt_med_in             IN viewer_ehr_ea.dt_med%TYPE DEFAULT NULL,
        num_problem_in        IN viewer_ehr_ea.num_problem%TYPE DEFAULT NULL,
        desc_problem_in       IN viewer_ehr_ea.desc_problem%TYPE DEFAULT NULL,
        dt_problem_in         IN viewer_ehr_ea.dt_problem%TYPE DEFAULT NULL,
        dt_problem_fmt_in     IN viewer_ehr_ea.dt_problem_fmt%TYPE DEFAULT NULL,
        num_interv_in         IN viewer_ehr_ea.num_interv%TYPE DEFAULT NULL,
        desc_interv_in        IN viewer_ehr_ea.desc_interv%TYPE DEFAULT NULL,
        dt_interv_in          IN viewer_ehr_ea.dt_interv%TYPE DEFAULT NULL,
        dt_dg_last_update_in  IN viewer_ehr_ea.dt_dg_last_update%TYPE DEFAULT NULL,
        code_allergy_in       IN viewer_ehr_ea.code_allergy%TYPE DEFAULT NULL,
        code_episode_in       IN viewer_ehr_ea.code_episode%TYPE DEFAULT NULL,
        code_exam_in          IN viewer_ehr_ea.code_exam%TYPE DEFAULT NULL,
        code_med_in           IN viewer_ehr_ea.code_med%TYPE DEFAULT NULL,
        code_problem_in       IN viewer_ehr_ea.code_problem%TYPE DEFAULT NULL,
        code_lab_in           IN viewer_ehr_ea.code_lab%TYPE DEFAULT NULL,
        code_diag_icnp_in     IN viewer_ehr_ea.code_diag_icnp%TYPE DEFAULT NULL,
        code_interv_in        IN viewer_ehr_ea.code_interv%TYPE DEFAULT NULL,
        create_user_in        IN viewer_ehr_ea.create_user%TYPE DEFAULT NULL,
        create_time_in        IN viewer_ehr_ea.create_time%TYPE DEFAULT NULL,
        create_institution_in IN viewer_ehr_ea.create_institution%TYPE DEFAULT NULL,
        update_user_in        IN viewer_ehr_ea.update_user%TYPE DEFAULT NULL,
        update_time_in        IN viewer_ehr_ea.update_time%TYPE DEFAULT NULL,
        update_institution_in IN viewer_ehr_ea.update_institution%TYPE DEFAULT NULL,
        flg_exclamation_in    IN viewer_ehr_ea.flg_exclamation%TYPE DEFAULT NULL,
        flg_infective_in      IN viewer_ehr_ea.flg_infective%TYPE DEFAULT NULL,
        num_vs_in             IN viewer_ehr_ea.num_vs%TYPE DEFAULT NULL,
        desc_vs_in            IN viewer_ehr_ea.desc_vs%TYPE DEFAULT NULL,
        dt_vs_in              IN viewer_ehr_ea.dt_vs%TYPE DEFAULT NULL,
        code_vs_in            IN viewer_ehr_ea.code_vs%TYPE DEFAULT NULL,
        num_note_in           IN viewer_ehr_ea.num_note%TYPE DEFAULT NULL,
        desc_note_in          IN viewer_ehr_ea.desc_note%TYPE DEFAULT NULL,
        dt_note_in            IN viewer_ehr_ea.dt_note%TYPE DEFAULT NULL,
        code_note_in          IN viewer_ehr_ea.code_note%TYPE DEFAULT NULL,
        num_archive_in        IN viewer_ehr_ea.num_archive%TYPE DEFAULT NULL,
        desc_archive_in       IN viewer_ehr_ea.desc_archive%TYPE DEFAULT NULL,
        dt_archive_in         IN viewer_ehr_ea.dt_archive%TYPE DEFAULT NULL,
        code_archive_in       IN viewer_ehr_ea.code_archive%TYPE DEFAULT NULL,
        num_epis_archive_in   IN viewer_ehr_ea.num_epis_archive%TYPE DEFAULT NULL,
        desc_epis_archive_in  IN viewer_ehr_ea.desc_epis_archive%TYPE DEFAULT NULL,
        dt_epis_archive_in    IN viewer_ehr_ea.dt_epis_archive%TYPE DEFAULT NULL,
        code_epis_archive_in  IN viewer_ehr_ea.code_epis_archive%TYPE DEFAULT NULL,
        num_bp_in             IN viewer_ehr_ea.num_bp%TYPE DEFAULT NULL,
        dt_bp_in              IN viewer_ehr_ea.dt_bp%TYPE DEFAULT NULL,
        code_bp_in            IN viewer_ehr_ea.code_bp%TYPE DEFAULT NULL,
        desc_bp_in            IN viewer_ehr_ea.desc_bp%TYPE DEFAULT NULL,
        id_problem_in         IN viewer_ehr_ea.id_problem%TYPE DEFAULT NULL,
        id_task_type_in       IN viewer_ehr_ea.id_task_type%TYPE DEFAULT NULL,
        handle_error_in       IN BOOLEAN := TRUE
    ) IS
        rows_out table_varchar;
    BEGIN
        upd_ins(id_patient_in,
                num_allergy_in,
                desc_allergy_in,
                dt_allergy_in,
                dt_allergy_fmt_in,
                num_lab_in,
                desc_lab_in,
                dt_lab_in,
                num_diag_icnp_in,
                desc_diag_icnp_in,
                dt_diag_icnp_in,
                num_episode_in,
                desc_episode_in,
                dt_episode_in,
                num_exam_in,
                desc_exam_in,
                dt_exam_in,
                num_med_in,
                desc_med_in,
                dt_med_in,
                num_problem_in,
                desc_problem_in,
                dt_problem_in,
                dt_problem_fmt_in,
                num_interv_in,
                desc_interv_in,
                dt_interv_in,
                dt_dg_last_update_in,
                code_allergy_in,
                code_episode_in,
                code_exam_in,
                code_med_in,
                code_problem_in,
                code_lab_in,
                code_diag_icnp_in,
                code_interv_in,
                create_user_in,
                create_time_in,
                create_institution_in,
                update_user_in,
                update_time_in,
                update_institution_in,
                flg_exclamation_in,
                flg_infective_in,
                num_vs_in,
                desc_vs_in,
                dt_vs_in,
                code_vs_in,
                num_note_in,
                desc_note_in,
                dt_note_in,
                code_note_in,
                num_archive_in,
                desc_archive_in,
                dt_archive_in,
                code_archive_in,
                num_epis_archive_in,
                desc_epis_archive_in,
                dt_epis_archive_in,
                code_epis_archive_in,
                num_bp_in,
                dt_bp_in,
                code_bp_in,
                desc_bp_in,
                id_problem_in,
                id_task_type_in,
                handle_error_in,
                rows_out);
    END upd_ins;

    --Update by record (with rows_out)
    PROCEDURE upd
    (
        rec_in          IN viewer_ehr_ea%ROWTYPE,
        handle_error_in IN BOOLEAN := TRUE,
        rows_out        IN OUT table_varchar
    ) IS
    BEGIN
        upd(id_patient_in         => rec_in.id_patient,
            num_allergy_in        => rec_in.num_allergy,
            desc_allergy_in       => rec_in.desc_allergy,
            dt_allergy_in         => rec_in.dt_allergy,
            dt_allergy_fmt_in     => rec_in.dt_allergy_fmt,
            num_lab_in            => rec_in.num_lab,
            desc_lab_in           => rec_in.desc_lab,
            dt_lab_in             => rec_in.dt_lab,
            num_diag_icnp_in      => rec_in.num_diag_icnp,
            desc_diag_icnp_in     => rec_in.desc_diag_icnp,
            dt_diag_icnp_in       => rec_in.dt_diag_icnp,
            num_episode_in        => rec_in.num_episode,
            desc_episode_in       => rec_in.desc_episode,
            dt_episode_in         => rec_in.dt_episode,
            num_exam_in           => rec_in.num_exam,
            desc_exam_in          => rec_in.desc_exam,
            dt_exam_in            => rec_in.dt_exam,
            num_med_in            => rec_in.num_med,
            desc_med_in           => rec_in.desc_med,
            dt_med_in             => rec_in.dt_med,
            num_problem_in        => rec_in.num_problem,
            desc_problem_in       => rec_in.desc_problem,
            dt_problem_in         => rec_in.dt_problem,
            dt_problem_fmt_in     => rec_in.dt_problem_fmt,
            num_interv_in         => rec_in.num_interv,
            desc_interv_in        => rec_in.desc_interv,
            dt_interv_in          => rec_in.dt_interv,
            dt_dg_last_update_in  => rec_in.dt_dg_last_update,
            code_allergy_in       => rec_in.code_allergy,
            code_episode_in       => rec_in.code_episode,
            code_exam_in          => rec_in.code_exam,
            code_med_in           => rec_in.code_med,
            code_problem_in       => rec_in.code_problem,
            code_lab_in           => rec_in.code_lab,
            code_diag_icnp_in     => rec_in.code_diag_icnp,
            code_interv_in        => rec_in.code_interv,
            create_user_in        => rec_in.create_user,
            create_time_in        => rec_in.create_time,
            create_institution_in => rec_in.create_institution,
            update_user_in        => rec_in.update_user,
            update_time_in        => rec_in.update_time,
            update_institution_in => rec_in.update_institution,
            flg_exclamation_in    => rec_in.flg_exclamation,
            flg_infective_in      => rec_in.flg_infective,
            num_vs_in             => rec_in.num_vs,
            desc_vs_in            => rec_in.desc_vs,
            dt_vs_in              => rec_in.dt_vs,
            code_vs_in            => rec_in.code_vs,
            num_note_in           => rec_in.num_note,
            desc_note_in          => rec_in.desc_note,
            dt_note_in            => rec_in.dt_note,
            code_note_in          => rec_in.code_note,
            num_archive_in        => rec_in.num_archive,
            desc_archive_in       => rec_in.desc_archive,
            dt_archive_in         => rec_in.dt_archive,
            code_archive_in       => rec_in.code_archive,
            num_epis_archive_in   => rec_in.num_epis_archive,
            desc_epis_archive_in  => rec_in.desc_epis_archive,
            dt_epis_archive_in    => rec_in.dt_epis_archive,
            code_epis_archive_in  => rec_in.code_epis_archive,
            num_bp_in             => rec_in.num_bp,
            dt_bp_in              => rec_in.dt_bp,
            code_bp_in            => rec_in.code_bp,
            desc_bp_in            => rec_in.desc_bp,
            id_problem_in         => rec_in.id_problem,
            id_task_type_in       => rec_in.id_task_type,
            handle_error_in       => handle_error_in,
            rows_out              => rows_out);
    END upd;

    --Update by record (without rows_out)
    PROCEDURE upd
    (
        rec_in          IN viewer_ehr_ea%ROWTYPE,
        handle_error_in IN BOOLEAN := TRUE
    ) IS
        rows_out table_varchar;
    BEGIN
        upd(id_patient_in         => rec_in.id_patient,
            num_allergy_in        => rec_in.num_allergy,
            desc_allergy_in       => rec_in.desc_allergy,
            dt_allergy_in         => rec_in.dt_allergy,
            dt_allergy_fmt_in     => rec_in.dt_allergy_fmt,
            num_lab_in            => rec_in.num_lab,
            desc_lab_in           => rec_in.desc_lab,
            dt_lab_in             => rec_in.dt_lab,
            num_diag_icnp_in      => rec_in.num_diag_icnp,
            desc_diag_icnp_in     => rec_in.desc_diag_icnp,
            dt_diag_icnp_in       => rec_in.dt_diag_icnp,
            num_episode_in        => rec_in.num_episode,
            desc_episode_in       => rec_in.desc_episode,
            dt_episode_in         => rec_in.dt_episode,
            num_exam_in           => rec_in.num_exam,
            desc_exam_in          => rec_in.desc_exam,
            dt_exam_in            => rec_in.dt_exam,
            num_med_in            => rec_in.num_med,
            desc_med_in           => rec_in.desc_med,
            dt_med_in             => rec_in.dt_med,
            num_problem_in        => rec_in.num_problem,
            desc_problem_in       => rec_in.desc_problem,
            dt_problem_in         => rec_in.dt_problem,
            dt_problem_fmt_in     => rec_in.dt_problem_fmt,
            num_interv_in         => rec_in.num_interv,
            desc_interv_in        => rec_in.desc_interv,
            dt_interv_in          => rec_in.dt_interv,
            dt_dg_last_update_in  => rec_in.dt_dg_last_update,
            code_allergy_in       => rec_in.code_allergy,
            code_episode_in       => rec_in.code_episode,
            code_exam_in          => rec_in.code_exam,
            code_med_in           => rec_in.code_med,
            code_problem_in       => rec_in.code_problem,
            code_lab_in           => rec_in.code_lab,
            code_diag_icnp_in     => rec_in.code_diag_icnp,
            code_interv_in        => rec_in.code_interv,
            create_user_in        => rec_in.create_user,
            create_time_in        => rec_in.create_time,
            create_institution_in => rec_in.create_institution,
            update_user_in        => rec_in.update_user,
            update_time_in        => rec_in.update_time,
            update_institution_in => rec_in.update_institution,
            flg_exclamation_in    => rec_in.flg_exclamation,
            flg_infective_in      => rec_in.flg_infective,
            num_vs_in             => rec_in.num_vs,
            desc_vs_in            => rec_in.desc_vs,
            dt_vs_in              => rec_in.dt_vs,
            code_vs_in            => rec_in.code_vs,
            num_note_in           => rec_in.num_note,
            desc_note_in          => rec_in.desc_note,
            dt_note_in            => rec_in.dt_note,
            code_note_in          => rec_in.code_note,
            num_archive_in        => rec_in.num_archive,
            desc_archive_in       => rec_in.desc_archive,
            dt_archive_in         => rec_in.dt_archive,
            code_archive_in       => rec_in.code_archive,
            num_epis_archive_in   => rec_in.num_epis_archive,
            desc_epis_archive_in  => rec_in.desc_epis_archive,
            dt_epis_archive_in    => rec_in.dt_epis_archive,
            code_epis_archive_in  => rec_in.code_epis_archive,
            num_bp_in             => rec_in.num_bp,
            dt_bp_in              => rec_in.dt_bp,
            code_bp_in            => rec_in.code_bp,
            desc_bp_in            => rec_in.desc_bp,
            id_problem_in         => rec_in.id_problem,
            id_task_type_in       => rec_in.id_task_type,
            handle_error_in       => handle_error_in,
            rows_out              => rows_out);
    END upd;

    --Update with collection (with rows_out)
    PROCEDURE upd
    (
        col_in            IN viewer_ehr_ea_tc,
        ignore_if_null_in IN BOOLEAN := TRUE,
        handle_error_in   IN BOOLEAN := TRUE,
        rows_out          IN OUT table_varchar
    ) IS
        l_id_patient         id_patient_cc;
        l_num_allergy        num_allergy_cc;
        l_desc_allergy       desc_allergy_cc;
        l_dt_allergy         dt_allergy_cc;
        l_dt_allergy_fmt     dt_allergy_fmt_cc;
        l_num_lab            num_lab_cc;
        l_desc_lab           desc_lab_cc;
        l_dt_lab             dt_lab_cc;
        l_num_diag_icnp      num_diag_icnp_cc;
        l_desc_diag_icnp     desc_diag_icnp_cc;
        l_dt_diag_icnp       dt_diag_icnp_cc;
        l_num_episode        num_episode_cc;
        l_desc_episode       desc_episode_cc;
        l_dt_episode         dt_episode_cc;
        l_num_exam           num_exam_cc;
        l_desc_exam          desc_exam_cc;
        l_dt_exam            dt_exam_cc;
        l_num_med            num_med_cc;
        l_desc_med           desc_med_cc;
        l_dt_med             dt_med_cc;
        l_num_problem        num_problem_cc;
        l_desc_problem       desc_problem_cc;
        l_dt_problem         dt_problem_cc;
        l_dt_problem_fmt     dt_problem_fmt_cc;
        l_num_interv         num_interv_cc;
        l_desc_interv        desc_interv_cc;
        l_dt_interv          dt_interv_cc;
        l_dt_dg_last_update  dt_dg_last_update_cc;
        l_code_allergy       code_allergy_cc;
        l_code_episode       code_episode_cc;
        l_code_exam          code_exam_cc;
        l_code_med           code_med_cc;
        l_code_problem       code_problem_cc;
        l_code_lab           code_lab_cc;
        l_code_diag_icnp     code_diag_icnp_cc;
        l_code_interv        code_interv_cc;
        l_create_user        create_user_cc;
        l_create_time        create_time_cc;
        l_create_institution create_institution_cc;
        l_update_user        update_user_cc;
        l_update_time        update_time_cc;
        l_update_institution update_institution_cc;
        l_flg_exclamation    flg_exclamation_cc;
        l_flg_infective      flg_infective_cc;
        l_num_vs             num_vs_cc;
        l_desc_vs            desc_vs_cc;
        l_dt_vs              dt_vs_cc;
        l_code_vs            code_vs_cc;
        l_num_note           num_note_cc;
        l_desc_note          desc_note_cc;
        l_dt_note            dt_note_cc;
        l_code_note          code_note_cc;
        l_num_archive        num_archive_cc;
        l_desc_archive       desc_archive_cc;
        l_dt_archive         dt_archive_cc;
        l_code_archive       code_archive_cc;
        l_num_epis_archive   num_epis_archive_cc;
        l_desc_epis_archive  desc_epis_archive_cc;
        l_dt_epis_archive    dt_epis_archive_cc;
        l_code_epis_archive  code_epis_archive_cc;
        l_num_bp             num_bp_cc;
        l_dt_bp              dt_bp_cc;
        l_code_bp            code_bp_cc;
        l_desc_bp            desc_bp_cc;
        l_id_problem         id_problem_cc;
        l_id_task_type       id_task_type_cc;
    BEGIN
        FOR i IN col_in.first .. col_in.last
        LOOP
            l_id_patient(i) := col_in(i).id_patient;
            l_num_allergy(i) := col_in(i).num_allergy;
            l_desc_allergy(i) := col_in(i).desc_allergy;
            l_dt_allergy(i) := col_in(i).dt_allergy;
            l_dt_allergy_fmt(i) := col_in(i).dt_allergy_fmt;
            l_num_lab(i) := col_in(i).num_lab;
            l_desc_lab(i) := col_in(i).desc_lab;
            l_dt_lab(i) := col_in(i).dt_lab;
            l_num_diag_icnp(i) := col_in(i).num_diag_icnp;
            l_desc_diag_icnp(i) := col_in(i).desc_diag_icnp;
            l_dt_diag_icnp(i) := col_in(i).dt_diag_icnp;
            l_num_episode(i) := col_in(i).num_episode;
            l_desc_episode(i) := col_in(i).desc_episode;
            l_dt_episode(i) := col_in(i).dt_episode;
            l_num_exam(i) := col_in(i).num_exam;
            l_desc_exam(i) := col_in(i).desc_exam;
            l_dt_exam(i) := col_in(i).dt_exam;
            l_num_med(i) := col_in(i).num_med;
            l_desc_med(i) := col_in(i).desc_med;
            l_dt_med(i) := col_in(i).dt_med;
            l_num_problem(i) := col_in(i).num_problem;
            l_desc_problem(i) := col_in(i).desc_problem;
            l_dt_problem(i) := col_in(i).dt_problem;
            l_dt_problem_fmt(i) := col_in(i).dt_problem_fmt;
            l_num_interv(i) := col_in(i).num_interv;
            l_desc_interv(i) := col_in(i).desc_interv;
            l_dt_interv(i) := col_in(i).dt_interv;
            l_dt_dg_last_update(i) := col_in(i).dt_dg_last_update;
            l_code_allergy(i) := col_in(i).code_allergy;
            l_code_episode(i) := col_in(i).code_episode;
            l_code_exam(i) := col_in(i).code_exam;
            l_code_med(i) := col_in(i).code_med;
            l_code_problem(i) := col_in(i).code_problem;
            l_code_lab(i) := col_in(i).code_lab;
            l_code_diag_icnp(i) := col_in(i).code_diag_icnp;
            l_code_interv(i) := col_in(i).code_interv;
            l_create_user(i) := col_in(i).create_user;
            l_create_time(i) := col_in(i).create_time;
            l_create_institution(i) := col_in(i).create_institution;
            l_update_user(i) := col_in(i).update_user;
            l_update_time(i) := col_in(i).update_time;
            l_update_institution(i) := col_in(i).update_institution;
            l_flg_exclamation(i) := col_in(i).flg_exclamation;
            l_flg_infective(i) := col_in(i).flg_infective;
            l_num_vs(i) := col_in(i).num_vs;
            l_desc_vs(i) := col_in(i).desc_vs;
            l_dt_vs(i) := col_in(i).dt_vs;
            l_code_vs(i) := col_in(i).code_vs;
            l_num_note(i) := col_in(i).num_note;
            l_desc_note(i) := col_in(i).desc_note;
            l_dt_note(i) := col_in(i).dt_note;
            l_code_note(i) := col_in(i).code_note;
            l_num_archive(i) := col_in(i).num_archive;
            l_desc_archive(i) := col_in(i).desc_archive;
            l_dt_archive(i) := col_in(i).dt_archive;
            l_code_archive(i) := col_in(i).code_archive;
            l_num_epis_archive(i) := col_in(i).num_epis_archive;
            l_desc_epis_archive(i) := col_in(i).desc_epis_archive;
            l_dt_epis_archive(i) := col_in(i).dt_epis_archive;
            l_code_epis_archive(i) := col_in(i).code_epis_archive;
            l_num_bp(i) := col_in(i).num_bp;
            l_dt_bp(i) := col_in(i).dt_bp;
            l_code_bp(i) := col_in(i).code_bp;
            l_desc_bp(i) := col_in(i).desc_bp;
            l_id_problem(i) := col_in(i).id_problem;
            l_id_task_type(i) := col_in(i).id_task_type;
        END LOOP;
        IF nvl(ignore_if_null_in, FALSE)
        THEN
            -- Set any columns to their current values
            -- if incoming value is NULL.
            -- Put WHEN clause on column-level triggers!
            FORALL i IN col_in.first .. col_in.last
                UPDATE viewer_ehr_ea
                   SET num_allergy        = nvl(l_num_allergy(i), num_allergy),
                       desc_allergy       = nvl(l_desc_allergy(i), desc_allergy),
                       dt_allergy         = nvl(l_dt_allergy(i), dt_allergy),
                       dt_allergy_fmt     = nvl(l_dt_allergy_fmt(i), dt_allergy_fmt),
                       num_lab            = nvl(l_num_lab(i), num_lab),
                       desc_lab           = nvl(l_desc_lab(i), desc_lab),
                       dt_lab             = nvl(l_dt_lab(i), dt_lab),
                       num_diag_icnp      = nvl(l_num_diag_icnp(i), num_diag_icnp),
                       desc_diag_icnp     = nvl(l_desc_diag_icnp(i), desc_diag_icnp),
                       dt_diag_icnp       = nvl(l_dt_diag_icnp(i), dt_diag_icnp),
                       num_episode        = nvl(l_num_episode(i), num_episode),
                       desc_episode       = nvl(l_desc_episode(i), desc_episode),
                       dt_episode         = nvl(l_dt_episode(i), dt_episode),
                       num_exam           = nvl(l_num_exam(i), num_exam),
                       desc_exam          = nvl(l_desc_exam(i), desc_exam),
                       dt_exam            = nvl(l_dt_exam(i), dt_exam),
                       num_med            = nvl(l_num_med(i), num_med),
                       desc_med           = nvl(l_desc_med(i), desc_med),
                       dt_med             = nvl(l_dt_med(i), dt_med),
                       num_problem        = nvl(l_num_problem(i), num_problem),
                       desc_problem       = nvl(l_desc_problem(i), desc_problem),
                       dt_problem         = nvl(l_dt_problem(i), dt_problem),
                       dt_problem_fmt     = nvl(l_dt_problem_fmt(i), dt_problem_fmt),
                       num_interv         = nvl(l_num_interv(i), num_interv),
                       desc_interv        = nvl(l_desc_interv(i), desc_interv),
                       dt_interv          = nvl(l_dt_interv(i), dt_interv),
                       dt_dg_last_update  = nvl(l_dt_dg_last_update(i), dt_dg_last_update),
                       code_allergy       = nvl(l_code_allergy(i), code_allergy),
                       code_episode       = nvl(l_code_episode(i), code_episode),
                       code_exam          = nvl(l_code_exam(i), code_exam),
                       code_med           = nvl(l_code_med(i), code_med),
                       code_problem       = nvl(l_code_problem(i), code_problem),
                       code_lab           = nvl(l_code_lab(i), code_lab),
                       code_diag_icnp     = nvl(l_code_diag_icnp(i), code_diag_icnp),
                       code_interv        = nvl(l_code_interv(i), code_interv),
                       create_user        = nvl(l_create_user(i), create_user),
                       create_time        = nvl(l_create_time(i), create_time),
                       create_institution = nvl(l_create_institution(i), create_institution),
                       update_user        = nvl(l_update_user(i), update_user),
                       update_time        = nvl(l_update_time(i), update_time),
                       update_institution = nvl(l_update_institution(i), update_institution),
                       flg_exclamation    = nvl(l_flg_exclamation(i), flg_exclamation),
                       flg_infective      = nvl(l_flg_infective(i), flg_infective),
                       num_vs             = nvl(l_num_vs(i), num_vs),
                       desc_vs            = nvl(l_desc_vs(i), desc_vs),
                       dt_vs              = nvl(l_dt_vs(i), dt_vs),
                       code_vs            = nvl(l_code_vs(i), code_vs),
                       num_note           = nvl(l_num_note(i), num_note),
                       desc_note          = nvl(l_desc_note(i), desc_note),
                       dt_note            = nvl(l_dt_note(i), dt_note),
                       code_note          = nvl(l_code_note(i), code_note),
                       num_archive        = nvl(l_num_archive(i), num_archive),
                       desc_archive       = nvl(l_desc_archive(i), desc_archive),
                       dt_archive         = nvl(l_dt_archive(i), dt_archive),
                       code_archive       = nvl(l_code_archive(i), code_archive),
                       num_epis_archive   = nvl(l_num_epis_archive(i), num_epis_archive),
                       desc_epis_archive  = nvl(l_desc_epis_archive(i), desc_epis_archive),
                       dt_epis_archive    = nvl(l_dt_epis_archive(i), dt_epis_archive),
                       code_epis_archive  = nvl(l_code_epis_archive(i), code_epis_archive),
                       num_bp             = nvl(l_num_bp(i), num_bp),
                       dt_bp              = nvl(l_dt_bp(i), dt_bp),
                       code_bp            = nvl(l_code_bp(i), code_bp),
                       desc_bp            = nvl(l_desc_bp(i), desc_bp),
                       id_problem         = nvl(l_id_problem(i), id_problem),
                       id_task_type       = nvl(l_id_task_type(i), id_task_type)
                 WHERE id_patient = l_id_patient(i)
                RETURNING ROWID BULK COLLECT INTO rows_out;
        ELSE
            FORALL i IN col_in.first .. col_in.last
                UPDATE viewer_ehr_ea
                   SET num_allergy        = l_num_allergy(i),
                       desc_allergy       = l_desc_allergy(i),
                       dt_allergy         = l_dt_allergy(i),
                       dt_allergy_fmt     = l_dt_allergy_fmt(i),
                       num_lab            = l_num_lab(i),
                       desc_lab           = l_desc_lab(i),
                       dt_lab             = l_dt_lab(i),
                       num_diag_icnp      = l_num_diag_icnp(i),
                       desc_diag_icnp     = l_desc_diag_icnp(i),
                       dt_diag_icnp       = l_dt_diag_icnp(i),
                       num_episode        = l_num_episode(i),
                       desc_episode       = l_desc_episode(i),
                       dt_episode         = l_dt_episode(i),
                       num_exam           = l_num_exam(i),
                       desc_exam          = l_desc_exam(i),
                       dt_exam            = l_dt_exam(i),
                       num_med            = l_num_med(i),
                       desc_med           = l_desc_med(i),
                       dt_med             = l_dt_med(i),
                       num_problem        = l_num_problem(i),
                       desc_problem       = l_desc_problem(i),
                       dt_problem         = l_dt_problem(i),
                       dt_problem_fmt     = l_dt_problem_fmt(i),
                       num_interv         = l_num_interv(i),
                       desc_interv        = l_desc_interv(i),
                       dt_interv          = l_dt_interv(i),
                       dt_dg_last_update  = l_dt_dg_last_update(i),
                       code_allergy       = l_code_allergy(i),
                       code_episode       = l_code_episode(i),
                       code_exam          = l_code_exam(i),
                       code_med           = l_code_med(i),
                       code_problem       = l_code_problem(i),
                       code_lab           = l_code_lab(i),
                       code_diag_icnp     = l_code_diag_icnp(i),
                       code_interv        = l_code_interv(i),
                       create_user        = l_create_user(i),
                       create_time        = l_create_time(i),
                       create_institution = l_create_institution(i),
                       update_user        = l_update_user(i),
                       update_time        = l_update_time(i),
                       update_institution = l_update_institution(i),
                       flg_exclamation    = l_flg_exclamation(i),
                       flg_infective      = l_flg_infective(i),
                       num_vs             = l_num_vs(i),
                       desc_vs            = l_desc_vs(i),
                       dt_vs              = l_dt_vs(i),
                       code_vs            = l_code_vs(i),
                       num_note           = l_num_note(i),
                       desc_note          = l_desc_note(i),
                       dt_note            = l_dt_note(i),
                       code_note          = l_code_note(i),
                       num_archive        = l_num_archive(i),
                       desc_archive       = l_desc_archive(i),
                       dt_archive         = l_dt_archive(i),
                       code_archive       = l_code_archive(i),
                       num_epis_archive   = l_num_epis_archive(i),
                       desc_epis_archive  = l_desc_epis_archive(i),
                       dt_epis_archive    = l_dt_epis_archive(i),
                       code_epis_archive  = l_code_epis_archive(i),
                       num_bp             = l_num_bp(i),
                       dt_bp              = l_dt_bp(i),
                       code_bp            = l_code_bp(i),
                       desc_bp            = l_desc_bp(i),
                       id_problem         = l_id_problem(i),
                       id_task_type       = l_id_task_type(i)
                 WHERE id_patient = l_id_patient(i)
                RETURNING ROWID BULK COLLECT INTO rows_out;
        END IF;
    
    EXCEPTION
        WHEN e_forall_error THEN
            IF NOT handle_error_in
            THEN
                RAISE;
            ELSE
                FOR indx IN 1 .. SQL%bulk_exceptions.count
                LOOP
                    pk_alertlog.log_error('DML error ignored: ' || SQLCODE || ': ' || SQLERRM);
                END LOOP;
            END IF;
        WHEN OTHERS THEN
            IF NOT handle_error_in
            THEN
                RAISE;
            ELSE
                pk_alertlog.log_error('DML error ignored: ' || SQLCODE || ': ' || SQLERRM);
            END IF;
        
    END upd;

    --Update with collection (without rows_out)
    PROCEDURE upd
    (
        col_in            IN viewer_ehr_ea_tc,
        ignore_if_null_in IN BOOLEAN := TRUE,
        handle_error_in   IN BOOLEAN := TRUE
    ) IS
        rows_out table_varchar;
    BEGIN
        upd(col_in, ignore_if_null_in, handle_error_in, rows_out);
    END upd;

    --Dynamic update string
    FUNCTION dynupdstr
    (
        colname_in IN all_tab_columns.column_name%TYPE,
        where_in   IN VARCHAR2 := NULL
    ) RETURN VARCHAR2 IS
    BEGIN
        RETURN 'BEGIN UPDATE viewer_ehr_ea
SET ' || colname_in || ' = :value
 WHERE ' || nvl(where_in, '1=1') || ' RETURNING ROWID BULK COLLECT INTO :rows_out; END;';
    END dynupdstr;

    -- Use Native Dynamic SQL increment a single NUMBER column
    -- for all rows specified by the dynamic WHERE clause (with rows_out)
    PROCEDURE increment_onecol
    (
        colname_in         IN all_tab_columns.column_name%TYPE,
        where_in           IN VARCHAR2,
        increment_value_in IN NUMBER DEFAULT 1,
        handle_error_in    IN BOOLEAN := TRUE,
        rows_out           OUT table_varchar
    ) IS
    BEGIN
        EXECUTE IMMEDIATE 'BEGIN UPDATE viewer_ehr_ea
SET ' || colname_in || '=' || colname_in || '+' || nvl(increment_value_in, 1) || ' WHERE ' ||
                          nvl(where_in, '1=1') || ' RETURNING ROWID BULK COLLECT INTO :rows_out; END;'
            USING OUT rows_out;
    END increment_onecol;

    -- Use Native Dynamic SQL increment a single NUMBER column
    -- for all rows specified by the dynamic WHERE clause (without rows_out)
    PROCEDURE increment_onecol
    (
        colname_in         IN all_tab_columns.column_name%TYPE,
        where_in           IN VARCHAR2,
        increment_value_in IN NUMBER DEFAULT 1,
        handle_error_in    IN BOOLEAN := TRUE
    ) IS
        rows_out table_varchar;
    BEGIN
        EXECUTE IMMEDIATE 'UPDATE viewer_ehr_ea
SET ' || colname_in || '=' || colname_in || '+' || nvl(increment_value_in, 1) || ' WHERE ' ||
                          nvl(where_in, '1=1');
    END increment_onecol;

    -- Delete one row by primary key
    PROCEDURE del
    (
        id_patient_in   IN viewer_ehr_ea.id_patient%TYPE,
        handle_error_in IN BOOLEAN := TRUE,
        rows_out        OUT table_varchar
    ) IS
    BEGIN
        DELETE FROM viewer_ehr_ea
         WHERE id_patient = id_patient_in
        RETURNING ROWID BULK COLLECT INTO rows_out;
    
    EXCEPTION
        WHEN e_null_column_value
             OR e_existing_fky_reference
             OR e_check_constraint_failure
             OR e_no_parent_key
             OR e_child_record_found
             OR e_forall_error
             OR e_integ_constraint_failure THEN
            IF NOT handle_error_in
            THEN
                RAISE;
            ELSE
                pk_alertlog.log_error('DML error ignored: ' || SQLCODE || ': ' || SQLERRM);
            END IF;
        
    END del;

    -- Delete one row by primary key
    PROCEDURE del
    (
        id_patient_in   IN viewer_ehr_ea.id_patient%TYPE,
        handle_error_in IN BOOLEAN := TRUE
    ) IS
        rows_out table_varchar;
    BEGIN
        del(id_patient_in => id_patient_in, handle_error_in => handle_error_in, rows_out => rows_out);
    END del;

    -- Delete all rows for this VEA_PAT_FK foreign key value
    PROCEDURE del_vea_pat_fk
    (
        id_patient_in   IN viewer_ehr_ea.id_patient%TYPE,
        handle_error_in IN BOOLEAN := TRUE,
        rows_out        OUT table_varchar
    ) IS
    BEGIN
        DELETE FROM viewer_ehr_ea
         WHERE id_patient = id_patient_in
        RETURNING ROWID BULK COLLECT INTO rows_out;
    
    EXCEPTION
        WHEN e_null_column_value
             OR e_existing_fky_reference
             OR e_check_constraint_failure
             OR e_no_parent_key
             OR e_child_record_found
             OR e_forall_error
             OR e_integ_constraint_failure THEN
            IF NOT handle_error_in
            THEN
                RAISE;
            ELSE
                pk_alertlog.log_error('DML error ignored: ' || SQLCODE || ': ' || SQLERRM);
            END IF;
        
    END del_vea_pat_fk;

    -- Delete all rows for this VEA_PAT_FK foreign key value
    PROCEDURE del_vea_pat_fk
    (
        id_patient_in   IN viewer_ehr_ea.id_patient%TYPE,
        handle_error_in IN BOOLEAN := TRUE
    ) IS
        rows_out table_varchar;
    BEGIN
        del_vea_pat_fk(id_patient_in => id_patient_in, handle_error_in => handle_error_in, rows_out => rows_out);
    END del_vea_pat_fk;

    -- Deletions using dynamic SQL
    FUNCTION dyndelstr(where_in IN VARCHAR2) RETURN VARCHAR2 IS
    BEGIN
        IF where_in IS NULL
        THEN
            RETURN 'DELETE FROM viewer_ehr_ea';
        ELSE
            RETURN 'DELETE FROM viewer_ehr_ea WHERE ' || where_in;
        END IF;
    END dyndelstr;
    -- Delete all rows specified by dynamic WHERE clause
    PROCEDURE del_by
    (
        where_clause_in IN VARCHAR2,
        handle_error_in IN BOOLEAN := TRUE,
        rows_out        OUT table_varchar
    ) IS
    BEGIN
        EXECUTE IMMEDIATE 'BEGIN ' || dyndelstr(where_clause_in) ||
                          ' RETURNING ROWID BULK COLLECT INTO :rows_out; END;'
            USING OUT rows_out;
    
    EXCEPTION
        WHEN e_null_column_value
             OR e_existing_fky_reference
             OR e_check_constraint_failure
             OR e_no_parent_key
             OR e_child_record_found
             OR e_forall_error
             OR e_integ_constraint_failure THEN
            IF NOT handle_error_in
            THEN
                RAISE;
            ELSE
                pk_alertlog.log_error('DML error ignored: ' || SQLCODE || ': ' || SQLERRM);
            END IF;
        
    END del_by;

    -- Delete all rows specified by dynamic WHERE clause
    PROCEDURE del_by
    (
        where_clause_in IN VARCHAR2,
        handle_error_in IN BOOLEAN := TRUE
    ) IS
    BEGIN
        EXECUTE IMMEDIATE dyndelstr(where_clause_in);
    
    EXCEPTION
        WHEN e_null_column_value
             OR e_existing_fky_reference
             OR e_check_constraint_failure
             OR e_no_parent_key
             OR e_child_record_found
             OR e_forall_error
             OR e_integ_constraint_failure THEN
            IF NOT handle_error_in
            THEN
                RAISE;
            ELSE
                pk_alertlog.log_error('DML error ignored: ' || SQLCODE || ': ' || SQLERRM);
            END IF;
        
    END del_by;

    -- Initialize a record with default values for columns in the table (prc)
    PROCEDURE initrec(viewer_ehr_ea_inout IN OUT viewer_ehr_ea%ROWTYPE) IS
    BEGIN
        viewer_ehr_ea_inout.id_patient         := NULL;
        viewer_ehr_ea_inout.num_allergy        := NULL;
        viewer_ehr_ea_inout.desc_allergy       := NULL;
        viewer_ehr_ea_inout.dt_allergy         := NULL;
        viewer_ehr_ea_inout.dt_allergy_fmt     := NULL;
        viewer_ehr_ea_inout.num_lab            := NULL;
        viewer_ehr_ea_inout.desc_lab           := NULL;
        viewer_ehr_ea_inout.dt_lab             := NULL;
        viewer_ehr_ea_inout.num_diag_icnp      := NULL;
        viewer_ehr_ea_inout.desc_diag_icnp     := NULL;
        viewer_ehr_ea_inout.dt_diag_icnp       := NULL;
        viewer_ehr_ea_inout.num_episode        := NULL;
        viewer_ehr_ea_inout.desc_episode       := NULL;
        viewer_ehr_ea_inout.dt_episode         := NULL;
        viewer_ehr_ea_inout.num_exam           := NULL;
        viewer_ehr_ea_inout.desc_exam          := NULL;
        viewer_ehr_ea_inout.dt_exam            := NULL;
        viewer_ehr_ea_inout.num_med            := NULL;
        viewer_ehr_ea_inout.desc_med           := NULL;
        viewer_ehr_ea_inout.dt_med             := NULL;
        viewer_ehr_ea_inout.num_problem        := NULL;
        viewer_ehr_ea_inout.desc_problem       := NULL;
        viewer_ehr_ea_inout.dt_problem         := NULL;
        viewer_ehr_ea_inout.dt_problem_fmt     := NULL;
        viewer_ehr_ea_inout.num_interv         := NULL;
        viewer_ehr_ea_inout.desc_interv        := NULL;
        viewer_ehr_ea_inout.dt_interv          := NULL;
        viewer_ehr_ea_inout.dt_dg_last_update  := NULL;
        viewer_ehr_ea_inout.code_allergy       := NULL;
        viewer_ehr_ea_inout.code_episode       := NULL;
        viewer_ehr_ea_inout.code_exam          := NULL;
        viewer_ehr_ea_inout.code_med           := NULL;
        viewer_ehr_ea_inout.code_problem       := NULL;
        viewer_ehr_ea_inout.code_lab           := NULL;
        viewer_ehr_ea_inout.code_diag_icnp     := NULL;
        viewer_ehr_ea_inout.code_interv        := NULL;
        viewer_ehr_ea_inout.create_user        := NULL;
        viewer_ehr_ea_inout.create_time        := NULL;
        viewer_ehr_ea_inout.create_institution := NULL;
        viewer_ehr_ea_inout.update_user        := NULL;
        viewer_ehr_ea_inout.update_time        := NULL;
        viewer_ehr_ea_inout.update_institution := NULL;
        viewer_ehr_ea_inout.flg_exclamation    := NULL;
        viewer_ehr_ea_inout.flg_infective      := NULL;
        viewer_ehr_ea_inout.num_vs             := NULL;
        viewer_ehr_ea_inout.desc_vs            := NULL;
        viewer_ehr_ea_inout.dt_vs              := NULL;
        viewer_ehr_ea_inout.code_vs            := NULL;
        viewer_ehr_ea_inout.num_note           := NULL;
        viewer_ehr_ea_inout.desc_note          := NULL;
        viewer_ehr_ea_inout.dt_note            := NULL;
        viewer_ehr_ea_inout.code_note          := NULL;
        viewer_ehr_ea_inout.num_archive        := NULL;
        viewer_ehr_ea_inout.desc_archive       := NULL;
        viewer_ehr_ea_inout.dt_archive         := NULL;
        viewer_ehr_ea_inout.code_archive       := NULL;
        viewer_ehr_ea_inout.num_epis_archive   := NULL;
        viewer_ehr_ea_inout.desc_epis_archive  := NULL;
        viewer_ehr_ea_inout.dt_epis_archive    := NULL;
        viewer_ehr_ea_inout.code_epis_archive  := NULL;
        viewer_ehr_ea_inout.num_bp             := NULL;
        viewer_ehr_ea_inout.dt_bp              := NULL;
        viewer_ehr_ea_inout.code_bp            := NULL;
        viewer_ehr_ea_inout.desc_bp            := NULL;
        viewer_ehr_ea_inout.id_problem         := NULL;
        viewer_ehr_ea_inout.id_task_type       := NULL;
    END initrec;

    -- Initialize a record with default values for columns in the table (fnc)
    FUNCTION initrec RETURN viewer_ehr_ea%ROWTYPE IS
        l_viewer_ehr_ea viewer_ehr_ea%ROWTYPE;
    BEGIN
        RETURN l_viewer_ehr_ea;
    END initrec;

    --get data from rowid
    FUNCTION get_data_rowid(rows_in IN table_varchar) RETURN viewer_ehr_ea_tc IS
        data viewer_ehr_ea_tc;
    BEGIN
        SELECT *
          BULK COLLECT
          INTO data
          FROM viewer_ehr_ea
         WHERE ROWID IN (SELECT /*+ OPT_ESTIMATE(TABLE t ROWS=1) */
                          *
                           FROM TABLE(rows_in) t);
        RETURN data;
    END get_data_rowid;

    --get data from rowid (pragma autonomous transacion)
    FUNCTION get_data_rowid_pat(rows_in IN table_varchar) RETURN viewer_ehr_ea_tc IS
        data viewer_ehr_ea_tc;
        PRAGMA AUTONOMOUS_TRANSACTION;
    BEGIN
        data := get_data_rowid(rows_in);
        COMMIT;
        RETURN data;
    
    EXCEPTION
        WHEN OTHERS THEN
            pk_alert_exceptions.raise_error(error_name_in => 'get_data_rowid_pat');
            ROLLBACK;
        
    END get_data_rowid_pat;

BEGIN
    NULL;
END ts_viewer_ehr_ea;
/
